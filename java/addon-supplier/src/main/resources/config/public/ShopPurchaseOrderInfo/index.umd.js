(function(e,F){typeof exports=="object"&&typeof module<"u"?module.exports=F(require("vue"),require("vue-router"),require("decimal.js"),require("element-plus"),require("vue-clipboard3"),require("element-china-area-data"),require("@/components/q-address"),require("@/composables/useConvert"),require("@/components/q-upload/q-upload.vue"),require("@/apis/http")):typeof define=="function"&&define.amd?define(["vue","vue-router","decimal.js","element-plus","vue-clipboard3","element-china-area-data","@/components/q-address","@/composables/useConvert","@/components/q-upload/q-upload.vue","@/apis/http"],F):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopPurchaseOrderInfo=F(e.ShopPurchaseOrderInfoContext.Vue,e.ShopPurchaseOrderInfoContext.VueRouter,e.ShopPurchaseOrderInfoContext.Decimal,e.ShopPurchaseOrderInfoContext.ElementPlus,e.ShopPurchaseOrderInfoContext.VueClipboard3,e.ShopPurchaseOrderInfoContext.ElementChinaAreaData,e.ShopPurchaseOrderInfoContext.QAddressIndex,e.ShopPurchaseOrderInfoContext.UseConvert,e.ShopPurchaseOrderInfoContext.QUpload,e.ShopPurchaseOrderInfoContext.Request))})(this,function(e,F,O,C,Ce,Ie,be,Te,ke,ie){"use strict";var ce=document.createElement("style");ce.textContent=`@charset "UTF-8";.details[data-v-02c683a9]{overflow-y:auto;padding:0 30px 30px}.details__status[data-v-02c683a9]{display:flex;align-items:center}.details__status--steps[data-v-02c683a9]{padding:20px;margin:20px;width:700px;border-left:1px solid #d5d5d5}.details__status--title[data-v-02c683a9]{font-size:28px;font-weight:700;color:#515151;width:223px;text-align:center}.details__userInfo[data-v-02c683a9]{display:flex;margin-bottom:22px;padding:0 30px}.details__userInfo--left[data-v-02c683a9]{flex:.5}.details__userInfo--left div[data-v-02c683a9]:nth-of-type(n+2){margin-bottom:11px}.details__userInfo--right[data-v-02c683a9]{margin-left:30px;flex:.5}.details__userInfo--right div[data-v-02c683a9]:nth-of-type(n+2){margin-bottom:11px}.details__userInfo--title[data-v-02c683a9]{font-size:14px;color:#333;font-weight:700;margin:17px 0;display:flex;justify-content:space-between;align-items:center}.details__table--main[data-v-02c683a9]{height:300px}.details__table--main .commodity[data-v-02c683a9]{display:flex;align-items:stretch}.details__table--main .commodity .commodity__info[data-v-02c683a9]{margin-left:15px;flex:1;overflow:hidden;display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;text-align:left}.details__table--main .commodity .commodity__info--title[data-v-02c683a9]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%}.details__table--main .commodity .commodity__info--spec[data-v-02c683a9]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-size:.8em;width:100%}.details__subtotal[data-v-02c683a9]{display:flex;flex-direction:column;align-items:flex-end;width:100%;margin-top:30px;line-height:1.5}.details__subtotal--title[data-v-02c683a9]{font-size:1.3em;font-weight:600}.details__subtotal .pay-price[data-v-02c683a9]{font-size:1.2em}.details .text-red[data-v-02c683a9]{color:red}.proof-img[data-v-02c683a9]{width:350px;height:350px;object-fit:contain}.copy[data-v-02c683a9]{margin-left:5px;color:#409eff;cursor:pointer}.logisticsInfo[data-v-574d4514]{display:flex;justify-content:space-between}.logisticsInfo__left[data-v-574d4514]{flex:3}.logisticsInfo__right[data-v-574d4514]{flex:2}.logisticsInfo__timeline-con[data-v-574d4514]{max-height:500px;overflow:auto}.logisticsInfo__title[data-v-574d4514]{font-size:14px;color:#333;font-weight:700;margin:17px 0}.logisticsInfo__text[data-v-574d4514]{margin-bottom:11px}.logisticsInfo__timeline[data-v-574d4514]{margin-top:20px}.logisticsInfo__timeline li[data-v-574d4514]:nth-child(1) .el-timeline-item__timestamp{color:#000}.logisticsInfo__timeline--status[data-v-574d4514]{font-size:13px;font-weight:700;margin-right:10px;color:#838383}.logisticsInfo__timeline--time[data-v-574d4514]{color:#838383}.logisticsInfo__divider[data-v-574d4514]{height:4px;margin:0 -15px;background:#f2f2f2}[data-v-574d4514] .el-timeline-item__node--normal{left:0}[data-v-574d4514] .el-scrollbar__wrap{max-height:500px}
`,document.head.appendChild(ce);const Se=(s={})=>ie.put({url:"addon-supplier/supplier/order/pay",data:s}),Oe=s=>ie.get({url:`addon-supplier/supplier/order/delivery/${s}`}),Pe=s=>ie.get({url:`addon-supplier/supplier/order/${s}`}),we=(s,c)=>ie.get({url:"gruul-mall-freight/logistics/node",params:{companyCode:s,waybillNo:c}}),De={class:"tab_container"},Be=e.defineComponent({__name:"ShopPurchaseOrderInfo",setup(s){const c=e.ref("basic"),o={basic:e.defineAsyncComponent(()=>Promise.resolve().then(()=>_t)),delivery:e.defineAsyncComponent(()=>Promise.resolve().then(()=>Ot))},t=e.ref(0),d=F.useRoute(),i=e.ref();async function y(){if(d.query.orderNo){const{code:p,data:a}=await Pe(d.query.orderNo);i.value=a,t.value=Date.now()}}const f=e.computed(()=>{var p,a;return(a=(p=i==null?void 0:i.value)==null?void 0:p.orderItems)==null?void 0:a.filter(l=>l.packageStatus!=="WAITING_FOR_DELIVER").length});return y(),(p,a)=>{const l=e.resolveComponent("el-tab-pane"),x=e.resolveComponent("el-tabs");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",De,[e.createVNode(x,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=V=>c.value=V)},{default:e.withCtx(()=>[e.createVNode(l,{label:"订单信息",name:"basic"}),f.value&&f.value>0?(e.openBlock(),e.createBlock(l,{key:0,label:"物流信息",name:"delivery"})):e.createCommentVNode("",!0)]),_:1},8,["modelValue"])]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(o[c.value]),{key:t.value,order:i.value,reload:y},null,8,["order"]))],64)}}}),$e={待支付:1,待审核:2,待发货:2,部分发货:2,待入库:3,已完成:4,已关闭:1},Fe={OFFLINE:"线下支付",BALANCE:"余额支付"},{divTenThousand:de}=Te(),{toClipboard:pe}=Ce(),Re=(s,c)=>{const o=e.ref(!1),t=e.ref(),d=e.ref(null);t.value=s;const i=e.reactive({statusText:"",activeStep:0}),y=i.statusText=Ae(s);i.activeStep=$e[y];const f=async()=>{var u,b;const _=await((u=d.value)==null?void 0:u.getPayOrderFormModel()),{code:N,msg:I}=await Se({..._,orderNo:(b=t.value)==null?void 0:b.no});N===200?(C.ElMessage.success("支付成功"),o.value=!1,c&&c()):C.ElMessage.error(I||"支付失败")},p=()=>{o.value=!0},a=async _=>{try{await pe(_),C.ElMessage.success("复制成功")}catch{C.ElMessage.error("复制失败")}},l=async()=>{var N,I,u,b,n,T,E,P,w,D,h,B,k;const _=`
            收货人姓名：${(u=(I=(N=t==null?void 0:t.value)==null?void 0:N.extra)==null?void 0:I.receiver)==null?void 0:u.name}

            联系人电话：${(T=(n=(b=t==null?void 0:t.value)==null?void 0:b.extra)==null?void 0:n.receiver)==null?void 0:T.mobile}

            收货地址：${be.AddressFn(Ie.regionData,((P=(E=t==null?void 0:t.value)==null?void 0:E.extra)==null?void 0:P.receiver.areaCode)||[])}${(h=(D=(w=t==null?void 0:t.value)==null?void 0:w.extra)==null?void 0:D.receiver)==null?void 0:h.address}

            采购备注：${(k=(B=t==null?void 0:t.value)==null?void 0:B.extra)==null?void 0:k.remark}
        `;try{await pe(_),C.ElMessage.success("复制成功")}catch{C.ElMessage.error("复制失败")}},x=e.computed(()=>_=>qe(_)),V=e.computed(()=>_=>Me(_));return{orderDetails:t,stepInfo:i,payTypeMap:Fe,divTenThousand:de,computedCalculateFreight:x,computedCalculateCommodityPrice:V,handlePayOrder:f,showPayDialog:o,handlePay:p,payOrderRef:d,copyOrderNo:a,handleCopyReceiver:l}},Ae=s=>{if(!s)return"";if(s.status==="UNPAID")return"待支付";if(s.status==="PAYMENT_AUDIT")return"待审核";const c=["WAITING_FOR_DELIVER","WAITING_FOR_RECEIVE","COMPLETED"],o={WAITING_FOR_DELIVER:"待发货",WAITING_FOR_RECEIVE:"待入库",COMPLETED:"已完成"};if(s.status==="PAID"){let t="COMPLETED";for(const i of s.orderItems){const y=c.findIndex(f=>f===t);if(i.packageStatus==="WAITING_FOR_DELIVER"&&y>0){t="WAITING_FOR_DELIVER";continue}i.packageStatus==="WAITING_FOR_RECEIVE"&&y>1&&(t="WAITING_FOR_RECEIVE")}let d=o[t];return d==="待发货"&&s.orderItems.find(y=>y.packageStatus!=="WAITING_FOR_DELIVER")&&(d="部分发货"),d}return"已关闭"},qe=(s=[])=>s.reduce((c,o)=>c.plus(new O(de(o.freightPrice))),new O(0)),Me=(s=[])=>s.reduce((c,o)=>c.plus(new O(de(o.salePrice).mul(new O(o.num)))),new O(0)),Le=e.defineComponent({__name:"pay-order",props:{price:{default:()=>new O(0)}},setup(s,{expose:c}){const o=s,t=e.reactive({payType:"",proof:""}),d={payType:[{required:!0,message:"请选择支付方式",trigger:"blur"}],proof:[{validator:(f,p,a)=>{t.payType==="OFFLINE"&&(p||a(new Error("请上传凭证"))),a()},trigger:"change"}]},i=e.ref(null);return c({getPayOrderFormModel:()=>new Promise((f,p)=>{i.value?i.value.validate(a=>{a?f(t):p("valid error")}):p("none instance")})}),(f,p)=>{const a=e.resolveComponent("el-form-item"),l=e.resolveComponent("el-radio"),x=e.resolveComponent("el-radio-group"),V=e.resolveComponent("el-form");return e.openBlock(),e.createBlock(V,{ref_key:"formRef",ref:i,model:t,rules:d},{default:e.withCtx(()=>[e.createVNode(a,{label:"应付款(元)"},{default:e.withCtx(()=>[e.createTextVNode("￥"+e.toDisplayString(o.price),1)]),_:1}),e.createVNode(a,{label:"支付方式",prop:"payType"},{default:e.withCtx(()=>[e.createVNode(x,{modelValue:t.payType,"onUpdate:modelValue":p[0]||(p[0]=_=>t.payType=_)},{default:e.withCtx(()=>[e.createVNode(l,{value:"OFFLINE"},{default:e.withCtx(()=>p[2]||(p[2]=[e.createTextVNode("线下付款")])),_:1}),e.createVNode(l,{value:"BALANCE"},{default:e.withCtx(()=>p[3]||(p[3]=[e.createTextVNode("店铺余额")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t.payType==="OFFLINE"?(e.openBlock(),e.createBlock(a,{key:0,label:"付款凭证",prop:"proof"},{default:e.withCtx(()=>[e.createVNode(ke,{src:t.proof,"onUpdate:src":p[1]||(p[1]=_=>t.proof=_),format:{size:1,width:1e4,height:1e4},cropper:!1,height:100,width:100},null,8,["src"])]),_:1})):e.createCommentVNode("",!0)]),_:1},8,["model"])}}}),je=()=>{const s=e.ref(!1),c=e.ref("");return{showProof:s,goToShowProof:t=>{var d,i;c.value=((i=(d=t==null?void 0:t.extra)==null?void 0:d.pay)==null?void 0:i.proof)||"",s.value=!0},currentProof:c}},ze={class:"details"},Ue={class:"details__status"},We={class:"details__status--title"},Ge={class:"details__status--steps"},He={class:"details__userInfo"},Qe={class:"details__userInfo--left"},Ye={class:"details__userInfo--left"},Je={class:"details__userInfo--title"},Ke={class:"details__userInfo--right"},Xe={class:"details__table"},Ze={class:"commodity"},ve={class:"commodity__info"},et={class:"commodity__info--title"},tt={class:"commodity__info--spec"},ot={class:"details__subtotal"},at={class:"details__subtotal--line"},nt={class:"details__subtotal--line"},lt={class:"text-red"},rt={class:"details__subtotal--line"},st={class:"text-red"},it={class:"details__subtotal--line pay-price"},dt={class:"text-red"},ct={class:"dialog-footer"},pt=["src"],mt=e.defineComponent({__name:"basic",props:{order:{type:Object,default:()=>({})},reload:{type:Object,default:()=>({})}},setup(s){const c=s,{orderDetails:o,stepInfo:t,payTypeMap:d,divTenThousand:i,computedCalculateFreight:y,computedCalculateCommodityPrice:f,handlePayOrder:p,showPayDialog:a,handlePay:l,payOrderRef:x,copyOrderNo:V,handleCopyReceiver:_}=Re(c.order,c.reload),{showProof:N,goToShowProof:I,currentProof:u}=je();return(b,n)=>{var R,q,M,L,j,z,U,W,G,H,Q,Y,J,K,X,Z,v,S,A,ee,te,oe,ae,ne,le,m,$,_e,fe,ye,ge,xe,Ne,he;const T=e.resolveComponent("el-button"),E=e.resolveComponent("el-step"),P=e.resolveComponent("el-steps"),w=e.resolveComponent("q-address"),D=e.resolveComponent("el-image"),h=e.resolveComponent("el-table-column"),B=e.resolveComponent("el-table"),k=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ze,[e.createElementVNode("div",Ue,[e.createElementVNode("div",We,[e.createElementVNode("p",null,e.toDisplayString(e.unref(t).statusText),1),e.unref(t).statusText==="待支付"?(e.openBlock(),e.createBlock(T,{key:0,type:"danger",onClick:e.unref(l)},{default:e.withCtx(()=>n[6]||(n[6]=[e.createTextVNode("去支付")])),_:1},8,["onClick"])):e.createCommentVNode("",!0)]),e.createElementVNode("div",Ge,[e.createVNode(P,{active:e.unref(t).activeStep,"align-center":"","finish-status":"finish"},{default:e.withCtx(()=>{var r,g,re,se,Ve,ue,Ee;return[e.createVNode(E,{description:(r=e.unref(o))==null?void 0:r.createTime,title:"买家下单"},null,8,["description"]),e.createVNode(E,{description:(re=(g=e.unref(o))==null?void 0:g.timeNodes)==null?void 0:re.payTime,title:"买家付款"},null,8,["description"]),e.createVNode(E,{description:(Ve=(se=e.unref(o))==null?void 0:se.timeNodes)==null?void 0:Ve.deliveryTime,title:"卖家发货"},null,8,["description"]),e.createVNode(E,{description:(Ee=(ue=e.unref(o))==null?void 0:ue.timeNodes)==null?void 0:Ee.receiveTime,title:"买家收货"},null,8,["description"])]}),_:1},8,["active"])])]),e.createElementVNode("div",He,[e.createElementVNode("div",Qe,[n[7]||(n[7]=e.createElementVNode("div",{class:"details__userInfo--title"},"订单信息",-1)),e.createElementVNode("div",null,[e.createElementVNode("span",null,"订单编号："+e.toDisplayString((R=e.unref(o))==null?void 0:R.no),1),e.createElementVNode("span",{class:"copy",onClick:n[0]||(n[0]=r=>{var g;return e.unref(V)(((g=e.unref(o))==null?void 0:g.no)||"")})},"复制")]),e.createElementVNode("div",null,"下单时间："+e.toDisplayString((q=e.unref(o))==null?void 0:q.createTime),1),e.createElementVNode("div",null,"支付时间："+e.toDisplayString((L=(M=e.unref(o))==null?void 0:M.timeNodes)==null?void 0:L.payTime),1),e.createElementVNode("div",null,[e.createElementVNode("span",null,"支付方式："+e.toDisplayString(e.unref(d)[(U=(z=(j=e.unref(o))==null?void 0:j.extra)==null?void 0:z.pay)==null?void 0:U.payType]),1),((H=(G=(W=e.unref(o))==null?void 0:W.extra)==null?void 0:G.pay)==null?void 0:H.payType)==="OFFLINE"?(e.openBlock(),e.createElementBlock("span",{key:0,class:"copy",onClick:n[1]||(n[1]=r=>{var g,re,se;return e.unref(I)({extra:{pay:{proof:((se=(re=(g=e.unref(o))==null?void 0:g.extra)==null?void 0:re.pay)==null?void 0:se.proof)||""}}})})},"付款凭证")):e.createCommentVNode("",!0)]),n[8]||(n[8]=e.createElementVNode("div",null,"配送方式：快递配送",-1))]),e.createElementVNode("div",Ye,[e.createElementVNode("div",Je,[n[9]||(n[9]=e.createElementVNode("span",null,"收货人信息",-1)),e.createElementVNode("span",{class:"copy",onClick:n[2]||(n[2]=(...r)=>e.unref(_)&&e.unref(_)(...r))},"复制")]),e.createElementVNode("div",null,"收货人姓名："+e.toDisplayString((J=(Y=(Q=e.unref(o))==null?void 0:Q.extra)==null?void 0:Y.receiver)==null?void 0:J.name),1),e.createElementVNode("div",null,"联系人电话："+e.toDisplayString((Z=(X=(K=e.unref(o))==null?void 0:K.extra)==null?void 0:X.receiver)==null?void 0:Z.mobile),1),e.createElementVNode("div",null,[n[10]||(n[10]=e.createTextVNode(" 收货地址： ")),e.createVNode(w,{address:(S=(v=e.unref(o))==null?void 0:v.extra)==null?void 0:S.receiver.areaCode},null,8,["address"]),e.createTextVNode(" "+e.toDisplayString((te=(ee=(A=e.unref(o))==null?void 0:A.extra)==null?void 0:ee.receiver)==null?void 0:te.address),1)]),e.createElementVNode("div",null,"采购备注："+e.toDisplayString((ae=(oe=e.unref(o))==null?void 0:oe.extra)==null?void 0:ae.remark),1)]),e.createElementVNode("div",Ke,[n[11]||(n[11]=e.createElementVNode("div",{class:"details__userInfo--title"},"供应商信息",-1)),e.createElementVNode("div",null,"供应商名称："+e.toDisplayString((le=(ne=e.unref(o))==null?void 0:ne.extraInfo)==null?void 0:le.supplierName),1),e.createElementVNode("div",null,"联系人电话："+e.toDisplayString(($=(m=e.unref(o))==null?void 0:m.extraInfo)==null?void 0:$.supplierPhone),1)])]),e.createElementVNode("div",Xe,[e.createVNode(B,{data:(_e=e.unref(o))==null?void 0:_e.orderItems,border:"",class:"details__table--main"},{default:e.withCtx(()=>[e.createVNode(h,{align:"center",label:"商品",width:"460"},{default:e.withCtx(({row:r})=>{var g;return[e.createElementVNode("div",Ze,[e.createVNode(D,{src:r==null?void 0:r.image,fit:"cover",style:{width:"70px",height:"70px"}},null,8,["src"]),e.createElementVNode("div",ve,[e.createElementVNode("span",et,e.toDisplayString(r==null?void 0:r.productName),1),e.createElementVNode("span",tt,e.toDisplayString((g=r==null?void 0:r.specs)==null?void 0:g.join(";")),1)])])]}),_:1}),e.createVNode(h,{align:"center",label:"采购单价"},{default:e.withCtx(({row:r})=>[e.createTextVNode(e.toDisplayString(e.unref(i)(r==null?void 0:r.salePrice)),1)]),_:1}),e.createVNode(h,{align:"center",label:"采购数量",prop:"num"}),e.createVNode(h,{align:"center",label:"采购金额"},{default:e.withCtx(({row:r})=>[e.createTextVNode(e.toDisplayString(e.unref(i)(r==null?void 0:r.salePrice).mul(new(e.unref(O))(r.num))),1)]),_:1}),e.createVNode(h,{label:"实际入库量",prop:"used",align:"center"})]),_:1},8,["data"])]),e.createElementVNode("div",ot,[n[14]||(n[14]=e.createElementVNode("div",{class:"details__subtotal--title"},"订单总计",-1)),e.createElementVNode("div",at,"采购总数："+e.toDisplayString((ye=(fe=e.unref(o))==null?void 0:fe.orderItems)==null?void 0:ye.reduce((r,g)=>r+g.num,0)),1),e.createElementVNode("div",nt,[n[12]||(n[12]=e.createTextVNode(" 商品总价：")),e.createElementVNode("span",lt,e.toDisplayString(e.unref(f)((ge=e.unref(o))==null?void 0:ge.orderItems)),1)]),e.createElementVNode("div",rt,[n[13]||(n[13]=e.createTextVNode(" 运费：")),e.createElementVNode("span",st,e.toDisplayString(e.unref(y)((xe=e.unref(o))==null?void 0:xe.orderItems)),1)]),e.createElementVNode("div",it,[e.createTextVNode(" 采购金额("+e.toDisplayString(((Ne=e.unref(o))==null?void 0:Ne.status)==="PAID"?"已付款":"应付款")+")：",1),e.createElementVNode("span",dt,e.toDisplayString(e.unref(i)((he=e.unref(o))==null?void 0:he.payAmount))+"元",1)])])]),e.createVNode(k,{modelValue:e.unref(a),"onUpdate:modelValue":n[4]||(n[4]=r=>e.isRef(a)?a.value=r:null),title:"支付订单",width:"500px"},{footer:e.withCtx(()=>[e.createElementVNode("span",ct,[e.createVNode(T,{onClick:n[3]||(n[3]=r=>a.value=!1)},{default:e.withCtx(()=>n[15]||(n[15]=[e.createTextVNode("取消")])),_:1}),e.createVNode(T,{type:"primary",onClick:e.unref(p)},{default:e.withCtx(()=>n[16]||(n[16]=[e.createTextVNode(" 确认 ")])),_:1},8,["onClick"])])]),default:e.withCtx(()=>{var r;return[e.createVNode(Le,{ref_key:"payOrderRef",ref:x,price:e.unref(i)((r=e.unref(o))==null?void 0:r.payAmount)},null,8,["price"])]}),_:1},8,["modelValue"]),e.createVNode(k,{modelValue:e.unref(N),"onUpdate:modelValue":n[5]||(n[5]=r=>e.isRef(N)?N.value=r:null),title:"付款凭证",width:"500px"},{default:e.withCtx(()=>[e.createElementVNode("img",{src:e.unref(u),class:"proof-img"},null,8,pt)]),_:1},8,["modelValue"])],64)}}}),Dt="",me=(s,c)=>{const o=s.__vccOpts||s;for(const[t,d]of c)o[t]=d;return o},_t=Object.freeze(Object.defineProperty({__proto__:null,default:me(mt,[["__scopeId","data-v-02c683a9"]])},Symbol.toStringTag,{value:"Module"})),ft={style:{padding:"16px","overflow-y":"scroll"}},yt={style:{"margin-bottom":"30px","margin-left":"20px"}},gt={key:0},xt={key:1},Nt={class:"logisticsInfo"},ht={class:"logisticsInfo__left"},Vt={style:{display:"flex","align-items":"center"}},ut={key:0,style:{"margin-top":"20px"}},Et={class:"logisticsInfo__right"},Ct={key:0},It={class:"logisticsInfo__text"},bt={class:"logisticsInfo__text"},Tt={class:"logisticsInfo__text"},kt={key:1,style:{"text-align":"center",height:"100px","line-height":"100px"}},St=e.defineComponent({__name:"delivery",props:{order:{type:Object,default(){return{}}}},setup(s){const c=F.useRoute(),o=s,t=e.ref([]),d=e.ref([]),i=e.ref(0);y();async function y(){const{code:a,data:l}=await Oe(c.query.orderNo);if(a!==200)return C.ElMessage.error("包裹详情获取失败");l.length&&(d.value=l,f())}const f=async()=>{const a=d.value[i.value];if(a.type!=="WITHOUT")try{const{data:l,code:x,msg:V}=await we(a.express.expressCompanyCode,a.express.expressNo);if(x!==200)return C.ElMessage.error("包裹详情获取失败");if(!l.data){p(l,a);return}t.value=l.data.reverse()}catch(l){t.value=[{status:"包裹异常",time:a==null?void 0:a.createTime,context:l.msg}]}};function p(a,l){switch(a.returnCode){case"401":t.value=[{status:"包裹异常",time:l.createTime,context:a.message}];break;case"400":t.value=[{status:"包裹异常",time:l.createTime,context:a.message}];break;default:t.value=[{status:"包裹异常",time:l.createTime,context:a.message}];break}}return(a,l)=>{var P,w,D,h,B,k,R,q,M,L,j,z,U,W,G,H,Q,Y,J,K,X,Z,v;const x=e.resolveComponent("q-address"),V=e.resolveComponent("el-image"),_=e.resolveComponent("el-table-column"),N=e.resolveComponent("el-table"),I=e.resolveComponent("el-row"),u=e.resolveComponent("el-timeline-item"),b=e.resolveComponent("el-timeline"),n=e.resolveComponent("el-scrollbar"),T=e.resolveComponent("el-tab-pane"),E=e.resolveComponent("el-tabs");return e.openBlock(),e.createElementBlock("div",ft,[e.createElementVNode("div",yt,[l[2]||(l[2]=e.createElementVNode("div",{style:{color:"#000","font-size":"16px","margin-left":"-10px","font-weight":"700","margin-bottom":"10px"}},"收货人信息",-1)),e.createElementVNode("div",null,"收货人姓名："+e.toDisplayString(((D=(w=(P=d.value)==null?void 0:P[0])==null?void 0:w.receiver)==null?void 0:D.name)||((k=(B=(h=o.order)==null?void 0:h.extra)==null?void 0:B.receiver)==null?void 0:k.name)),1),e.createElementVNode("div",null,"联系人电话："+e.toDisplayString(((M=(q=(R=d.value)==null?void 0:R[0])==null?void 0:q.receiver)==null?void 0:M.mobile)||((z=(j=(L=o.order)==null?void 0:L.extra)==null?void 0:j.receiver)==null?void 0:z.mobile)),1),e.createElementVNode("div",null,[l[1]||(l[1]=e.createElementVNode("span",null,"收货地址：",-1)),(G=(W=(U=d.value)==null?void 0:U[0])==null?void 0:W.receiver)!=null&&G.address?(e.openBlock(),e.createElementBlock("span",gt,e.toDisplayString((Y=(Q=(H=d.value)==null?void 0:H[0])==null?void 0:Q.receiver)==null?void 0:Y.address),1)):(e.openBlock(),e.createElementBlock("span",xt,[e.createVNode(x,{address:(K=(J=o.order)==null?void 0:J.extra)==null?void 0:K.receiver.areaCode},null,8,["address"]),e.createElementVNode("span",null,e.toDisplayString((v=(Z=(X=o.order)==null?void 0:X.extra)==null?void 0:Z.receiver)==null?void 0:v.address),1)]))])]),e.createVNode(E,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=S=>i.value=S),type:"card",onTabChange:f},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value,(S,A)=>(e.openBlock(),e.createBlock(T,{key:A,label:"包裹"+(A+1),name:A},{default:e.withCtx(()=>{var ee,te,oe,ae,ne,le;return[e.createElementVNode("div",Nt,[e.createElementVNode("div",ht,[e.createVNode(N,{data:S.orderItems,border:"",style:{width:"500px"}},{default:e.withCtx(()=>[e.createVNode(_,{label:"商品 ",width:"400px"},{default:e.withCtx(({row:m})=>[e.createElementVNode("div",Vt,[e.createVNode(V,{src:m==null?void 0:m.image,title:m==null?void 0:m.productName,fits:"cover",shape:"square",size:"large",style:{width:"70px",height:"70px","margin-right":"10px"}},null,8,["src","title"]),e.createElementVNode("div",null,[e.createElementVNode("div",null,e.toDisplayString(m==null?void 0:m.productName),1),e.createElementVNode("div",null,e.toDisplayString(m==null?void 0:m.specs),1)])])]),_:1}),e.createVNode(_,{align:"center",label:"发货数"},{default:e.withCtx(({row:m})=>[e.createTextVNode(e.toDisplayString(m==null?void 0:m.num),1)]),_:1})]),_:2},1032,["data"]),S.type!=="WITHOUT"?(e.openBlock(),e.createElementBlock("div",ut,[l[3]||(l[3]=e.createElementVNode("div",{class:"logisticsInfo__title"},"物流详情",-1)),e.createVNode(n,{ref_for:!0,ref:"scrollbarRef",style:{"margin-left":"10px"}},{default:e.withCtx(()=>[e.createVNode(b,{class:"logisticsInfo__timeline"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.value,(m,$)=>(e.openBlock(),e.createBlock(u,{key:m.time+$,color:$===0?"#409eff":" ",timestamp:`${m.context}`,class:"logisticsInfo__timeline--item",style:{"padding-bottom":"42px"}},{default:e.withCtx(()=>[e.createVNode(I,null,{default:e.withCtx(()=>[e.createElementVNode("div",{style:e.normalizeStyle({color:$===0?"#409eff":" "}),class:"logisticsInfo__timeline--status"},e.toDisplayString(m.status),5),e.createElementVNode("div",{style:e.normalizeStyle({color:$===0?"#409eff":" "}),class:"logisticsInfo__timeline--time"},e.toDisplayString(m.time),5)]),_:2},1024)]),_:2},1032,["color","timestamp"]))),128))]),_:2},1024)]),_:2},1536)])):e.createCommentVNode("",!0)]),e.createElementVNode("div",Et,[l[4]||(l[4]=e.createElementVNode("div",{class:"logisticsInfo__title"},"物流信息",-1)),S.type!=="WITHOUT"?(e.openBlock(),e.createElementBlock("div",Ct,[e.createElementVNode("div",It,"收货地址："+e.toDisplayString((te=(ee=d.value[i.value])==null?void 0:ee.receiver)==null?void 0:te.address),1),e.createElementVNode("div",bt,"物流公司："+e.toDisplayString((ae=(oe=d.value[i.value])==null?void 0:oe.express)==null?void 0:ae.expressCompanyName),1),e.createElementVNode("div",Tt,"物流单号："+e.toDisplayString((le=(ne=d.value[i.value])==null?void 0:ne.express)==null?void 0:le.expressNo),1)])):(e.openBlock(),e.createElementBlock("div",kt,"无需物流"))])])]}),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}}}),$t="",Ot=Object.freeze(Object.defineProperty({__proto__:null,default:me(St,[["__scopeId","data-v-574d4514"]])},Symbol.toStringTag,{value:"Module"}));return Be});

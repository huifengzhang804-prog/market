(function(e,d){typeof exports=="object"&&typeof module<"u"?module.exports=d(require("vue"),require("element-plus"),require("@/apis/http"),require("@/store/modules/shopInfo"),require("@/constant"),require("@/components/element-plus/el-table/ElTableEmpty/index.vue"),require("@/components/BetterPageManage/BetterPageManage.vue")):typeof define=="function"&&define.amd?define(["vue","element-plus","@/apis/http","@/store/modules/shopInfo","@/constant","@/components/element-plus/el-table/ElTableEmpty/index.vue","@/components/BetterPageManage/BetterPageManage.vue"],d):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopInvoiceHeader=d(e.ShopInvoiceHeaderContext.Vue,e.ShopInvoiceHeaderContext.ElementPlus,e.ShopInvoiceHeaderContext.Request,e.ShopInvoiceHeaderContext.ShopInfoStore,e.ShopInvoiceHeaderContext.Constant,e.ShopInvoiceHeaderContext.ElTableEmpty,e.ShopInvoiceHeaderContext.PageManage))})(this,function(e,d,f,y,N,E,I){"use strict";var C=document.createElement("style");C.textContent=`@charset "UTF-8";.head[data-v-92b19df2]{padding:0 30px 20px;display:flex;align-items:center;justify-content:space-between}.head__title[data-v-92b19df2]{color:#bebebe;font-size:14px}.flex[data-v-92b19df2]{display:flex}
`,document.head.appendChild(C);const b=l=>f.get({url:"addon-invoice/invoice/invoice-headers/pageInvoiceHeader",params:{...l,ownerType:"SHOP"}}),H=l=>f.put({url:"addon-invoice/invoice/invoice-headers/default-invoice-header",data:l}),w=l=>f.post({url:"addon-invoice/invoice/invoice-headers/invoice-header",data:l}),k=l=>f.del({url:`addon-invoice/invoice/invoice-headers/${l}`}),S=l=>f.get({url:"addon-invoice/invoice/invoice-headers",params:l}),T={class:"head handle_container"},v={class:"table_container"},B={class:"flex"},P={key:0,style:{color:"rgba(24, 144, 255, 1)"}},A={class:"right_btn"},R={class:"dialog-footer"},q=e.defineComponent({__name:"ShopInvoiceHeader",setup(l){const x=y.useShopInfoStore(),V=e.ref([]),i=e.ref(!1),g=e.ref(),n=e.ref({id:"",ownerType:"SHOP",ownerId:x.getterShopInfo.id,invoiceHeaderType:"ENTERPRISE",header:"",taxIdentNo:"",openingBank:"",bankAccountNo:"",enterprisePhone:"",enterpriseAddress:"",email:""}),M=e.reactive({invoiceHeaderType:[{required:!0,message:"请选择抬头类型",trigger:"blur"}],header:[{required:!0,message:"请输入抬头",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:N.REGEX.EMAIL,message:"请输入正确的邮箱",trigger:"blur"}],taxIdentNo:[{required:!0,message:"请输入税号",trigger:"blur"}],enterprisePhone:[{pattern:N.REGEX.MOBILE,message:"请输入正确的手机号",trigger:"blur"}]});m();const s=e.reactive({size:10,current:1,total:0}),U=a=>{s.current=1,s.size=a,m()},D=a=>{s.current=a,m()};async function m(){const{code:a,data:t,msg:r}=await b(s);if(a!==200)return d.ElMessage.error(r||"获取发票抬头列表失败");V.value=t.records,s.current=t.current,s.total=t.total}async function F(a){const{code:t,data:r,msg:c}=await H({id:a,ownerType:"SHOP",ownerId:x.getterShopInfo.id});if(t!==200)return d.ElMessage.error(c||"设置默认抬头失败");m()}const O=()=>{n.value={...n.value,openingBank:"",bankAccountNo:"",enterprisePhone:"",enterpriseAddress:""}};async function z(){g.value.validate(async a=>{a&&$()})}async function $(){n.value.invoiceHeaderType==="PERSONAL"&&(n.value.taxIdentNo="");const{code:a,data:t,msg:r}=await w(n.value);if(a!==200)return d.ElMessage.error(r||"保存失败");d.ElMessage.success("保存成功"),m(),i.value=!1}const L=()=>{i.value=!1,n.value={...n.value,id:"",invoiceHeaderType:"ENTERPRISE",header:"",email:"",taxIdentNo:"",openingBank:"",bankAccountNo:"",enterprisePhone:"",enterpriseAddress:""},g.value.resetFields()},G=a=>{d.ElMessageBox.confirm("确定要删除该抬头?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{code:t,success:r}=await k(a);t===200&&r?(d.ElMessage.success("删除成功"),m()):d.ElMessage.error("删除失败")})},j=async a=>{const{code:t,msg:r,data:c}=await S({invoiceHeaderId:a,invoiceHeaderOwnerType:"SHOP"});if(t!==200)return d.ElMessage.error(r||"获取详情失败");n.value={...n.value,...c},i.value=!0};return(a,t)=>{const r=e.resolveComponent("el-button"),c=e.resolveComponent("el-table-column"),X=e.resolveComponent("el-table"),h=e.resolveComponent("el-radio"),J=e.resolveComponent("el-radio-group"),p=e.resolveComponent("el-form-item"),u=e.resolveComponent("el-input"),K=e.resolveComponent("el-form"),Q=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",T,[t[13]||(t[13]=e.createElementVNode("div",{class:"head__title"},"您向供应商申请开票时需要使用的发票信息",-1)),e.createVNode(r,{type:"primary",round:"",onClick:t[0]||(t[0]=o=>i.value=!0)},{default:e.withCtx(()=>t[12]||(t[12]=[e.createTextVNode("新增")])),_:1})]),e.createElementVNode("div",v,[e.createVNode(X,{stripe:"",data:V.value,"header-row-style":{color:"#333",height:"48px"},"header-cell-style":{background:"#F7F8FA"},"cell-style":{fontSize:"14px",color:"#333333"}},{empty:e.withCtx(()=>[e.createVNode(E)]),default:e.withCtx(()=>[e.createVNode(c,{prop:"contactName",label:"抬头"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",B,[o.isDefault?(e.openBlock(),e.createElementBlock("div",P,"默认")):e.createCommentVNode("",!0),e.createElementVNode("div",null,e.toDisplayString(o.header),1)])]),_:1}),e.createVNode(c,{prop:"taxIdentNo",label:"税号"}),e.createVNode(c,{prop:"email",label:"邮箱"}),e.createVNode(c,{prop:"invoiceHeaderType",label:"发票类型",width:"100"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(o.invoiceHeaderType==="PERSONAL"?"个人":"企业"),1)]),_:1}),e.createVNode(c,{fixed:"right",label:"操作",align:"right",width:"250"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",A,[o.isDefault?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(r,{key:0,type:"primary",size:"small",link:"",onClick:_=>F(o.id)},{default:e.withCtx(()=>t[14]||(t[14]=[e.createTextVNode("设为默认")])),_:2},1032,["onClick"])),e.createVNode(r,{type:"primary",size:"small",link:"",onClick:_=>j(o.id)},{default:e.withCtx(()=>t[15]||(t[15]=[e.createTextVNode("编辑")])),_:2},1032,["onClick"]),e.createVNode(r,{type:"danger",size:"small",link:"",onClick:_=>G(o.id)},{default:e.withCtx(()=>t[16]||(t[16]=[e.createTextVNode("删除")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),e.createVNode(I,{modelValue:s,"onUpdate:modelValue":t[1]||(t[1]=o=>s=o),"load-init":!1,total:s.total,background:"",onReload:m,onHandleSizeChange:U,onHandleCurrentChange:D},null,8,["modelValue","total"]),e.createVNode(Q,{modelValue:i.value,"onUpdate:modelValue":t[11]||(t[11]=o=>i.value=o),title:"发票抬头",width:"650px",center:"",onClose:L},{footer:e.withCtx(()=>[e.createElementVNode("span",R,[e.createVNode(r,{onClick:t[10]||(t[10]=o=>i.value=!1)},{default:e.withCtx(()=>t[19]||(t[19]=[e.createTextVNode("取消")])),_:1}),e.createVNode(r,{type:"primary",onClick:z},{default:e.withCtx(()=>t[20]||(t[20]=[e.createTextVNode("确定")])),_:1})])]),default:e.withCtx(()=>[e.createVNode(K,{ref_key:"FormRef",ref:g,"label-position":"right","label-width":"90px",model:n.value,rules:M,style:{"max-width":"100%"}},{default:e.withCtx(()=>[e.createVNode(p,{label:"抬头类型",prop:"invoiceHeaderType"},{default:e.withCtx(()=>[e.createVNode(J,{modelValue:n.value.invoiceHeaderType,"onUpdate:modelValue":t[2]||(t[2]=o=>n.value.invoiceHeaderType=o),onChange:O},{default:e.withCtx(()=>[e.createVNode(h,{value:"ENTERPRISE"},{default:e.withCtx(()=>t[17]||(t[17]=[e.createTextVNode("企业")])),_:1}),e.createVNode(h,{value:"PERSONAL"},{default:e.withCtx(()=>t[18]||(t[18]=[e.createTextVNode("个人 或 事业单位")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createVNode(p,{label:"发票抬头",prop:"header",required:!0},{default:e.withCtx(()=>[e.createVNode(u,{modelValue:n.value.header,"onUpdate:modelValue":t[3]||(t[3]=o=>n.value.header=o)},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"邮箱地址",prop:"email",required:!0},{default:e.withCtx(()=>[e.createVNode(u,{modelValue:n.value.email,"onUpdate:modelValue":t[4]||(t[4]=o=>n.value.email=o)},null,8,["modelValue"])]),_:1}),n.value.invoiceHeaderType==="ENTERPRISE"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(p,{label:"税号",prop:"taxIdentNo",required:!0},{default:e.withCtx(()=>[e.createVNode(u,{modelValue:n.value.taxIdentNo,"onUpdate:modelValue":t[5]||(t[5]=o=>n.value.taxIdentNo=o)},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"开户行",prop:"openingBank"},{default:e.withCtx(()=>[e.createVNode(u,{modelValue:n.value.openingBank,"onUpdate:modelValue":t[6]||(t[6]=o=>n.value.openingBank=o)},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"银行账号",prop:"bankAccountNo"},{default:e.withCtx(()=>[e.createVNode(u,{modelValue:n.value.bankAccountNo,"onUpdate:modelValue":t[7]||(t[7]=o=>n.value.bankAccountNo=o)},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"企业电话",prop:"enterprisePhone"},{default:e.withCtx(()=>[e.createVNode(u,{modelValue:n.value.enterprisePhone,"onUpdate:modelValue":t[8]||(t[8]=o=>n.value.enterprisePhone=o),maxlength:"11",onkeyup:"value=value.replace(/[^\\d]/g,'')"},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"企业地址",prop:"enterpriseAddress"},{default:e.withCtx(()=>[e.createVNode(u,{modelValue:n.value.enterpriseAddress,"onUpdate:modelValue":t[9]||(t[9]=o=>n.value.enterpriseAddress=o)},null,8,["modelValue"])]),_:1})],64)):e.createCommentVNode("",!0)]),_:1},8,["model","rules"]),t[21]||(t[21]=e.createElementVNode("div",{style:{"text-align":"center"}},"邮箱地址用于接收电子发票",-1))]),_:1},8,["modelValue"])],64)}}}),W="";return((l,x)=>{const V=l.__vccOpts||l;for(const[i,g]of x)V[i]=g;return V})(q,[["__scopeId","data-v-92b19df2"]])});

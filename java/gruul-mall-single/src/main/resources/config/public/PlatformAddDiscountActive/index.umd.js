(function(e,s){typeof exports=="object"&&typeof module<"u"?module.exports=s(require("vue"),require("vue-router"),require("@/apis/http"),require("element-plus"),require("@/composables/useConvert")):typeof define=="function"&&define.amd?define(["vue","vue-router","@/apis/http","element-plus","@/composables/useConvert"],s):(e=typeof globalThis<"u"?globalThis:e||self,e.PlatformAddDiscountActive=s(e.PlatformAddDiscountActiveContext.Vue,e.PlatformAddDiscountActiveContext.VueRouter,e.PlatformAddDiscountActiveContext.Request,e.PlatformAddDiscountActiveContext.ElementPlus,e.PlatformAddDiscountActiveContext.UseConvert))})(this,function(e,s,b,w,D){"use strict";var h=document.createElement("style");h.textContent=`@charset "UTF-8";.add[data-v-e60e45fa]{overflow-y:scroll}.title[data-v-e60e45fa]{font-size:14px;color:#606266;font-weight:700;margin-bottom:40px}.msg[data-v-e60e45fa]{font-size:12px;margin-left:12px;color:#c4c4c4}.rules[data-v-e60e45fa]{display:flex;margin-top:10px;height:50px}.period-validity[data-v-e60e45fa]{width:300px;display:flex}.text[data-v-e60e45fa]{font-size:14px;color:#333}.goodsData[data-v-e60e45fa]{border:1px solid #ccc}.goods-list[data-v-e60e45fa]{width:90%;margin-top:20px;height:300px;border:1px solid transparent}.goods-list__info[data-v-e60e45fa]{display:flex}.goods-list__goods-list__info-name[data-v-e60e45fa]{display:flex;flex-direction:column;justify-content:space-around;align-items:flex-start;padding:0 16px}.goods-list__goods-list__info-name--name[data-v-e60e45fa]{width:462px;font-size:14px;color:#2e99f3;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.goods-list__goods-list__info-name--price[data-v-e60e45fa]{font-size:14px;text-align:LEFT;color:#f12f22}.goods-list__goods-list__info-name--price[data-v-e60e45fa]:before{content:"￥";font-size:12px;text-align:LEFT;color:#f12f22}.my-header[data-v-e60e45fa]{font-size:16px}.ruleform-date[data-v-e60e45fa]{width:100%;display:flex;align-items:center}.flex[data-v-e60e45fa]{margin-top:10px;height:60px}.flex-item[data-v-e60e45fa]{width:40%}.coupon-rules[data-v-e60e45fa]{height:60px;display:flex;justify-content:center;align-items:center}.nav-button[data-v-e60e45fa]{margin-top:auto;align-items:center;position:sticky;bottom:0;padding:15px 0;display:flex;justify-content:center;box-shadow:0 0 10px #d5d5d5;background-color:#fff;z-index:9}
`,document.head.appendChild(h);const U=[{label:"满X元减",value:"FULL_REDUCTION"},{label:"满X元折",value:"FULL_DISCOUNT"}],T="addon-full-reduction/full/reduction",E=p=>b.post({url:`${T}/detail`,data:p}),k={class:"q_plugin_container"},L={class:"add",style:{padding:"40px"}},P={class:"ruleform-date"},R={key:0,class:"fcenter",style:{width:"100%"}},I={key:1,class:"flex",style:{width:"100%"}},Y={class:"fcenter"},F={class:"nav-button"},d=!0,M=e.defineComponent({__name:"PlatformAddDiscountActive",setup(p){const _=s.useRouter(),m=s.useRoute(),x=m.query.shopId,V=m.query.id,f=e.ref(),B=e.ref(),{divTenThousand:O}=D(),a=e.ref({id:null,name:"",time:{start:"",end:""},rules:[],productType:"ALL_PRODUCT",productIds:[]});q();async function q(){if(!m.query.id)return;const{code:r,data:t,msg:i}=await E({shopId:x,id:V});if(r!==200){w.ElMessage.error(i||"获取活动信息失败");return}t.rules=H(t.rules,z),f.value=t.products.map(l=>({productId:l.id,productName:l.name,pic:l.image})),delete t.products,a.value=t}function z(r){return r?O(r).toNumber():0}function H(r,t){return r.map(i=>{const{type:l,conditionAmount:c,discountAmount:C,discountRatio:y}=i;return i.type==="FULL_DISCOUNT"?{type:l,conditionAmount:t(c),discountRatio:y}:i.type==="FULL_REDUCTION"?{type:l,conditionAmount:t(c),discountAmount:t(C)}:i})}return(r,t)=>{const i=e.resolveComponent("el-input"),l=e.resolveComponent("el-form-item"),c=e.resolveComponent("el-date-picker"),C=e.resolveComponent("el-option"),y=e.resolveComponent("el-select"),g=e.resolveComponent("el-table-column"),u=e.resolveComponent("el-input-number"),A=e.resolveComponent("el-table"),N=e.resolveComponent("el-radio"),S=e.resolveComponent("el-radio-group"),j=e.resolveComponent("el-image"),$=e.resolveComponent("el-form"),G=e.resolveComponent("el-button");return e.openBlock(),e.createElementBlock("div",k,[e.createElementVNode("div",L,[t[16]||(t[16]=e.createElementVNode("h1",{class:"title"},"基本信息",-1)),e.createVNode($,{ref_key:"ruleFormRef",ref:B,"inline-message":!1,model:a.value,"label-width":"auto"},{default:e.withCtx(()=>[e.createVNode(l,{label:"活动名称"},{default:e.withCtx(()=>[e.createVNode(i,{modelValue:a.value.name,"onUpdate:modelValue":t[0]||(t[0]=o=>a.value.name=o),modelModifiers:{trim:!0},disabled:d,maxlength:"5",placeholder:"请输入活动名称",style:{width:"551px"}},null,8,["modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"msg"},"活动名称不超过5个字",-1))]),_:1}),e.createVNode(l,{label:"活动时间",required:""},{default:e.withCtx(()=>[e.createElementVNode("div",P,[e.createVNode(l,{"inline-message":!1},{default:e.withCtx(()=>[e.createVNode(c,{modelValue:a.value.time.start,"onUpdate:modelValue":t[1]||(t[1]=o=>a.value.time.start=o),disabled:d,format:"YYYY/MM/DD HH:mm:ss",placeholder:"请选择开始时间",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"]),t[6]||(t[6]=e.createElementVNode("span",{style:{margin:"0 10px"}},"至",-1))]),_:1}),e.createVNode(l,{"inline-message":!1},{default:e.withCtx(()=>[e.createVNode(c,{modelValue:a.value.time.end,"onUpdate:modelValue":t[2]||(t[2]=o=>a.value.time.end=o),disabled:d,format:"YYYY/MM/DD HH:mm:ss",placeholder:"请选择结束时间",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})])]),_:1}),e.createVNode(l,{label:"活动规则"},{default:e.withCtx(()=>[e.createVNode(A,{"cell-style":{height:"60px"},data:a.value.rules,"header-cell-style":{textAlign:"center",fontSize:"14px",color:"#606266"},border:"",style:{width:"80%"}},{default:e.withCtx(()=>[e.createVNode(g,{label:"满减条件",width:"170"},{default:e.withCtx(({row:o})=>[e.createVNode(l,null,{default:e.withCtx(()=>[e.createVNode(y,{modelValue:o.type,"onUpdate:modelValue":n=>o.type=n,disabled:d,placeholder:"全部类型"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(U),n=>(e.openBlock(),e.createBlock(C,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:1}),e.createVNode(g,{label:"满减规则"},{default:e.withCtx(({row:o})=>[o.type==="FULL_DISCOUNT"?(e.openBlock(),e.createElementBlock("div",R,[e.createVNode(l,{"label-width":"0%"},{default:e.withCtx(()=>[t[7]||(t[7]=e.createElementVNode("span",null,"满",-1)),e.createVNode(u,{modelValue:o.conditionAmount,"onUpdate:modelValue":n=>o.conditionAmount=n,modelModifiers:{number:!0},controls:!1,disabled:d,max:99999,min:1,precision:2,style:{width:"60%",margin:"0 5px"}},null,8,["modelValue","onUpdate:modelValue"]),t[8]||(t[8]=e.createElementVNode("span",null,"元,打",-1))]),_:2},1024),e.createVNode(l,{"label-width":"0%",prop:"discountRatio"},{default:e.withCtx(()=>[e.createVNode(u,{modelValue:o.discountRatio,"onUpdate:modelValue":n=>o.discountRatio=n,modelModifiers:{number:!0},controls:!1,disabled:d,max:9.9,min:.1,precision:1,style:{width:"80%"}},null,8,["modelValue","onUpdate:modelValue"]),t[9]||(t[9]=e.createElementVNode("span",{style:{"margin-left":"5px"}},"折",-1))]),_:2},1024)])):e.createCommentVNode("",!0),o.type==="FULL_REDUCTION"?(e.openBlock(),e.createElementBlock("div",I,[e.createVNode(l,{"label-width":0,prop:"requiredAmount"},{default:e.withCtx(()=>[t[10]||(t[10]=e.createElementVNode("span",null,"满",-1)),e.createVNode(u,{modelValue:o.conditionAmount,"onUpdate:modelValue":n=>o.conditionAmount=n,modelModifiers:{number:!0},controls:!1,disabled:d,max:999999,min:1,precision:2,style:{width:"90px",margin:"0 5px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e.createVNode(l,{"label-width":0,prop:"discountAmount"},{default:e.withCtx(()=>[t[11]||(t[11]=e.createElementVNode("span",null,"元,减",-1)),e.createVNode(u,{modelValue:o.discountAmount,"onUpdate:modelValue":n=>o.discountAmount=n,modelModifiers:{number:!0},controls:!1,disabled:d,max:o.conditionAmount,min:1,precision:2,style:{width:"90px",margin:"0 5px"}},null,8,["modelValue","onUpdate:modelValue","max"]),t[12]||(t[12]=e.createElementVNode("span",{style:{"margin-left":"5px"}},"元",-1))]),_:2},1024)])):e.createCommentVNode("",!0)]),_:1})]),_:1},8,["data"])]),_:1}),e.createVNode(l,{label:"商品选择",prop:"productType"},{default:e.withCtx(()=>[e.createVNode(S,{modelValue:a.value.productType,"onUpdate:modelValue":t[3]||(t[3]=o=>a.value.productType=o),disabled:d},{default:e.withCtx(()=>[e.createVNode(N,{value:"ALL_PRODUCT"},{default:e.withCtx(()=>t[13]||(t[13]=[e.createTextVNode("全部商品参与")])),_:1}),e.createVNode(N,{value:"SPECIFIED_PRODUCT_PARTICIPATE"},{default:e.withCtx(()=>t[14]||(t[14]=[e.createTextVNode("指定商品参与")])),_:1}),e.createVNode(N,{value:"SPECIFIED_PRODUCT_NOT_PARTICIPATE"},{default:e.withCtx(()=>t[15]||(t[15]=[e.createTextVNode("指定商品不参与")])),_:1})]),_:1},8,["modelValue"]),a.value.productType!=="ALL_PRODUCT"&&f.value.length?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass([f.value.length&&"goodsData","goods-list"])},[e.createVNode(A,{data:f.value,"header-cell-style":{fontSize:"14px",color:"#606266",background:"#f2f2f2",height:"54px",fontWeight:"normal"},height:"260px",style:{width:"100%"}},{default:e.withCtx(()=>[e.createVNode(g,{label:"商品信息"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",Y,[e.createVNode(j,{"preview-src-list":[o.pic],"preview-teleported":!0,src:o.pic,fit:"",style:{width:"60px",height:"60px"}},null,8,["preview-src-list","src"]),e.createTextVNode(" "+e.toDisplayString(o.productName),1)])]),_:1})]),_:1},8,["data"])],2)):e.createCommentVNode("",!0)]),_:1})]),_:1},8,["model"])]),e.createElementVNode("div",F,[e.createVNode(G,{plain:"",round:"",onClick:t[4]||(t[4]=o=>e.unref(_).back())},{default:e.withCtx(()=>t[17]||(t[17]=[e.createTextVNode("返回")])),_:1})])])}}}),X="";return((p,_)=>{const m=p.__vccOpts||p;for(const[x,V]of _)m[x]=V;return m})(M,[["__scopeId","data-v-e60e45fa"]])});

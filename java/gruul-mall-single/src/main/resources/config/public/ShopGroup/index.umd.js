(function(e,S){typeof exports=="object"&&typeof module<"u"?module.exports=S(require("vue"),require("@/components/ChromeTab.vue"),require("@vueuse/core"),require("@/components/SchemaForm.vue"),require("@/components/PageManage.vue"),require("@/store/modules/shopInfo"),require("element-plus"),require("vue-router"),require("@/utils/http"),require("decimal.js"),require("@/composables/useConvert")):typeof define=="function"&&define.amd?define(["vue","@/components/ChromeTab.vue","@vueuse/core","@/components/SchemaForm.vue","@/components/PageManage.vue","@/store/modules/shopInfo","element-plus","vue-router","@/utils/http","decimal.js","@/composables/useConvert"],S):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopGroup=S(e.ShopGroupContext.Vue,e.ShopGroupContext.ChromeTabs,e.ShopGroupContext.VueUse,e.ShopGroupContext.SchemaForms,e.ShopGroupContext.PageManageTwo,e.ShopGroupContext.ShopInfoStore,e.ShopGroupContext.ElementPlus,e.ShopGroupContext.VueRouter,e.ShopGroupContext.UtilsHttp,e.ShopGroupContext.Decimal,e.ShopGroupContext.UseConvert))})(this,function(e,S,H,D,F,M,C,G,k,pe,P){"use strict";var $=document.createElement("style");$.textContent=`@charset "UTF-8";*,:before,:after{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }::backdrop{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }.fixed,[fixed=\"\"]{position:fixed}.flex{display:flex}.col-last[data-v-505be4ec]{display:flex;justify-content:flex-end}.m-l-20[data-v-505be4ec]{margin-left:20px}.container[data-v-51b0bee5]{overflow-y:scroll}.reason[data-v-51b0bee5]{padding:10px 10px 20px}[data-v-51b0bee5] .el-button.is-link{padding:0}[data-v-51b0bee5] .el-button+.el-button{margin-left:10px}.group__head[data-v-6d1eaf1a]{display:flex;justify-content:flex-end;align-items:center}.group__head--center[data-v-6d1eaf1a]{margin:0 20px}.group__userInfo[data-v-6d1eaf1a]{display:flex;align-items:center}.group__userInfo--text[data-v-6d1eaf1a]{width:86px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-left:5px}.group__goodInfo[data-v-6d1eaf1a]{display:flex;align-items:center}.group__goodInfo--text[data-v-6d1eaf1a]{width:154px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden;margin-left:5px}.group__content[data-v-6d1eaf1a]{margin-top:10px}
`,document.head.appendChild($);const ue="",j={class:"q_plugin_container"},q={class:"fdc1 overh"},R=e.defineComponent({__name:"ShopGroup",setup(n){const g={GroupActivity:e.defineAsyncComponent(()=>Promise.resolve().then(()=>ne)),GroupOrder:e.defineAsyncComponent(()=>Promise.resolve().then(()=>de))},r=e.ref("GroupActivity"),d=[{name:"GroupActivity",label:"拼团活动"},{name:"GroupOrder",label:"拼团订单"}],u=_=>{_&&(r.value=_)};return(_,h)=>(e.openBlock(),e.createElementBlock("div",j,[e.createVNode(S,{"tab-list":d,value:r.value,onHandleTabs:u},null,8,["value"]),e.createElementVNode("div",q,[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(g[r.value])))])]))}}),U=(n=>(e.pushScopeId("data-v-505be4ec"),n=n(),e.popScopeId(),n))(()=>e.createElementVNode("div",{class:"grey_bar"},null,-1)),J=e.defineComponent({__name:"head-search",props:{modelValue:{type:Object,default(){return{}}},batchDisabled:{type:Boolean,default:!0},leftBtnText:{type:String,default:"leftBtnText"}},emits:["update:modelValue","search"],setup(n,{emit:g}){const r=n,u=[{label:"活动名称",prop:"keyword",valueType:"copy",fieldProps:{placeholder:"请输入活动名称"}},{label:"活动状态",prop:"status",valueType:"select",options:[{value:"",label:"全部状态"},{value:"OPENING",label:"未开始"},{value:"OPEN",label:"进行中"},{value:"FINISHED",label:"已结束"},{value:"SHOP_OFF_SHELF",label:"已下架"},{value:"VIOLATION",label:"违规下架"}],fieldProps:{placeholder:"请选择"}}],_=g,h=H.useVModel(r,"modelValue",_),w=y=>{y&&Object.keys(y).forEach(p=>r.modelValue[p]=y[p])},E=()=>{Object.keys(r.modelValue).forEach(y=>r.modelValue[y]=""),_("search")};return(y,p)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(D,{"v-model":e.unref(h),columns:u,onSearchHandle:p[0]||(p[0]=T=>_("search")),onChangeFormItem:w,onHandleReset:E},null,8,["v-model"]),U],64))}}),me="",A=(n,g)=>{const r=n.__vccOpts||n;for(const[d,u]of g)r[d]=u;return r},K=A(J,[["__scopeId","data-v-505be4ec"]]),Q=n=>k.http.get({url:"addon-team/team/activity",params:n},{isMock:!1}),W=n=>k.http.get({url:"addon-team/team/activity/order",params:n},{isMock:!1}),X=n=>k.http.post({url:"addon-team/team/activity/delete/batch",data:n}),Y=n=>k.http.post({url:`addon-team/team/activity/shop/shelf/${n}`}),Z=n=>k.http.get({url:`addon-team/team/activity/illegal/${n}/reason`}),v={class:"handle_container",style:{"padding-top":"16px"}},ee={class:"table_container"},te={class:"reason"},oe=e.defineComponent({__name:"group-activity",setup(n){const g=G.useRouter(),r=G.useRoute(),d=e.ref([]),u=e.ref({keyword:"",status:"",date:""}),_=e.ref(),h=e.reactive({size:10,current:1,total:0}),w={OPENING:"未开始",PREHEAT:"预售中",OPEN:"进行中",FINISHED:"已结束",SHOP_OFF_SHELF:"已下架",VIOLATION:"违规下架"},E={COMMON:"普通拼团",STAIRS:"阶梯拼团"};e.onBeforeMount(()=>{p()}),e.watch(()=>r.query.flag,()=>{p()});const y=(a,o)=>{g.push({name:"marketingAppGroupForm",query:{id:a,isLookUp:o}})};async function p(){const a={...h,...u.value,shopId:M.useShopInfoStore().shopInfo.id},{code:o,data:l}=await Q(a);if(o!==200)return C.ElMessage.error("获取活动列表失败");d.value=l.records,h.total=l.total}const T=a=>{h.current=a,p()},L=a=>{h.size=a,p()},O=async(a,o)=>{const l=o??"确定删除该活动?";try{if(!await C.ElMessageBox.confirm(l,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}))return;const V=Array.isArray(a)?a.map(x=>({...x,activityId:x.id})):[{...a,activityId:a.id}];V.forEach(x=>{x.activityId=x.id});const{code:B,data:t}=await X(V);if(B!==200){C.ElMessage.error("删除失败");return}C.ElMessage.success("删除成功"),p()}catch{}},f=e.ref([]),s=async()=>{const o=f.value.filter(V=>V.status!=="OPEN").length,l=f.value.length,i=o===l?"确定批量删除活动?":`确定批量删除活动? 其中有${l-o}条数据为进行中,无法进行删除 已自动剔除！`;O(f.value,i)},b=a=>{f.value=a},N=async a=>{try{if(!await C.ElMessageBox.confirm("确定下架商品吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}))return;const{msg:l,code:i}=await Y(a);if(i!==200)return C.ElMessage.error(l??"下架失败");p()}catch(o){console.log("error",o)}},m=e.ref(!1),I=e.ref("违规原因"),z=async a=>{try{const{msg:o,data:l,code:i}=await Z(a);if(i!==200||!l)return C.ElMessage.error(o??"获取下架原因失败！");I.value=l,m.value=!0}catch(o){console.log("error",o)}},c=()=>{I.value="",m.value=!1};return(a,o)=>{const l=e.resolveComponent("el-button"),i=e.resolveComponent("el-table-column"),V=e.resolveComponent("el-table"),B=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(K,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=t=>u.value=t),onSearch:p},null,8,["modelValue"]),e.createElementVNode("div",v,[e.createVNode(l,{round:"",type:"primary",onClick:o[1]||(o[1]=t=>e.unref(g).push({name:"marketingAppGroupNewForm"}))},{default:e.withCtx(()=>[e.createTextVNode("新增拼团")]),_:1}),e.createVNode(l,{disabled:!f.value.length,round:"",onClick:s},{default:e.withCtx(()=>[e.createTextVNode(" 批量删除 ")]),_:1},8,["disabled"])]),e.createElementVNode("div",ee,[e.createVNode(V,{ref_key:"multipleTableRef",ref:_,data:d.value,"header-cell-style":{background:"#f6f8fa",height:"48px"},"header-row-style":{color:"#333"},onSelectionChange:b},{default:e.withCtx(()=>[e.createVNode(i,{type:"selection",width:"30",fixed:"",selectable:t=>t.status!=="OPEN"},null,8,["selectable"]),e.createVNode(i,{label:"活动名称",width:"220"},{default:e.withCtx(({row:t})=>[e.createTextVNode(e.toDisplayString(t.name),1)]),_:1}),e.createVNode(i,{label:"拼团模式",width:"140"},{default:e.withCtx(({row:t})=>[e.createTextVNode(e.toDisplayString(E[t.mode]),1)]),_:1}),e.createVNode(i,{label:"状态",width:"140"},{default:e.withCtx(({row:t})=>[e.createElementVNode("span",{style:e.normalizeStyle(`color: ${t.status==="VIOLATION"?"#f12f22":"inherit"}`)},e.toDisplayString(w[t.status]),5)]),_:1}),e.createVNode(i,{label:"活动时间",width:"240"},{default:e.withCtx(({row:t})=>[e.createElementVNode("div",null,"起："+e.toDisplayString(t.startTime),1),e.createElementVNode("div",null,"止："+e.toDisplayString(t.endTime),1)]),_:1}),e.createVNode(i,{label:"活动商品",width:"120"},{default:e.withCtx(({row:t})=>[e.createTextVNode(e.toDisplayString(t.productNum||0),1)]),_:1}),e.createVNode(i,{label:"支付单数",width:"120"},{default:e.withCtx(({row:t})=>[e.createTextVNode(e.toDisplayString(t.orders||0),1)]),_:1}),e.createVNode(i,{label:"操作",fixed:"right",align:"right"},{default:e.withCtx(({row:t})=>[e.createVNode(l,{type:"primary",link:"",onClick:x=>y(t.id,"true")},{default:e.withCtx(()=>[e.createTextVNode("查看")]),_:2},1032,["onClick"]),t.status==="OPEN"?(e.openBlock(),e.createBlock(l,{key:0,type:"primary",link:"",onClick:x=>N(t.id)},{default:e.withCtx(()=>[e.createTextVNode("下架")]),_:2},1032,["onClick"])):e.createCommentVNode("",!0),t.status==="VIOLATION"?(e.openBlock(),e.createBlock(l,{key:1,type:"primary",link:"",onClick:x=>z(t.id)},{default:e.withCtx(()=>[e.createTextVNode("违规原因")]),_:2},1032,["onClick"])):e.createCommentVNode("",!0),t.status!=="OPEN"?(e.openBlock(),e.createBlock(l,{key:2,type:"danger",link:"",onClick:x=>O(t)},{default:e.withCtx(()=>[e.createTextVNode("删除")]),_:2},1032,["onClick"])):e.createCommentVNode("",!0)]),_:1})]),_:1},8,["data"])]),e.createVNode(F,{"page-size":h.size,"page-num":h.current,total:h.total,onHandleCurrentChange:T,onHandleSizeChange:L},null,8,["page-size","page-num","total"]),e.createVNode(B,{modelValue:m.value,"onUpdate:modelValue":o[2]||(o[2]=t=>m.value=t),title:"违规原因",width:"600px",center:"",onClose:c},{default:e.withCtx(()=>[e.createElementVNode("div",te,e.toDisplayString(I.value),1)]),_:1},8,["modelValue"])],64)}}}),_e="",ne=Object.freeze(Object.defineProperty({__proto__:null,default:A(oe,[["__scopeId","data-v-51b0bee5"]])},Symbol.toStringTag,{value:"Module"})),ae={class:"table_container",style:{"padding-top":"26px"}},re={class:"group__userInfo"},le={class:"group__userInfo--text"},se={class:"group__goodInfo"},ce={class:"group__goodInfo--text"},ie=e.defineComponent({__name:"group-order",setup(n){const g=G.useRouter(),r=e.reactive({status:"SUCCESS",commander:"",productName:""}),d=e.reactive({current:1,size:10,total:0}),u=e.ref([]),{divTenThousand:_}=P(),h=[{label:"拼团状态",prop:"status",valueType:"select",options:[{label:"拼团成功",value:"SUCCESS"},{label:"拼团失败",value:"FAIL"},{label:"拼团中",value:"ING"}],fieldProps:{placeholder:"请选择"}},{label:"发起人",prop:"commander",valueType:"copy",fieldProps:{placeholder:"请输入发起人姓名"}},{label:"商品名称",prop:"productName",valueType:"copy",fieldProps:{placeholder:"请输入商品名称"}}];f();const w=s=>({SUCCESS:"拼团成功",FAIL:"拼团失败",ING:"拼团中"})[s],E=s=>{g.push({name:"marketingAppGroupOrderDetail",query:{teamNo:s}})},y=s=>{d.size=s,f()},p=s=>{d.current=s,f()},T=()=>{f()},L=s=>{s&&Object.keys(s).forEach(b=>r[b]=s[b])},O=()=>{Object.keys(r).forEach(s=>r[s]=""),f()};async function f(){const s={...d,...r},{data:b,code:N}=await W(s);if(N!==200)return C.ElMessage.error("获取拼团订单失败");u.value=b.records,d.total=b.total}return(s,b)=>{const N=e.resolveComponent("el-image"),m=e.resolveComponent("el-table-column"),I=e.resolveComponent("el-button"),z=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(D,{"v-model":r,columns:h,showNumber:3,onSearchHandle:T,onChangeFormItem:L,onHandleReset:O},null,8,["v-model"]),e.createElementVNode("div",ae,[e.createVNode(z,{data:u.value,"header-cell-style":{height:"48px",background:"#F7F8FA"},"header-row-style":{color:"#333"}},{default:e.withCtx(()=>[e.createVNode(m,{label:"发起人",width:"180"},{default:e.withCtx(({row:c})=>[e.createElementVNode("div",re,[e.createVNode(N,{src:c.commanderAvatar,style:{width:"30px",height:"30px"}},null,8,["src"]),e.createElementVNode("div",le,e.toDisplayString(c.commanderNickname),1)])]),_:1}),e.createVNode(m,{label:"商品信息",width:"210"},{default:e.withCtx(({row:c})=>[e.createElementVNode("div",se,[e.createVNode(N,{src:c.productImage,style:{width:"36px",height:"36px"}},null,8,["src"]),e.createElementVNode("div",ce,e.toDisplayString(c.productName),1)])]),_:1}),e.createVNode(m,{label:"开团时间",prop:"openTime"}),e.createVNode(m,{label:"参团人数",width:"100"},{default:e.withCtx(({row:c})=>[e.createElementVNode("div",null,e.toDisplayString(c.currentNum)+"/"+e.toDisplayString(c.totalNum),1)]),_:1}),e.createVNode(m,{label:"订单总金额(元)",width:"160"},{default:e.withCtx(({row:c})=>[e.createElementVNode("div",null,e.toDisplayString(e.unref(_)(c.amount).toFixed(2)),1)]),_:1}),e.createVNode(m,{label:"状态",width:"90"},{default:e.withCtx(({row:c})=>[e.createElementVNode("div",{style:e.normalizeStyle({color:c.status==="SUCCESS"?"#00BB2C":c.status==="FAIL"?"#999999":""})},e.toDisplayString(w(c.status)),5)]),_:1}),e.createVNode(m,{label:"操作",align:"right",width:"100",fixed:"right"},{default:e.withCtx(({row:c})=>[e.createVNode(I,{link:"",type:"primary",onClick:a=>E(c.teamNo)},{default:e.withCtx(()=>[e.createTextVNode("拼团详情")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e.createVNode(F,{"page-size":d.size,"page-num":d.current,total:d.total,onHandleSizeChange:y,onHandleCurrentChange:p},null,8,["page-size","page-num","total"])],64)}}}),ge="",de=Object.freeze(Object.defineProperty({__proto__:null,default:A(ie,[["__scopeId","data-v-6d1eaf1a"]])},Symbol.toStringTag,{value:"Module"}));return R});

(function(e,_){typeof exports=="object"&&typeof module<"u"?module.exports=_(require("vue"),require("vue-router"),require("element-plus"),require("@vueuse/core"),require("@/utils/date"),require("@/composables/useConvert"),require("@/apis/http"),require("@/apis/good")):typeof define=="function"&&define.amd?define(["vue","vue-router","element-plus","@vueuse/core","@/utils/date","@/composables/useConvert","@/apis/http","@/apis/good"],_):(e=typeof globalThis<"u"?globalThis:e||self,e.PlatformCouponInfo=_(e.PlatformCouponInfoContext.Vue,e.PlatformCouponInfoContext.VueRouter,e.PlatformCouponInfoContext.ElementPlus,e.PlatformCouponInfoContext.VueUse,e.PlatformCouponInfoContext.DateUtil,e.PlatformCouponInfoContext.UseConvert,e.PlatformCouponInfoContext.Request,e.PlatformCouponInfoContext.GoodAPI))})(this,function(e,_,y,T,ce,k,A,P){"use strict";var g=document.createElement("style");g.textContent=`@charset "UTF-8";.scroll[data-v-acb4af53]{overflow:scroll;padding-left:16px;padding-right:16px;margin-top:30px}.tool[data-v-acb4af53]{margin-top:auto;align-items:center;position:sticky;bottom:0;padding:15px 0;display:flex;justify-content:center;box-shadow:0 0 10px #d5d5d5;background-color:#fff;z-index:9}.title[data-v-acb4af53]{font-size:14px;color:#606266;font-weight:700;margin-bottom:30px}.msg[data-v-acb4af53]{font-size:12px;margin-left:12px;color:#c4c4c4}.rules[data-v-acb4af53]{display:flex;justify-content:space-between}.rules__input[data-v-acb4af53]{width:50%}.period-validity[data-v-acb4af53]{width:300px;display:flex}.text[data-v-acb4af53]{font-size:14px;color:#333}.goodsData[data-v-acb4af53]{border:1px solid #ccc}.goods-list[data-v-acb4af53]{width:90%;margin-top:40px;height:360px;border:1px solid transparent}.goods-list__info[data-v-acb4af53]{display:flex}.goods-list__goods-list__info-name[data-v-acb4af53]{display:flex;flex-direction:column;justify-content:space-around;align-items:flex-start;padding:0 16px}.goods-list__goods-list__info-name--name[data-v-acb4af53]{width:462px;font-size:14px;color:#2e99f3;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.goods-list__goods-list__info-name--price[data-v-acb4af53]{font-size:14px;text-align:LEFT;color:#f12f22}.goods-list__goods-list__info-name--price[data-v-acb4af53]:before{content:"\\ffe5";font-size:12px;text-align:LEFT;color:#f12f22}.my-header[data-v-acb4af53]{font-size:16px}.ruleform-date[data-v-acb4af53]{width:100%;display:flex}.nav-button[data-v-acb4af53]{position:fixed;bottom:50px;left:50%}
`,document.head.appendChild(g);const b=(a=>a&&typeof a=="object"&&"default"in a?a:{default:a})(k),{divTenThousand:S,mulTenThousand:fe}=b.default(),w={PRICE_DISCOUNT:"\u65E0\u95E8\u69DB\u6298\u6263\u5238",PRICE_REDUCE:"\u65E0\u95E8\u69DB\u73B0\u91D1\u5238",REQUIRED_PRICE_DISCOUNT:"\u6EE1\u6298\u5238",REQUIRED_PRICE_REDUCE:"\u6EE1\u51CF\u5238"};var D=(a=>(a.PERIOD="PERIOD",a.IMMEDIATELY="IMMEDIATELY",a))(D||{}),I=(a=>(a.ALL="ALL",a.SHOP_ALL="SHOP_ALL",a.ASSIGNED="ASSIGNED",a.ASSIGNED_NOT="ASSIGNED_NOT",a))(I||{});function F(a){return a?S(a).toString():""}function U(a){const{name:c,days:i,type:p,endDate:u,productIds:o,productType:m,requiredAmount:C,discount:x,amount:d,effectType:t,startDate:r,num:n,limit:f,id:E,shopId:h}=a;return{shopId:h,id:E,name:c,days:i,endDate:u,productType:m,type:p,requiredAmount:F(C).toString(),discount:x,amount:F(d),effectType:t,startDate:r,num:n,limit:f,productIds:o}}const R=e.defineComponent({__name:"select-couppon-type",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:""},list:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(a,{emit:c}){const i=a,p=c,u=T.useVModel(i,"modelValue",p);return(o,m)=>{const C=e.resolveComponent("el-option"),x=e.resolveComponent("el-select");return e.openBlock(),e.createBlock(x,{modelValue:e.unref(u),"onUpdate:modelValue":m[0]||(m[0]=d=>e.isRef(u)?u.value=d:null),placeholder:i.placeholder,style:{width:"150px"},onChange:m[1]||(m[1]=d=>p("change",d))},{default:e.withCtx(()=>[e.renderSlot(o.$slots,"default"),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(Object.values(i.list).length?i.list:e.unref(w),(d,t)=>(e.openBlock(),e.createBlock(C,{key:t,label:d,value:t},null,8,["label","value"]))),128))]),_:3},8,["modelValue","placeholder"])}}}),q=(a,c)=>A.get({url:`addon-coupon/coupon/shop/${a}/${c}`}),s=a=>(e.pushScopeId("data-v-acb4af53"),a=a(),e.popScopeId(),a),L={class:"q_plugin_container"},M={class:"scroll"},O=s(()=>e.createElementVNode("h1",{class:"title"},"\u57FA\u672C\u4FE1\u606F",-1)),Y=s(()=>e.createElementVNode("span",{class:"msg"},"\u4F18\u60E0\u5238\u540D\u79F0\u4E0D\u8D85\u8FC75\u4E2A\u5B57",-1)),z={key:0,class:"ruleform-date"},G=s(()=>e.createElementVNode("span",{style:{margin:"0 10px"}},"\u81F3",-1)),j={class:"period-validity text"},$={class:"rules"},H=s(()=>e.createElementVNode("span",{style:{"margin-left":"10px"}},"\u6298\uFF0C\u65E0\u95E8\u69DB\u4F7F\u7528",-1)),Q={class:"rules"},W=s(()=>e.createElementVNode("span",{style:{"margin-left":"5px"}},"\u5143\uFF0C\u65E0\u95E8\u69DB\u4F7F\u7528",-1)),J={key:2,class:"rules",style:{"justify-content":"center"}},K=s(()=>e.createElementVNode("span",null,"\u6EE1",-1)),X=s(()=>e.createElementVNode("span",null,"\u5143,\u6253",-1)),Z=s(()=>e.createElementVNode("span",{style:{"margin-left":"5px"}},"\u6298",-1)),v={key:3,class:"rules",style:{"justify-content":"center"}},ee=s(()=>e.createElementVNode("span",null,"\u6EE1",-1)),te=s(()=>e.createElementVNode("span",null,"\u5143,\u51CF",-1)),oe=s(()=>e.createElementVNode("span",{style:{"margin-left":"5px"}},"\u5143",-1)),le={class:"goods-list__info"},ae={class:"goods-list__goods-list__info-name"},ne={class:"goods-list__goods-list__info-name--name"},de={class:"goods-list__goods-list__info-name--price"},re={class:"tool"},ue=e.defineComponent({__name:"PlatformCouponInfo",setup(a){const{divTenThousand:c}=b.default(),i=_.useRouter(),p=_.useRoute(),u=e.ref([]),o=e.ref({name:"",days:"",endDate:"",productType:I.ALL,type:"PRICE_DISCOUNT",requiredAmount:"",discount:"",amount:"",effectType:D.PERIOD,startDate:"",num:"",limit:"",shopId:"",productIds:[]});m();async function m(){if(p.query.id&&p.query.shopId){const{code:d,data:t}=await q(p.query.shopId.toString(),p.query.id.toString());if(d!==200){y.ElMessage.error("\u83B7\u53D6\u4F18\u60E0\u5238\u4FE1\u606F\u5931\u8D25");return}o.value=U(t),x(t);return}}function C(d){const t=Math.max(...d.map(n=>Number(n))),r=Math.min(...d.map(n=>Number(n)));return`${c(r)}~${c(t)}`}async function x(d){if(d.productIds&&d.productIds.length){const{code:t,data:r}=await P.doGetRetrieveProduct({productId:d.productIds});if(t!==200){y.ElMessage.error("\u83B7\u53D6\u5546\u54C1\u4FE1\u606F\u5931\u8D25");return}u.value=r.list.map(n=>({...n,name:n.productName,salePrice:C(n.salePrices||[]),isCheck:!0})),console.log("goodsData.value",u.value)}}return(d,t)=>{const r=e.resolveComponent("el-input"),n=e.resolveComponent("el-form-item"),f=e.resolveComponent("el-radio"),E=e.resolveComponent("el-radio-group"),h=e.resolveComponent("el-row"),N=e.resolveComponent("el-date-picker"),V=e.resolveComponent("el-table-column"),B=e.resolveComponent("el-table"),se=e.resolveComponent("el-image"),ie=e.resolveComponent("el-form"),pe=e.resolveComponent("el-button");return e.openBlock(),e.createElementBlock("div",L,[e.createElementVNode("div",M,[O,e.createVNode(ie,{"inline-message":!1,model:o.value,"validate-on-rule-change":!1,"label-width":"auto"},{default:e.withCtx(()=>[e.createVNode(n,{label:"\u4F18\u60E0\u5238\u540D\u79F0",prop:"name"},{default:e.withCtx(()=>[e.createVNode(r,{modelValue:o.value.name,"onUpdate:modelValue":t[0]||(t[0]=l=>o.value.name=l),modelModifiers:{trim:!0},disabled:"",maxlength:"5",placeholder:"\u8BF7\u8F93\u5165\u4F18\u60E0\u5238\u540D\u79F0",style:{width:"551px"}},null,8,["modelValue"]),Y]),_:1}),e.createVNode(n,{label:"\u6709\u6548\u65F6\u95F4",prop:"effectType"},{default:e.withCtx(()=>[e.createVNode(h,{style:{width:"100%"}},{default:e.withCtx(()=>[e.createVNode(E,{modelValue:o.value.effectType,"onUpdate:modelValue":t[1]||(t[1]=l=>o.value.effectType=l),class:"ml-4",disabled:""},{default:e.withCtx(()=>[e.createVNode(f,{value:"PERIOD"},{default:e.withCtx(()=>[e.createTextVNode("\u56FA\u5B9A\u65F6\u95F4")]),_:1}),e.createVNode(f,{value:"IMMEDIATELY"},{default:e.withCtx(()=>[e.createTextVNode("\u9886\u5238\u7ACB\u5373\u751F\u6548")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createVNode(h,{style:{"margin-top":"20px"}},{default:e.withCtx(()=>[o.value.effectType==="PERIOD"?(e.openBlock(),e.createElementBlock("div",z,[e.createVNode(n,{"inline-message":!1,"label-width":"0",prop:"startDate"},{default:e.withCtx(()=>[e.createVNode(N,{modelValue:o.value.startDate,"onUpdate:modelValue":t[2]||(t[2]=l=>o.value.startDate=l),disabled:"",format:"YYYY/MM/DD",placeholder:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4",type:"date","value-format":"YYYY-MM-DD"},null,8,["modelValue"]),G]),_:1}),e.createVNode(n,{"inline-message":!1,"label-width":"0",prop:"endDate"},{default:e.withCtx(()=>[e.createVNode(N,{modelValue:o.value.endDate,"onUpdate:modelValue":t[3]||(t[3]=l=>o.value.endDate=l),disabled:"",format:"YYYY/MM/DD",placeholder:"\u8BF7\u9009\u62E9\u7ED3\u675F\u65F6\u95F4",type:"date","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})])):(e.openBlock(),e.createBlock(n,{key:1,"label-width":"0",prop:"days"},{default:e.withCtx(()=>[e.createElementVNode("div",j,[e.createTextVNode(" \u9886\u5238\u5F53\u65E5\u8D77 "),e.createVNode(r,{modelValue:o.value.days,"onUpdate:modelValue":t[4]||(t[4]=l=>o.value.days=l),disabled:"",style:{width:"20%",margin:"0 5px"}},null,8,["modelValue"]),e.createTextVNode(" \u5929\u5185\u53EF\u7528 ")])]),_:1}))]),_:1})]),_:1}),e.createVNode(n,{label:"\u6D3B\u52A8\u89C4\u5219",prop:"type"},{default:e.withCtx(()=>[e.createVNode(B,{data:[{}],"header-cell-style":{textAlign:"center",fontSize:"14px",color:"#606266"},border:"",style:{width:"90%"}},{default:e.withCtx(()=>[e.createVNode(V,{label:"\u9009\u62E9\u4F18\u60E0\u5238\u7C7B\u578B"},{default:e.withCtx(()=>[e.createVNode(n,{"label-width":"0",prop:"type"},{default:e.withCtx(()=>[e.createVNode(R,{modelValue:o.value.type,"onUpdate:modelValue":t[5]||(t[5]=l=>o.value.type=l),list:e.unref(w),disabled:"",placeholder:"\u5168\u90E8\u7C7B\u578B"},null,8,["modelValue","list"])]),_:1})]),_:1}),e.createVNode(V,{label:"\u4F18\u60E0\u5238\u89C4\u5219",width:"240"},{default:e.withCtx(()=>[o.value.type==="PRICE_DISCOUNT"?(e.openBlock(),e.createBlock(n,{key:0,"label-width":"0",prop:"discount"},{default:e.withCtx(()=>[e.createElementVNode("div",$,[e.createVNode(r,{modelValue:o.value.discount,"onUpdate:modelValue":t[6]||(t[6]=l=>o.value.discount=l),disabled:"",style:{flex:"1"}},null,8,["modelValue"]),H])]),_:1})):e.createCommentVNode("",!0),o.value.type==="PRICE_REDUCE"?(e.openBlock(),e.createBlock(n,{key:1,"label-width":"0",prop:"amount"},{default:e.withCtx(()=>[e.createElementVNode("div",Q,[e.createVNode(r,{modelValue:o.value.amount,"onUpdate:modelValue":t[7]||(t[7]=l=>o.value.amount=l),disabled:"",style:{flex:"1"}},null,8,["modelValue"]),W])]),_:1})):e.createCommentVNode("",!0),o.value.type==="REQUIRED_PRICE_DISCOUNT"?(e.openBlock(),e.createElementBlock("div",J,[e.createVNode(n,{"label-width":"0%",prop:"requiredAmount"},{default:e.withCtx(()=>[K,e.createVNode(r,{modelValue:o.value.requiredAmount,"onUpdate:modelValue":t[8]||(t[8]=l=>o.value.requiredAmount=l),disabled:"",style:{width:"60%","margin-left":"5px"}},null,8,["modelValue"])]),_:1}),e.createVNode(n,{"label-width":"0%",prop:"discount"},{default:e.withCtx(()=>[X,e.createVNode(r,{modelValue:o.value.discount,"onUpdate:modelValue":t[9]||(t[9]=l=>o.value.discount=l),disabled:"",style:{width:"50%","margin-left":"5px"}},null,8,["modelValue"]),Z]),_:1})])):e.createCommentVNode("",!0),o.value.type==="REQUIRED_PRICE_REDUCE"?(e.openBlock(),e.createElementBlock("div",v,[e.createVNode(n,{"label-width":"0%",prop:"requiredAmount"},{default:e.withCtx(()=>[ee,e.createVNode(r,{modelValue:o.value.requiredAmount,"onUpdate:modelValue":t[10]||(t[10]=l=>o.value.requiredAmount=l),disabled:"",style:{width:"60%","margin-left":"5px"}},null,8,["modelValue"])]),_:1}),e.createVNode(n,{"label-width":"0%",prop:"amount"},{default:e.withCtx(()=>[te,e.createVNode(r,{modelValue:o.value.amount,"onUpdate:modelValue":t[11]||(t[11]=l=>o.value.amount=l),disabled:"",style:{width:"50%","margin-left":"5px"}},null,8,["modelValue"]),oe]),_:1})])):e.createCommentVNode("",!0)]),_:1}),e.createVNode(V,{label:"\u53D1\u884C\u91CF\uFF08\u5F20\uFF09"},{default:e.withCtx(()=>[e.createVNode(n,{"label-width":"0",prop:"num"},{default:e.withCtx(()=>[e.createVNode(r,{modelValue:o.value.num,"onUpdate:modelValue":t[12]||(t[12]=l=>o.value.num=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e.createVNode(V,{label:"\u9650\u9886\uFF08\u5F20\uFF09"},{default:e.withCtx(()=>[e.createVNode(n,{"label-width":"0",prop:"num"},{default:e.withCtx(()=>[e.createVNode(r,{modelValue:o.value.limit,"onUpdate:modelValue":t[13]||(t[13]=l=>o.value.limit=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e.createVNode(n,{label:"\u5546\u54C1\u9009\u62E9",prop:"productType"},{default:e.withCtx(()=>[e.createVNode(E,{modelValue:o.value.productType,"onUpdate:modelValue":t[14]||(t[14]=l=>o.value.productType=l),disabled:""},{default:e.withCtx(()=>[e.createVNode(f,{value:"SHOP_ALL"},{default:e.withCtx(()=>[e.createTextVNode("\u5168\u90E8\u5546\u54C1\u53C2\u4E0E")]),_:1}),e.createVNode(f,{value:"ASSIGNED"},{default:e.withCtx(()=>[e.createTextVNode("\u6307\u5B9A\u5546\u54C1\u53C2\u4E0E")]),_:1}),e.createVNode(f,{value:"ASSIGNED_NOT"},{default:e.withCtx(()=>[e.createTextVNode("\u6307\u5B9A\u5546\u54C1\u4E0D\u53C2\u4E0E")]),_:1})]),_:1},8,["modelValue"]),e.createElementVNode("div",{class:e.normalizeClass([u.value.length&&"goodsData","goods-list"])},[o.value.productType!=="SHOP_ALL"?(e.openBlock(),e.createBlock(B,{key:0,data:u.value,"header-cell-style":{fontSize:"14px",color:"#606266",background:"#f2f2f2",height:"54px",fontWeight:"normal"},height:"360px",style:{width:"100%"}},{default:e.withCtx(()=>[e.createVNode(V,{label:"\u5546\u54C1\u4FE1\u606F"},{default:e.withCtx(({row:l})=>[e.createElementVNode("div",le,[e.createVNode(se,{"preview-src-list":[l.pic],"preview-teleported":!0,src:l.pic,fit:"fit",style:{width:"60px",height:"60px"}},null,8,["preview-src-list","src"]),e.createElementVNode("div",ae,[e.createElementVNode("div",ne,e.toDisplayString(l.name),1),e.createElementVNode("div",de,e.toDisplayString(l.salePrice),1)])])]),_:1}),e.createVNode(V,{label:"\u64CD\u4F5C",width:"80px"})]),_:1},8,["data"])):e.createCommentVNode("",!0)],2)]),_:1})]),_:1},8,["model"])]),e.createElementVNode("div",re,[e.createVNode(pe,{plain:"",round:"",onClick:t[15]||(t[15]=l=>e.unref(i).back())},{default:e.withCtx(()=>[e.createTextVNode("\u8FD4\u56DE")]),_:1})])])}}}),_e="";return((a,c)=>{const i=a.__vccOpts||a;for(const[p,u]of c)i[p]=u;return i})(ue,[["__scopeId","data-v-acb4af53"]])});

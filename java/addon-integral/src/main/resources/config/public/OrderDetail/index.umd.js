(function(e,u){typeof exports=="object"&&typeof module<"u"?module.exports=u(require("vue"),require("@/views/order/orderDetails/components/remark-view.vue"),require("element-plus"),require("@/components/q-address/q-address.vue"),require("@/composables/useConvert"),require("vue-router"),require("@/apis/http"),require("@/apis/afs"),require("@/assets/json/data.json")):typeof define=="function"&&define.amd?define(["vue","@/views/order/orderDetails/components/remark-view.vue","element-plus","@/components/q-address/q-address.vue","@/composables/useConvert","vue-router","@/apis/http","@/apis/afs","@/assets/json/data.json"],u):(e=typeof globalThis<"u"?globalThis:e||self,e.OrderDetail=u(e.OrderDetailContext.Vue,e.OrderDetailContext.RemarkView,e.OrderDetailContext.ElementPlus,e.OrderDetailContext.QAddress,e.OrderDetailContext.UseConvert,e.OrderDetailContext.VueRouter,e.OrderDetailContext.Request,e.OrderDetailContext.ApisAfs,e.OrderDetailContext.handleGetCompanyName))})(this,function(e,u,h,b,w,V,v,S,B){"use strict";var k=document.createElement("style");k.textContent=`@charset "UTF-8";.orderInfo__title[data-v-fa7d6e5e]{padding:20px;font-size:18px;font-weight:700;color:#515151;width:223px;text-align:center}.orderInfo__steps[data-v-fa7d6e5e]{padding:20px;margin:20px;width:700px;border-left:1px solid #d5d5d5}.orderInfo__priceInfo[data-v-fa7d6e5e]{height:40px;color:#999;display:flex;justify-content:space-between;align-items:flex-end;flex-direction:column;margin:50px 0 20px}.orderInfo__shopName[data-v-fa7d6e5e]{font-size:14px;color:#333;font-weight:700;margin:22px 0 12px 5px}.orderInfo__footer[data-v-fa7d6e5e]{text-align:right}.orderInfo__footer span[data-v-fa7d6e5e]:nth-child(n+1){font-size:20px;font-weight:700;color:#ee420d}.orderInfo__userInfo[data-v-fa7d6e5e]{display:flex;background:#f7f8fa;margin-bottom:22px;padding:0 30px}.orderInfo__userInfo--left[data-v-fa7d6e5e]{flex:.5}.orderInfo__userInfo--left div[data-v-fa7d6e5e]:nth-of-type(n+2){margin-bottom:11px}.orderInfo__userInfo--right[data-v-fa7d6e5e]{flex:.5}.orderInfo__userInfo--right div[data-v-fa7d6e5e]:nth-of-type(n+2){margin-bottom:11px}.orderInfo__userInfo--title[data-v-fa7d6e5e]{font-size:14px;color:#333;font-weight:700;margin:17px 0}.orderInfo__tab--goods[data-v-fa7d6e5e]{display:flex;justify-content:space-between}.orderInfo__tab--goods-right[data-v-fa7d6e5e]{font-size:12px;color:#586884;width:132px;margin-left:10px;display:flex;justify-content:space-between;align-items:flex-start;flex-direction:column}.orderInfo__tab--goods-right-show[data-v-fa7d6e5e]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.orderInfo__tab--price[data-v-fa7d6e5e]{display:flex;justify-content:center;align-items:center;font-size:12px;color:#50596d;flex-direction:column}.el-table td[data-v-fa7d6e5e]{border-bottom:none}.tableStyle[data-v-fa7d6e5e]:before{width:0}.el-table[data-v-fa7d6e5e]{border-radius:9px;border:1px solid #d5d5d5}.el-table th.is-leaf[data-v-fa7d6e5e]{border-bottom:none}.logisticsInfo__overflow[data-v-59a5d72f]{height:calc(100vh - 400px);overflow-y:auto;padding:0 10px}.logisticsInfo__title[data-v-59a5d72f]{font-size:14px;color:#333;font-weight:700;margin:17px 0}.logisticsInfo__text[data-v-59a5d72f]{margin-bottom:11px}.logisticsInfo__timeline[data-v-59a5d72f]{margin-top:42px}.logisticsInfo__timeline li[data-v-59a5d72f]:nth-child(1) .el-timeline-item__timestamp{color:#000}.logisticsInfo__timeline--status[data-v-59a5d72f]{font-size:13px;font-weight:700;margin-right:10px;color:#838383}.logisticsInfo__timeline--time[data-v-59a5d72f]{color:#838383}.logisticsInfo__divider[data-v-59a5d72f]{height:4px;margin:0 -15px;background:#f2f2f2}
`,document.head.appendChild(k);const R=e.defineComponent({__name:"OrderDetail",setup(g){const f=[{label:"订单信息",name:"orderInfo"},{label:"物流信息",name:"logisticsInfo"}],s={orderInfo:e.defineAsyncComponent(()=>Promise.resolve().then(()=>ee)),logisticsInfo:e.defineAsyncComponent(()=>Promise.resolve().then(()=>de))},a=e.ref("orderInfo");return(i,l)=>{const t=e.resolveComponent("el-tab-pane"),y=e.resolveComponent("el-tabs");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(y,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=p=>a.value=p)},{default:e.withCtx(()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(f,p=>e.createVNode(t,{key:p.label,label:p.label,name:p.name},null,8,["label","name"])),64))]),_:1},8,["modelValue"]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(s[a.value])))])}}}),P="addon-integral/integral/"+"order/",C=g=>v.get({url:P+`get/${g}`}),A={UNPAID:"未支付",PAID:"待发货",ON_DELIVERY:"已发货",ACCOMPLISH:"已完成",SYSTEM_CLOSED:"已关闭"},q={class:"orderInfo"},$={style:{display:"flex","align-items":"center"}},L={class:"orderInfo__title"},j={class:"orderInfo__steps"},z={class:"orderInfo__userInfo"},U={class:"orderInfo__userInfo--left"},F={class:"orderInfo__userInfo--right"},M={class:"orderInfo__tab--goods"},G={class:"orderInfo__tab--goods-right"},W={class:"orderInfo__tab--goods-right-show"},H={class:"orderInfo__tab--price"},Y={key:0},J={class:"orderInfo__priceInfo"},K={key:0},Q={class:"orderInfo__footer"},X={key:0},Z=e.defineComponent({__name:"IntegralOrderDetail",setup(g){const{divTenThousand:f}=w(),s=e.ref(0),i=V.useRoute().query.no,l=e.ref({}),t=e.ref({sellerRemark:"",buyerRemark:"",payTime:"",deliveryTime:"",accomplishTime:"",buyerId:"",buyerNickname:"",createTime:"",freightPrice:0,image:"",integralOrderReceiver:{address:"",areaCode:[],createTime:"",id:"",mobile:"",name:"",orderNo:"",updateTime:""},no:"",num:1,price:"",productName:"",status:"PAID",salePrice:"",productType:"REAL_PRODUCT",affiliationPlatform:0});y();async function y(){if(i){const{code:c,msg:n,data:m}=await C(i);if(c!==200||!m){h.ElMessage.error(n||"订单详情获取失败");return}t.value=m,p()}}function p(){var c,n,m;(c=t.value)!=null&&c.accomplishTime?s.value=2:(n=t.value)!=null&&n.deliveryTime?s.value=1:(m=t.value)!=null&&m.payTime&&(s.value=0)}const N=e.computed(()=>t.value.price&&t.value.num?t.value.price:0),r=e.computed(()=>t.value.freightPrice?f(t.value.freightPrice):0),o=e.computed(()=>t.value.salePrice&&t.value.num?t.value.salePrice:0);return(c,n)=>{var D;const m=e.resolveComponent("el-step"),I=e.resolveComponent("el-steps"),x=e.resolveComponent("el-image"),_=e.resolveComponent("el-table-column"),ce=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",q,[e.createElementVNode("div",$,[e.createElementVNode("div",L,e.toDisplayString(e.unref(A)[(D=t.value)==null?void 0:D.status]),1),e.createElementVNode("div",j,[e.createVNode(I,{active:s.value,"align-center":"","process-status":"finish"},{default:e.withCtx(()=>[e.createVNode(m,{title:"买家已付款",description:t.value.payTime},null,8,["description"]),e.createVNode(m,{title:"商家发货",description:t.value.deliveryTime},null,8,["description"]),e.createVNode(m,{title:"成功订单",description:t.value.accomplishTime},null,8,["description"])]),_:1},8,["active"])])]),e.createElementVNode("div",z,[e.createElementVNode("div",U,[n[1]||(n[1]=e.createElementVNode("div",{class:"orderInfo__userInfo--title"},"物流信息",-1)),e.createElementVNode("div",null,"用户昵称："+e.toDisplayString(t.value.buyerNickname||"无"),1),e.createElementVNode("div",null,"买家姓名："+e.toDisplayString(t.value.integralOrderReceiver.name||"无"),1),e.createElementVNode("div",null,"买家手机号："+e.toDisplayString(t.value.integralOrderReceiver.mobile||"无"),1),e.createElementVNode("div",null,[n[0]||(n[0]=e.createTextVNode(" 收货地址：")),e.createVNode(b,{address:t.value.integralOrderReceiver.areaCode},null,8,["address"]),e.createTextVNode(e.toDisplayString(t.value.integralOrderReceiver.address),1)]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,(d,T,O)=>(e.openBlock(),e.createBlock(u,{key:O,class:"detail__item","remark-key":T,remark:l.value},null,8,["remark-key","remark"]))),128))]),e.createElementVNode("div",F,[n[2]||(n[2]=e.createElementVNode("div",{class:"orderInfo__userInfo--title"},"订单信息",-1)),e.createElementVNode("div",null,"订单编号："+e.toDisplayString(t.value.no),1),e.createElementVNode("div",null,"创建时间："+e.toDisplayString(t.value.createTime),1)])]),e.createVNode(ce,{"cell-style":({row:d,column:T,rowIndex:O,columnIndex:me})=>{if(me===0)return{borderBottom:"none"}},data:[t.value],style:{width:"100%"},calss:"orderInfo__tab",border:""},{default:e.withCtx(()=>[e.createVNode(_,{label:"商品",width:"230",align:"center"},{default:e.withCtx(({row:d})=>[e.createElementVNode("div",M,[e.createVNode(x,{fits:"cover",style:{width:"70px",height:"70px"},shape:"square",size:"large",src:d.image,title:d.productName},null,8,["src","title"]),e.createElementVNode("div",G,[e.createElementVNode("div",W,e.toDisplayString(d.productName),1)])])]),_:1}),e.createVNode(_,{label:"单价&数量",align:"center"},{default:e.withCtx(({row:d})=>[e.createElementVNode("div",H,[e.createElementVNode("div",null,"单价："+e.toDisplayString(d.price)+" 积分",1),e.createElementVNode("div",null,"数量： *"+e.toDisplayString(d.num),1)])]),_:1}),e.createVNode(_,{label:"总价",align:"center"},{default:e.withCtx(({row:d})=>[e.createElementVNode("div",null,[e.createTextVNode(" 总价： "+e.toDisplayString(d.price)+" 积分 ",1),d.salePrice!=="0"?(e.openBlock(),e.createElementBlock("span",Y," + ￥ "+e.toDisplayString(e.unref(f)(d.salePrice)),1)):e.createCommentVNode("",!0)])]),_:1})]),_:1},8,["cell-style","data"])]),e.createElementVNode("div",J,[e.createElementVNode("span",null," 运费:￥"+e.toDisplayString(r.value),1),e.createElementVNode("span",null,[e.createTextVNode("商品总价:"+e.toDisplayString(N.value)+" 积分 ",1),+o.value!=0?(e.openBlock(),e.createElementBlock("span",K," + ￥ "+e.toDisplayString(e.unref(f)(o.value)),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("div",Q,[n[3]||(n[3]=e.createTextVNode(" 实收款：")),e.createElementVNode("span",null,[e.createTextVNode(e.toDisplayString(N.value)+" 积分 ",1),+o.value!=0?(e.openBlock(),e.createElementBlock("span",X," + ￥ "+e.toDisplayString(+e.unref(f)(o.value)+ +r.value)+"元",1)):e.createCommentVNode("",!0)])])])}}}),pe="",E=(g,f)=>{const s=g.__vccOpts||g;for(const[a,i]of f)s[a]=i;return s},ee=Object.freeze(Object.defineProperty({__proto__:null,default:E(Z,[["__scopeId","data-v-fa7d6e5e"]])},Symbol.toStringTag,{value:"Module"})),te={class:"logisticsInfo"},oe={key:0},re={class:"logisticsInfo__text"},ne={class:"logisticsInfo__text"},ae={class:"logisticsInfo__text",style:{"margin-bottom":"20px"}},ie={key:1,class:"logisticsInfo__text"},le={class:"logisticsInfo__overflow"},se=e.defineComponent({__name:"integral-order-logistics",setup(g){const s=V.useRoute().query.no,a=e.ref(!1),i=e.ref({sellerRemark:"",buyerRemark:"",payTime:"",deliveryTime:"",accomplishTime:"",buyerId:"",buyerNickname:"",createTime:"",freightPrice:0,image:"",salePrice:"",integralOrderReceiver:{address:"",areaCode:[],createTime:"",id:"",mobile:"",name:"",orderNo:"",updateTime:""},no:"",num:1,price:"",productName:"",status:"PAID"}),l=e.ref([{context:"",status:"",time:""}]);y();function t(r){return r==="WITHOUT"}async function y(){if(s){const{code:r,data:o,msg:c}=await C(s);if(r!==200||!o){h.ElMessage.error(c||"订单详情获取失败");return}if(i.value=o,t(o.integralOrderDeliverType))return;p(o)}}const p=async r=>{if(r.integralOrderDeliverType==="WITHOUT"){l.value=[{context:"无需物流",time:r.createTime,status:"无需物流"}];return}try{if(r.expressCompanyName&&r.expressNo){const{data:o,code:c,msg:n}=await S.doGetLogisticsTrajectoryByWaybillNo(r.expressCompanyName,r.expressNo);if(c!==200)return h.ElMessage.error(n||"物流轨迹获取失败");if(!o.data){N(o,r);return}l.value=o.data}else throw new Error("包裹信息获取失败")}catch{a.value=!0,l.value=[{context:"包裹异常",time:r.integralOrderReceiver.updateTime,status:"包裹异常"}]}};function N(r,o){switch(r.returnCode){case"401":a.value=!0,l.value=[{status:"包裹异常",time:o.integralOrderReceiver.updateTime,context:r.message}];break;case"400":a.value=!0,l.value=[{status:"包裹异常",time:o.integralOrderReceiver.updateTime,context:r.message}];break;default:a.value=!0,l.value=[{status:"包裹异常",time:o.integralOrderReceiver.updateTime,context:r.message}];break}}return(r,o)=>{const c=e.resolveComponent("el-row"),n=e.resolveComponent("el-timeline-item"),m=e.resolveComponent("el-timeline"),I=e.resolveComponent("el-alert");return e.openBlock(),e.createElementBlock("div",te,[i.value.integralOrderDeliverType?(e.openBlock(),e.createElementBlock("div",oe,[o[1]||(o[1]=e.createElementVNode("div",{class:"logisticsInfo__title"},"物流信息",-1)),e.createElementVNode("div",re,[o[0]||(o[0]=e.createTextVNode(" 收货地址：")),e.createVNode(b,{address:i.value.integralOrderReceiver.areaCode},null,8,["address"]),e.createTextVNode(" "+e.toDisplayString(i.value.integralOrderReceiver.address),1)]),i.value.integralOrderDeliverType!=="WITHOUT"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("div",ne,"物流公司："+e.toDisplayString(e.unref(B)(i.value.expressCompanyName)),1),e.createElementVNode("div",ae,"物流单号："+e.toDisplayString(i.value.expressNo),1)],64)):(e.openBlock(),e.createElementBlock("div",ie,"物流公司：无需物流")),o[2]||(o[2]=e.createElementVNode("div",{class:"logisticsInfo__divider"},null,-1)),o[3]||(o[3]=e.createElementVNode("div",{class:"logisticsInfo__title"},"物流详情",-1)),e.createElementVNode("div",le,[e.createVNode(m,{class:"logisticsInfo__timeline"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value.reverse(),(x,_)=>(e.openBlock(),e.createBlock(n,{key:_,timestamp:`${x.context}`,style:{"padding-bottom":"42px"},color:_===0?a.value?"#F56C6C":"#409eff":" ",class:"logisticsInfo__timeline--item"},{default:e.withCtx(()=>[e.createVNode(c,null,{default:e.withCtx(()=>[e.createElementVNode("div",{style:e.normalizeStyle({color:_===0?a.value?"#F56C6C":"#409eff":" "}),class:"logisticsInfo__timeline--status"},e.toDisplayString(x.status),5),e.createElementVNode("div",{style:e.normalizeStyle({color:_===0?a.value?"#F56C6C":"#409eff":" "}),class:"logisticsInfo__timeline--time"},e.toDisplayString(x.time),5)]),_:2},1024)]),_:2},1032,["timestamp","color"]))),128))]),_:1})])])):(e.openBlock(),e.createBlock(I,{key:1,title:"暂无物流信息",type:"info",closable:!1}))])}}}),ge="",de=Object.freeze(Object.defineProperty({__proto__:null,default:E(se,[["__scopeId","data-v-59a5d72f"]])},Symbol.toStringTag,{value:"Module"}));return R});

(function(e,V){typeof exports=="object"&&typeof module<"u"?module.exports=V(require("vue"),require("@/components/ChromeTab.vue"),require("@vueuse/core"),require("@/components/SchemaForm.vue"),require("@/components/PageManage.vue"),require("@/store/modules/shopInfo"),require("element-plus"),require("vue-router"),require("@/utils/http"),require("decimal.js"),require("@/composables/useConvert")):typeof define=="function"&&define.amd?define(["vue","@/components/ChromeTab.vue","@vueuse/core","@/components/SchemaForm.vue","@/components/PageManage.vue","@/store/modules/shopInfo","element-plus","vue-router","@/utils/http","decimal.js","@/composables/useConvert"],V):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopGroup=V(e.ShopGroupContext.Vue,e.ShopGroupContext.ChromeTabs,e.ShopGroupContext.VueUse,e.ShopGroupContext.SchemaForms,e.ShopGroupContext.PageManageTwo,e.ShopGroupContext.ShopInfoStore,e.ShopGroupContext.ElementPlus,e.ShopGroupContext.VueRouter,e.ShopGroupContext.UtilsHttp,e.ShopGroupContext.Decimal,e.ShopGroupContext.UseConvert))})(this,function(e,V,M,D,F,P,C,O,k,pe,j){"use strict";var $=document.createElement("style");$.textContent=`@charset "UTF-8";*,:before,:after{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }::backdrop{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }.fixed,[fixed=\"\"]{position:fixed}.flex{display:flex}.col-last[data-v-505be4ec]{display:flex;justify-content:flex-end}.m-l-20[data-v-505be4ec]{margin-left:20px}.container[data-v-d8f1c1f6]{overflow-y:scroll}.reason[data-v-d8f1c1f6]{padding:10px 10px 20px}[data-v-d8f1c1f6] .el-button.is-link{padding:0}[data-v-d8f1c1f6] .el-button+.el-button{margin-left:10px}.group__head[data-v-6d1eaf1a]{display:flex;justify-content:flex-end;align-items:center}.group__head--center[data-v-6d1eaf1a]{margin:0 20px}.group__userInfo[data-v-6d1eaf1a]{display:flex;align-items:center}.group__userInfo--text[data-v-6d1eaf1a]{width:86px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-left:5px}.group__goodInfo[data-v-6d1eaf1a]{display:flex;align-items:center}.group__goodInfo--text[data-v-6d1eaf1a]{width:154px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden;margin-left:5px}.group__content[data-v-6d1eaf1a]{margin-top:10px}
`,document.head.appendChild($);const ue="",q={class:"q_plugin_container"},R={class:"fdc1 overh"},U=e.defineComponent({__name:"ShopGroup",setup(s){const x={GroupActivity:e.defineAsyncComponent(()=>Promise.resolve().then(()=>ne)),GroupOrder:e.defineAsyncComponent(()=>Promise.resolve().then(()=>de))},a=e.ref("GroupActivity"),i=[{name:"GroupActivity",label:"拼团活动"},{name:"GroupOrder",label:"拼团订单"}],m=_=>{_&&(a.value=_)};return(_,f)=>(e.openBlock(),e.createElementBlock("div",q,[e.createVNode(V,{"tab-list":i,value:a.value,onHandleTabs:m},null,8,["value"]),e.createElementVNode("div",R,[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(x[a.value])))])]))}}),v=e.defineComponent({__name:"head-search",props:{modelValue:{type:Object,default(){return{}}},batchDisabled:{type:Boolean,default:!0},leftBtnText:{type:String,default:"leftBtnText"}},emits:["update:modelValue","search"],setup(s,{emit:x}){const a=s,m=[{label:"活动名称",prop:"keyword",valueType:"copy",fieldProps:{placeholder:"请输入活动名称"}},{label:"活动状态",prop:"status",valueType:"select",options:[{value:"",label:"全部状态"},{value:"OPENING",label:"未开始"},{value:"OPEN",label:"进行中"},{value:"FINISHED",label:"已结束"},{value:"SHOP_OFF_SHELF",label:"已下架"},{value:"VIOLATION",label:"违规下架"}],fieldProps:{placeholder:"请选择"}}],_=x,f=M.useVModel(a,"modelValue",_),S=b=>{b&&Object.keys(b).forEach(c=>a.modelValue[c]=b[c])},w=()=>{Object.keys(a.modelValue).forEach(b=>a.modelValue[b]=""),_("search")};return(b,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(D,{"v-model":e.unref(f),columns:m,onSearchHandle:c[0]||(c[0]=T=>_("search")),onChangeFormItem:S,onHandleReset:w},null,8,["v-model"]),c[1]||(c[1]=e.createElementVNode("div",{class:"grey_bar"},null,-1))],64))}}),me="",G=(s,x)=>{const a=s.__vccOpts||s;for(const[i,m]of x)a[i]=m;return a},J=G(v,[["__scopeId","data-v-505be4ec"]]),K=s=>k.http.get({url:"addon-team/team/activity",params:s},{isMock:!1}),Q=s=>k.http.get({url:"addon-team/team/activity/order",params:s},{isMock:!1}),W=s=>k.http.post({url:"addon-team/team/activity/delete/batch",data:s}),X=s=>k.http.post({url:`addon-team/team/activity/shop/shelf/${s}`}),Y=s=>k.http.get({url:`addon-team/team/activity/illegal/${s}/reason`}),Z={class:"handle_container",style:{"padding-top":"16px"}},ee={class:"table_container"},te={class:"reason"},oe=e.defineComponent({__name:"group-activity",setup(s){const x=O.useRouter(),a=O.useRoute(),i=e.ref([]),m=e.ref({keyword:"",status:"",date:""}),_=e.ref(),f=e.reactive({size:10,current:1,total:0}),S={OPENING:"未开始",PREHEAT:"预售中",OPEN:"进行中",FINISHED:"已结束",SHOP_OFF_SHELF:"已下架",VIOLATION:"违规下架"},w={COMMON:"普通拼团",STAIRS:"阶梯拼团"};e.onBeforeMount(()=>{c()}),e.watch(()=>a.query.flag,()=>{c()});const b=(n,t)=>{x.push({name:"marketingAppGroupForm",query:{id:n,isLookUp:t}})};async function c(){const n={...f,...m.value,shopId:P.useShopInfoStore().shopInfo.id},{code:t,data:d}=await K(n);if(t!==200)return C.ElMessage.error("获取活动列表失败");i.value=d.records,f.total=d.total}const T=n=>{f.current=n,c()},A=n=>{f.size=n,c()},I=async(n,t)=>{const d=t??"确定删除该活动?";try{if(!await C.ElMessageBox.confirm(d,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}))return;const u=Array.isArray(n)?n.map(o=>({...o,activityId:o.id})):[{...n,activityId:n.id}];u.forEach(o=>{o.activityId=o.id});const{code:z,data:H}=await W(u);if(z!==200){C.ElMessage.error("删除失败");return}C.ElMessage.success("删除成功"),c()}catch{}},g=e.ref([]),r=async()=>{const t=g.value.filter(u=>u.status!=="OPEN").length,d=g.value.length,p=t===d?"确定批量删除活动?":`确定批量删除活动? 其中有${d-t}条数据为进行中,无法进行删除 已自动剔除！`;I(g.value,p)},y=n=>{g.value=n},N=async n=>{try{if(!await C.ElMessageBox.confirm("确定下架商品吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}))return;const{msg:d,code:p}=await X(n);if(p!==200)return C.ElMessage.error(d??"下架失败");c()}catch(t){console.log("error",t)}},h=e.ref(!1),E=e.ref("违规原因"),L=async n=>{try{const{msg:t,data:d,code:p}=await Y(n);if(p!==200||!d)return C.ElMessage.error(t??"获取下架原因失败！");E.value=d,h.value=!0}catch(t){console.log("error",t)}},l=()=>{E.value="",h.value=!1};return(n,t)=>{const d=e.resolveComponent("el-config-provider"),p=e.resolveComponent("el-button"),u=e.resolveComponent("el-table-column"),z=e.resolveComponent("el-table"),H=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(d,{"value-on-clear":"","empty-values":[void 0,null]},{default:e.withCtx(()=>[e.createVNode(J,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=o=>m.value=o),onSearch:c},null,8,["modelValue"])]),_:1}),e.createElementVNode("div",Z,[e.createVNode(p,{round:"",type:"primary",onClick:t[1]||(t[1]=o=>e.unref(x).push({name:"marketingAppGroupNewForm"}))},{default:e.withCtx(()=>t[3]||(t[3]=[e.createTextVNode("新增拼团")])),_:1}),e.createVNode(p,{disabled:!g.value.length,round:"",onClick:r},{default:e.withCtx(()=>t[4]||(t[4]=[e.createTextVNode(" 批量删除 ")])),_:1},8,["disabled"])]),e.createElementVNode("div",ee,[e.createVNode(z,{ref_key:"multipleTableRef",ref:_,data:i.value,"header-cell-style":{background:"#f6f8fa",height:"48px"},"header-row-style":{color:"#333"},onSelectionChange:y},{default:e.withCtx(()=>[e.createVNode(u,{type:"selection",width:"30",fixed:"",selectable:o=>o.status!=="OPEN"},null,8,["selectable"]),e.createVNode(u,{label:"活动名称",width:"220"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(o.name),1)]),_:1}),e.createVNode(u,{label:"拼团模式",width:"140"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(w[o.mode]),1)]),_:1}),e.createVNode(u,{label:"状态",width:"140"},{default:e.withCtx(({row:o})=>[e.createElementVNode("span",{style:e.normalizeStyle(`color: ${o.status==="VIOLATION"?"#f12f22":"inherit"}`)},e.toDisplayString(S[o.status]),5)]),_:1}),e.createVNode(u,{label:"活动时间",width:"240"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",null,"起："+e.toDisplayString(o.startTime),1),e.createElementVNode("div",null,"止："+e.toDisplayString(o.endTime),1)]),_:1}),e.createVNode(u,{label:"活动商品",width:"120"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(o.productNum||0),1)]),_:1}),e.createVNode(u,{label:"支付单数",width:"120"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(o.orders||0),1)]),_:1}),e.createVNode(u,{label:"操作",fixed:"right",align:"right"},{default:e.withCtx(({row:o})=>[e.createVNode(p,{type:"primary",link:"",onClick:B=>b(o.id,"true")},{default:e.withCtx(()=>t[5]||(t[5]=[e.createTextVNode("查看")])),_:2},1032,["onClick"]),o.status==="OPEN"?(e.openBlock(),e.createBlock(p,{key:0,type:"primary",link:"",onClick:B=>N(o.id)},{default:e.withCtx(()=>t[6]||(t[6]=[e.createTextVNode("下架")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0),o.status==="VIOLATION"?(e.openBlock(),e.createBlock(p,{key:1,type:"primary",link:"",onClick:B=>L(o.id)},{default:e.withCtx(()=>t[7]||(t[7]=[e.createTextVNode("违规原因")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0),o.status!=="OPEN"?(e.openBlock(),e.createBlock(p,{key:2,type:"danger",link:"",onClick:B=>I(o)},{default:e.withCtx(()=>t[8]||(t[8]=[e.createTextVNode("删除")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0)]),_:1})]),_:1},8,["data"])]),e.createVNode(F,{"page-size":f.size,"page-num":f.current,total:f.total,onHandleCurrentChange:T,onHandleSizeChange:A},null,8,["page-size","page-num","total"]),e.createVNode(H,{modelValue:h.value,"onUpdate:modelValue":t[2]||(t[2]=o=>h.value=o),title:"违规原因",width:"600px",center:"",onClose:l},{default:e.withCtx(()=>[e.createElementVNode("div",te,e.toDisplayString(E.value),1)]),_:1},8,["modelValue"])],64)}}}),fe="",ne=Object.freeze(Object.defineProperty({__proto__:null,default:G(oe,[["__scopeId","data-v-d8f1c1f6"]])},Symbol.toStringTag,{value:"Module"})),ae={class:"table_container",style:{"padding-top":"26px"}},re={class:"group__userInfo"},le={class:"group__userInfo--text"},se={class:"group__goodInfo"},ce={class:"group__goodInfo--text"},ie=e.defineComponent({__name:"group-order",setup(s){const x=O.useRouter(),a=e.reactive({status:"SUCCESS",commander:"",productName:""}),i=e.reactive({current:1,size:10,total:0}),m=e.ref([]),{divTenThousand:_}=j(),f=[{label:"拼团状态",prop:"status",valueType:"select",options:[{label:"拼团成功",value:"SUCCESS"},{label:"拼团失败",value:"FAIL"},{label:"拼团中",value:"ING"}],fieldProps:{placeholder:"请选择"}},{label:"发起人",prop:"commander",valueType:"copy",fieldProps:{placeholder:"请输入发起人姓名"}},{label:"商品名称",prop:"productName",valueType:"copy",fieldProps:{placeholder:"请输入商品名称"}}];g();const S=r=>({SUCCESS:"拼团成功",FAIL:"拼团失败",ING:"拼团中"})[r],w=r=>{x.push({name:"marketingAppGroupOrderDetail",query:{teamNo:r}})},b=r=>{i.size=r,g()},c=r=>{i.current=r,g()},T=()=>{g()},A=r=>{r&&Object.keys(r).forEach(y=>a[y]=r[y])},I=()=>{Object.keys(a).forEach(r=>a[r]=""),g()};async function g(){const r={...i,...a},{data:y,code:N}=await Q(r);if(N!==200)return C.ElMessage.error("获取拼团订单失败");m.value=y.records,i.total=y.total}return(r,y)=>{const N=e.resolveComponent("el-image"),h=e.resolveComponent("el-table-column"),E=e.resolveComponent("el-button"),L=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(D,{"v-model":a,columns:f,showNumber:3,onSearchHandle:T,onChangeFormItem:A,onHandleReset:I},null,8,["v-model"]),e.createElementVNode("div",ae,[e.createVNode(L,{data:m.value,"header-cell-style":{height:"48px",background:"#F7F8FA"},"header-row-style":{color:"#333"}},{default:e.withCtx(()=>[e.createVNode(h,{label:"发起人",width:"180"},{default:e.withCtx(({row:l})=>[e.createElementVNode("div",re,[e.createVNode(N,{src:l.commanderAvatar,style:{width:"30px",height:"30px"}},null,8,["src"]),e.createElementVNode("div",le,e.toDisplayString(l.commanderNickname),1)])]),_:1}),e.createVNode(h,{label:"商品信息",width:"210"},{default:e.withCtx(({row:l})=>[e.createElementVNode("div",se,[e.createVNode(N,{src:l.productImage,style:{width:"36px",height:"36px"}},null,8,["src"]),e.createElementVNode("div",ce,e.toDisplayString(l.productName),1)])]),_:1}),e.createVNode(h,{label:"开团时间",prop:"openTime"}),e.createVNode(h,{label:"参团人数",width:"100"},{default:e.withCtx(({row:l})=>[e.createElementVNode("div",null,e.toDisplayString(l.currentNum)+"/"+e.toDisplayString(l.totalNum),1)]),_:1}),e.createVNode(h,{label:"订单总金额(元)",width:"160"},{default:e.withCtx(({row:l})=>[e.createElementVNode("div",null,e.toDisplayString(e.unref(_)(l.amount).toFixed(2)),1)]),_:1}),e.createVNode(h,{label:"状态",width:"90"},{default:e.withCtx(({row:l})=>[e.createElementVNode("div",{style:e.normalizeStyle({color:l.status==="SUCCESS"?"#00BB2C":l.status==="FAIL"?"#999999":""})},e.toDisplayString(S(l.status)),5)]),_:1}),e.createVNode(h,{label:"操作",align:"right",width:"100",fixed:"right"},{default:e.withCtx(({row:l})=>[e.createVNode(E,{link:"",type:"primary",onClick:n=>w(l.teamNo)},{default:e.withCtx(()=>y[0]||(y[0]=[e.createTextVNode("拼团详情")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e.createVNode(F,{"page-size":i.size,"page-num":i.current,total:i.total,onHandleSizeChange:b,onHandleCurrentChange:c},null,8,["page-size","page-num","total"])],64)}}}),_e="",de=Object.freeze(Object.defineProperty({__proto__:null,default:G(ie,[["__scopeId","data-v-6d1eaf1a"]])},Symbol.toStringTag,{value:"Module"}));return U});

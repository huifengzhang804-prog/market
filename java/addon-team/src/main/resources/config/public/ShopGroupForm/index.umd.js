(function(e,D){typeof exports=="object"&&typeof module<"u"?module.exports=D(require("vue"),require("@/components/q-choose-goods-popup/q-choose-goods-popup.vue"),require("element-plus"),require("@/composables/useConvert"),require("@/utils/date"),require("@/utils/http"),require("decimal.js"),require("@/apis/good"),require("vue-router"),require("lodash-es")):typeof define=="function"&&define.amd?define(["vue","@/components/q-choose-goods-popup/q-choose-goods-popup.vue","element-plus","@/composables/useConvert","@/utils/date","@/utils/http","decimal.js","@/apis/good","vue-router","lodash-es"],D):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopGroupForm=D(e.ShopGroupFormContext.Vue,e.ShopGroupFormContext.QChooseGoodsPopup,e.ShopGroupFormContext.ElementPlus,e.ShopGroupFormContext.UseConvert,e.ShopGroupFormContext.DateUtil,e.ShopGroupFormContext.UtilsHttp,e.ShopGroupFormContext.Decimal,e.ShopGroupFormContext.GoodAPI,e.ShopGroupFormContext.VueRouter,e.ShopGroupFormContext.Lodash))})(this,function(e,D,N,Z,v,K,ge,ee,Q,te){"use strict";var W=document.createElement("style");W.textContent=`@charset "UTF-8";.com[data-v-7f72b499]{display:flex;justify-content:center;align-items:center}.com__pic[data-v-7f72b499]{width:62px;height:62px}.com__name[data-v-7f72b499]{width:113px;font-size:14px;color:#333;margin-left:10px;display:flex;flex-direction:column;align-items:baseline}.com__name--text[data-v-7f72b499]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.flex[data-v-7f72b499]{display:flex;justify-content:space-between;align-items:center}.groupForm[data-v-16539054]{overflow-y:auto;padding:16px}.groupForm__title[data-v-16539054]{font-size:14px;color:#606266;font-weight:700;margin-bottom:30px}.groupForm__stairs[data-v-16539054]{margin-bottom:16px}.groupForm__stairs--title[data-v-16539054]{font-size:12px;color:#333;font-weight:700}.groupForm__stairs--input[data-v-16539054]{margin:0 7px}.groupForm__btn[data-v-16539054]{height:60px;display:flex;justify-content:center;align-items:center}.tips[data-v-16539054]{font-size:12px;color:#c4c4c4}.btns[data-v-16539054]{margin-top:auto;width:100%;padding:15px 0;box-shadow:0 0 10px #d5d5d5;background-color:#fff}
`,document.head.appendChild(W);const oe={class:"com"},le={class:"com__name"},re={class:"com__name--text",style:{"margin-top":"5px"}},se={class:"flex"},ae={key:0},ne={class:"dialog-footer"},de=e.defineComponent({__name:"select-good-table",props:{mode:{type:String,default:"COMMON"},users:{type:Array,default(){return[]}},productList:{type:Array,default(){return[]}},isEdit:{type:Boolean,default:!1},flatGoodList:{type:Array,default(){return[]}}},setup(C,{expose:r}){const n=C,{divTenThousand:y,mulTenThousand:b}=Z(),V=e.ref([]);e.watch(()=>n.productList,l=>{const s=G(l);if((s==null?void 0:s.length)===0)return N.ElMessage.error("请至少选择一个存在库存的商品");V.value=B(s)},{deep:!0}),e.watch(()=>n.flatGoodList,l=>{V.value=B(l)});function T(l){return l.skuItem.stockType==="LIMITED"?Number(l.skuItem.skuStock):1e5}function g(l){return y(l.skuItem.skuPrice).toNumber()}function G(l,s){if(!l.length)return[];const u=[];return l.forEach(d=>{d.skuIds.forEach((m,a)=>{(d.stocks[a]>0&&d.stockTypes[a]==="LIMITED"||d.stockTypes[a]==="UNLIMITED")&&u.push({productId:d.productId,productName:d.productName,productPic:d.pic,skuItem:{productId:d.productId,skuId:m,skuName:d.specs[a]?d.specs[a]:"",skuPrice:d.salePrices[a],skuStock:d.stocks[a]?d.stocks[a]:"",stockType:d.stockTypes[a]},rowTag:0,stock:+d.stocks[a],prices:[d.salePrices[a]],isJoin:d.stocks[a]>0})})}),u}function B(l,s){let u=0,d=l.length;for(let m=0;m<d;m++){const a=l[m];m===0&&(a.rowTag=1,u=0),m!==0&&(a.productId===l[m-1].productId?(a.rowTag=0,l[u].rowTag=l[u].rowTag+1):(a.rowTag=1,u=m)),a.prices=a.prices.map(h=>+h),a.stock=+a.stock}return l}const $=({row:l,column:s,rowIndex:u,columnIndex:d})=>{if(d===0)return{rowspan:l.rowTag,colspan:l.rowTag?1:0}};function q(l){return l.stockType==="UNLIMITED"?"无限库存":`${"库存"+l.skuStock||0}`}function M(){const l=e.toRaw(V.value),s=[],u=new Map;if(l.length)for(let d=0;d<l.length;d++){if(!l[d].isJoin)continue;const m=l[d],a=m.productId,h={skuId:m.skuItem.skuId,stock:+m.stock,prices:m.prices.map(E=>b(E).toNumber())};if(!u.has(a))u.set(a,s.length),s.push({productId:a,skus:[h]});else{const E=u.get(a);s[E].skus.push(h)}}return s}function R(){let l=!0;const s=V.value;if(!s.length)N.ElMessage.warning("请选择商品"),l=!1;else for(let u=0;u<s.length;u++)if(s[u].isJoin){if(!s[u].stock){N.ElMessage.warning("商品库存必须大于零"),l=!1;break}if(s[u].prices.length!==n.users.length||s[u].prices.some(d=>d===null)){N.ElMessage.warning("拼团价格填写完整"),l=!1;break}}return l}const k=e.ref({stock:1,price:[.01]}),w=e.ref(!1),O=e.ref("0"),j=l=>{O.value=l.productId,k.value.stock=l.skuItem.skuStock,w.value=!0},z=()=>{k.value={stock:1,price:[.01]},w.value=!1},A=()=>{n.mode==="COMMON"?V.value.forEach(l=>{l.productId===O.value&&(l.stock=k.value.stock>T(l)?T(l):k.value.stock,l.prices[0]=k.value.price[0]>g(l)?g(l):k.value.price[0])}):V.value.forEach(l=>{if(l.productId===O.value){l.stock=k.value.stock>T(l)?T(l):k.value.stock;for(let s=0;s<n.users.length;s++)n.users.length[s],l.prices[s]=k.value.price[s]>g(l)?g(l):k.value.price[s]}}),w.value=!1},J=(l,s)=>typeof l=="string"?l:l.length===1?l[0]:l[s];return r({getProduct:M,validateProduct:R}),(l,s)=>{const u=e.resolveComponent("el-image"),d=e.resolveComponent("el-button"),m=e.resolveComponent("el-table-column"),a=e.resolveComponent("el-input-number"),h=e.resolveComponent("el-input"),E=e.resolveComponent("el-switch"),Y=e.resolveComponent("el-table"),H=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(Y,{data:V.value,"span-method":$},{default:e.withCtx(()=>[e.createVNode(m,{label:"商品信息",width:"215"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",oe,[e.createVNode(u,{src:o.productPic,class:"com__pic"},null,8,["src"]),e.createElementVNode("div",le,[n.isEdit?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(d,{key:0,class:"com__batch",type:"primary",link:"",onClick:t=>j(o)},{default:e.withCtx(()=>s[4]||(s[4]=[e.createTextVNode(" 批量设置 ")])),_:2},1032,["onClick"])),e.createElementVNode("span",re,e.toDisplayString(o.productName),1)])])]),_:1}),e.createVNode(m,{label:"规格"},{default:e.withCtx(({row:o,column:t,$index:c})=>[e.createTextVNode(e.toDisplayString(J(o.skuItem.skuName,c)),1)]),_:1}),e.createVNode(m,{label:"库存"},{default:e.withCtx(({row:o,column:t,$index:c})=>[e.createElementVNode("div",null,[e.createVNode(a,{modelValue:o.stock,"onUpdate:modelValue":p=>o.stock=p,min:0,style:{width:"80px"},max:T(o),disabled:n.isEdit,precision:0,controls:!1},null,8,["modelValue","onUpdate:modelValue","max","disabled"])]),e.createElementVNode("div",null,e.toDisplayString(q(o.skuItem)),1)]),_:1}),n.mode==="COMMON"?(e.openBlock(),e.createBlock(m,{key:0,label:"拼团价"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",null,[n.isEdit?(e.openBlock(),e.createBlock(h,{key:0,style:{width:"80px"},disabled:"",placeholder:e.unref(y)(o.prices[0]).toString()},null,8,["placeholder"])):(e.openBlock(),e.createBlock(a,{key:1,modelValue:o.prices[0],"onUpdate:modelValue":t=>o.prices[0]=t,min:.01,style:{width:"80px"},disabled:n.isEdit,precision:2,max:g(o),controls:!1},null,8,["modelValue","onUpdate:modelValue","disabled","max"]))]),e.createElementVNode("div",null,"销售价"+e.toDisplayString(e.unref(y)(o.skuItem.skuPrice)),1)]),_:1})):e.createCommentVNode("",!0),n.mode==="STAIRS"&&n.users.length>0?(e.openBlock(),e.createBlock(m,{key:1,label:"第一阶段拼团"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",null,[n.isEdit?(e.openBlock(),e.createBlock(h,{key:0,style:{width:"80px"},disabled:"",placeholder:e.unref(y)(o.prices[0]).toString()},null,8,["placeholder"])):(e.openBlock(),e.createBlock(a,{key:1,modelValue:o.prices[0],"onUpdate:modelValue":t=>o.prices[0]=t,min:.01,style:{width:"80px"},disabled:n.isEdit,precision:2,max:g(o),controls:!1},null,8,["modelValue","onUpdate:modelValue","disabled","max"]))]),e.createElementVNode("div",null,"销售价"+e.toDisplayString(e.unref(y)(o.skuItem.skuPrice)),1)]),_:1})):e.createCommentVNode("",!0),n.mode==="STAIRS"&&n.users.length>1?(e.openBlock(),e.createBlock(m,{key:2,label:"第二阶段拼团"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",null,[n.isEdit?(e.openBlock(),e.createBlock(h,{key:0,style:{width:"80px"},disabled:"",placeholder:e.unref(y)(o.prices[1]).toString()},null,8,["placeholder"])):(e.openBlock(),e.createBlock(a,{key:1,modelValue:o.prices[1],"onUpdate:modelValue":t=>o.prices[1]=t,disabled:n.isEdit,min:.01,style:{width:"80px"},max:g(o),precision:2,controls:!1},null,8,["modelValue","onUpdate:modelValue","disabled","max"]))]),e.createElementVNode("div",null,"销售价"+e.toDisplayString(g(o)),1)]),_:1})):e.createCommentVNode("",!0),n.mode==="STAIRS"&&n.users.length>2?(e.openBlock(),e.createBlock(m,{key:3,label:"第三阶段拼团"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",null,[n.isEdit?(e.openBlock(),e.createBlock(h,{key:0,style:{width:"80px"},disabled:"",placeholder:e.unref(y)(o.prices[2]).toString()},null,8,["placeholder"])):(e.openBlock(),e.createBlock(a,{key:1,modelValue:o.prices[2],"onUpdate:modelValue":t=>o.prices[2]=t,disabled:n.isEdit,min:.01,style:{width:"80px"},precision:2,max:g(o),controls:!1},null,8,["modelValue","onUpdate:modelValue","disabled","max"]))]),e.createElementVNode("div",null,"销售价"+e.toDisplayString(g(o)),1)]),_:1})):e.createCommentVNode("",!0),e.createVNode(m,{label:"是否参与"},{default:e.withCtx(({row:o})=>[e.createVNode(E,{modelValue:o.isJoin,"onUpdate:modelValue":t=>o.isJoin=t,size:"large",disabled:n.isEdit},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1})]),_:1},8,["data"]),e.createVNode(H,{modelValue:w.value,"onUpdate:modelValue":s[3]||(s[3]=o=>w.value=o),title:"批量设置","destroy-on-close":"",center:"",width:n.mode==="COMMON"?500:"50%",top:"30vh",onClose:z},{footer:e.withCtx(()=>[e.createElementVNode("div",ne,[e.createVNode(d,{onClick:s[2]||(s[2]=o=>w.value=!1)},{default:e.withCtx(()=>s[7]||(s[7]=[e.createTextVNode("取消")])),_:1}),e.createVNode(d,{type:"primary",onClick:A},{default:e.withCtx(()=>s[8]||(s[8]=[e.createTextVNode(" 确定 ")])),_:1})])]),default:e.withCtx(()=>[e.createElementVNode("div",se,[e.createElementVNode("div",null,[s[5]||(s[5]=e.createTextVNode(" 库存 ")),e.createVNode(a,{modelValue:k.value.stock,"onUpdate:modelValue":s[0]||(s[0]=o=>k.value.stock=o),controls:!1,style:e.normalizeStyle({width:n.mode==="COMMON"?"150px":"80px"}),min:0,precision:0},null,8,["modelValue","style"])]),n.mode==="COMMON"?(e.openBlock(),e.createElementBlock("div",ae,[s[6]||(s[6]=e.createTextVNode(" 拼团价 ")),e.createVNode(a,{modelValue:k.value.price[0],"onUpdate:modelValue":s[1]||(s[1]=o=>k.value.price[0]=o),precision:2,controls:!1,min:.01},null,8,["modelValue"])])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(n.users,(o,t)=>(e.openBlock(),e.createElementBlock("div",{key:t},[e.createTextVNode(" 第"+e.toDisplayString(t+1)+"阶段拼团 ",1),e.createVNode(a,{modelValue:k.value.price[t],"onUpdate:modelValue":c=>k.value.price[t]=c,style:{width:"80px"},precision:2,controls:!1,min:.01},null,8,["modelValue","onUpdate:modelValue"])]))),128))])]),_:1},8,["modelValue","width"])],64)}}}),xe="",X=(C,r)=>{const n=C.__vccOpts||C;for(const[y,b]of r)n[y]=b;return n},ie=X(de,[["__scopeId","data-v-7f72b499"]]),ce=C=>K.http.post({url:"addon-team/team/activity",data:C}),pe=C=>K.http.get({url:`addon-team/team/activity/${C}`}),me={class:"groupForm"},ue={key:1},fe={class:"groupForm__stairs--title"},ke={class:"groupForm__btn btns"},Ve=e.defineComponent({__name:"ShopGroupForm",setup(C){const r=e.ref({name:"",startTime:"",endTime:"",effectTimeout:0,mode:"COMMON",users:[],payTimeout:0,simulate:!1,huddle:!0,stackable:{vip:!1,coupon:!1,full:!1},products:[]}),n=Q.useRoute(),y=Q.useRouter(),b=!!n.query.id&&!!n.query.isLookUp,V=new v,T=e.ref(),g=e.ref([]),G=e.ref(!1),B=e.ref([]),$=e.ref([]),q=e.ref(),M=e.reactive({maxPrice:"",minPrice:"",activity:{endTime:"",startTime:""},keyword:"",categoryFirstId:""}),R=e.reactive({name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:1,max:10,message:"活动名称字数为1-10",trigger:"blur"}],startTime:[{required:!0,message:"请选择日期"},{trigger:"blur",validator:a}],endTime:[{required:!0,message:"请选择日期"},{trigger:"blur",validator:a}],effectTimeout:[{validator:u,trigger:"blur"}],mode:[{required:!0,message:"请选择拼团模式",trigger:"blur"}],users:[{validator:s,trigger:"blur"}],payTimeout:[{validator:d,trigger:"blur"}],simulate:[{required:!0,message:"请选择是否模拟成团",trigger:"blur"}],huddle:[{required:!0,message:"请选择是否凑团",trigger:"blur"}],preheat:[{required:!0,message:"请选择是否预热",trigger:"blur"}]});h();const k=()=>{r.value.users.length<3?r.value.users.push(0):N.ElMessage.warning("最多添加三个梯队")},w=()=>{r.value.users.pop()},O=o=>{B.value=te.cloneDeep(o.tempGoods)},j=()=>{var o;(o=T.value)==null||o.validate(async t=>{if(t&&q.value.validateProduct()){r.value.products=q.value.getProduct();const{code:c,msg:p}=await ce(r.value);c===200?(N.ElMessage.success("创建成功"),A()):N.ElMessage.error(p||"创建失败")}})},z=o=>{o[0].getTime()>=o[1].getTime()&&N.ElMessage.warning("结束时间大于开始时间"),r.value.startTime=V.getYMDHMSs(o[0]),r.value.endTime=V.getYMDHMSs(o[1]),M.activity.startTime=V.getYMDHMSs(o[0]),M.activity.endTime=V.getYMDHMSs(o[1])},A=()=>{y.push({name:"marketingAppGroup",query:{flag:!0}})},J=o=>{o==="COMMON"&&(r.value.users=[r.value.users[0]])},l=()=>{if(!r.value.endTime||!r.value.startTime){N.ElMessage.warning("请先选择时间段");return}G.value=!0};function s(o,t,c){r.value.mode==="COMMON"&&(r.value.users.length&&r.value.users[0]>=2?c():c(new Error("参团人数应大于等于两人"))),r.value.mode==="STAIRS"&&(r.value.users.length?(r.value.users.find(F=>F<2)&&c(new Error("阶梯团人数最低为2人")),m(r.value.users)||c(new Error("阶梯团人数应为递增人数")),c()):c(new Error("请至少添加一项阶梯团人数")))}function u(o,t,c){t>=15?c():c(new Error("拼团有效时间必须大于等于15分钟"))}function d(o,t,c){t>=3&&t<=369?c():c(new Error("订单关闭时间3-360分钟"))}function m(o){for(let t=1;t<o.length;t++)if(o[t]<=o[t-1])return!1;return!0}function a(o,t,c){new Date(r.value.startTime).getTime()>=new Date(r.value.endTime).getTime()?c(new Error("开始时间应小于结束时间")):c()}async function h(){const o=n.query.id;if(o){const{data:t}=await pe(o);r.value=t,r.value.payTimeout=+t.payTimeout,g.value=[t.startTime,t.endTime],E(t)}}async function E(o){const t=o.products.map(f=>f.productId),{code:c,data:p}=await ee.doGetRetrieveProduct({productId:t});if(c!==200)return N.ElMessage.error("获取活动商品信息失败");const F=[];if(p.list.length)for(let f=0;f<o.products.length;f++){const I=p.list.findIndex(x=>x.productId===o.products[f].productId);for(let x=0;x<o.products[I].skus.length;x++){let _={productName:p.list[f].productName,productPic:p.list[f].pic,productId:p.list[f].productId,skuItem:{productId:p.list[f].productId,skuId:"",skuName:"",skuPrice:"",skuStock:0,stockType:"LIMITED"},rowTag:0,stock:0,prices:[],isJoin:!0};const P=o.products[I].skus[x].skuId,S=p.list[f].skuIds.findIndex(i=>i===P);_.skuItem.skuId=p.list[f].skuIds[S],_.skuItem.skuName=p.list[f].specs[S],_.skuItem.skuPrice=p.list[f].salePrices[S],_.skuItem.skuStock=p.list[f].stocks[S],_.skuItem.stockType=p.list[f].stockTypes[S],_.stock=o.products[I].skus[x].stock,_.prices=o.products[I].skus[x].prices,F.push(_)}}$.value=F}function Y(o){const t=V.getYMD(new Date),c=V.getYMD(o);return t===c?!1:new Date().getTime()>o.getTime()}const H=o=>{const t=Number(`${o}`.replace(/[^\d]/g,""));return t<1440?t:1440};return(o,t)=>{const c=e.resolveComponent("el-input"),p=e.resolveComponent("el-form-item"),F=e.resolveComponent("el-date-picker"),f=e.resolveComponent("el-radio"),I=e.resolveComponent("el-radio-group"),x=e.resolveComponent("el-button"),_=e.resolveComponent("el-input-number"),P=e.resolveComponent("el-checkbox"),S=e.resolveComponent("el-form");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",me,[t[26]||(t[26]=e.createElementVNode("div",{class:"groupForm__title"},"基本信息",-1)),e.createVNode(S,{ref_key:"ruleFormRef",ref:T,model:r.value,"label-width":"110","label-position":"right",rules:R,disabled:e.unref(b)},{default:e.withCtx(()=>[e.createVNode(p,{label:"活动名称",prop:"name"},{default:e.withCtx(()=>[e.createVNode(c,{modelValue:r.value.name,"onUpdate:modelValue":t[0]||(t[0]=i=>r.value.name=i),placeholder:"限10字",style:{width:"550px"},maxlength:"10"},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"活动时间",prop:"startTime"},{default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(F,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=i=>g.value=i),style:{width:"550px"},type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间","disabled-date":Y,onChange:z},null,8,["modelValue"])])]),_:1}),e.createVNode(p,{label:"拼团有效期",prop:"effectTimeout",required:""},{default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(c,{modelValue:r.value.effectTimeout,"onUpdate:modelValue":t[2]||(t[2]=i=>r.value.effectTimeout=i),formatter:i=>H(i),style:{width:"550px"}},{append:e.withCtx(()=>t[12]||(t[12]=[e.createTextVNode(" 分钟 ")])),_:1},8,["modelValue","formatter"]),t[13]||(t[13]=e.createElementVNode("p",{class:"tips"},"用户发起拼团后开始计时，需在设置时间内邀请到规定好友人数参团，超过时效时间，则系统判定拼团失败，自动发起退款",-1))])]),_:1}),e.createVNode(p,{label:"拼团模式",prop:"mode"},{default:e.withCtx(()=>[e.createVNode(I,{modelValue:r.value.mode,"onUpdate:modelValue":t[3]||(t[3]=i=>r.value.mode=i),onChange:J},{default:e.withCtx(()=>[e.createVNode(f,{value:"COMMON"},{default:e.withCtx(()=>t[14]||(t[14]=[e.createTextVNode("普通拼团")])),_:1}),e.createVNode(f,{value:"STAIRS"},{default:e.withCtx(()=>t[15]||(t[15]=[e.createTextVNode("阶梯拼团")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createVNode(p,{label:"参团人数",prop:"users",required:""},{default:e.withCtx(()=>[r.value.mode==="COMMON"?(e.openBlock(),e.createBlock(c,{key:0,modelValue:r.value.users[0],"onUpdate:modelValue":t[4]||(t[4]=i=>r.value.users[0]=i),formatter:i=>Number(`${i}`.replace(/[^\d]/g,"")),parser:i=>`${Number(i)>=100?100:i}`,style:{width:"550px"},max:100},{append:e.withCtx(()=>t[16]||(t[16]=[e.createTextVNode(" 人 ")])),_:1},8,["modelValue","formatter","parser"])):(e.openBlock(),e.createElementBlock("div",ue,[e.createVNode(x,{link:"",type:"primary",onClick:k},{default:e.withCtx(()=>t[17]||(t[17]=[e.createTextVNode("添加拼团阶梯")])),_:1}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value.users,(i,L)=>(e.openBlock(),e.createElementBlock("div",{key:L,class:"groupForm__stairs"},[e.createElementVNode("span",fe,"第"+e.toDisplayString(L+1)+"阶段人数",1),e.createVNode(c,{modelValue:r.value.users[L],"onUpdate:modelValue":U=>r.value.users[L]=U,class:"groupForm__stairs--input",style:{width:"450px"},formatter:U=>Number(`${U}`.replace(/[^\d]/g,"")),parser:U=>`${Number(U)>=100?100:U}`,max:100},{append:e.withCtx(()=>t[18]||(t[18]=[e.createTextVNode(" 人 ")])),_:2},1032,["modelValue","onUpdate:modelValue","formatter","parser"]),L>0?(e.openBlock(),e.createBlock(x,{key:0,type:"primary",link:"",onClick:w},{default:e.withCtx(()=>t[19]||(t[19]=[e.createTextVNode("删除")])),_:1})):e.createCommentVNode("",!0)]))),128))]))]),_:1}),e.createVNode(p,{label:"订单关闭时间",prop:"payTimeout"},{default:e.withCtx(()=>[e.createVNode(_,{modelValue:r.value.payTimeout,"onUpdate:modelValue":t[5]||(t[5]=i=>r.value.payTimeout=i),controls:!1,max:360,min:3},null,8,["modelValue"]),t[20]||(t[20]=e.createElementVNode("span",{class:"tips",style:{"margin-left":"8px"}},"商品按下单减库存，请设置未付款订单自动取消时间及时释放库存，可输入3-360分钟",-1))]),_:1}),e.createVNode(p,{label:"自动成团",prop:"simulate"},{default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(I,{modelValue:r.value.simulate,"onUpdate:modelValue":t[6]||(t[6]=i=>r.value.simulate=i)},{default:e.withCtx(()=>[e.createVNode(f,{value:!1},{default:e.withCtx(()=>t[21]||(t[21]=[e.createTextVNode("关闭")])),_:1}),e.createVNode(f,{value:!0},{default:e.withCtx(()=>t[22]||(t[22]=[e.createTextVNode("开启")])),_:1})]),_:1},8,["modelValue"]),t[23]||(t[23]=e.createElementVNode("div",{class:"tips"},"开启后拼团有效时间内人数未满，系统将以“虚拟用户”凑满人数提高成团率。",-1))])]),_:1}),e.createVNode(p,{label:"优惠叠加"},{default:e.withCtx(()=>[e.createVNode(P,{modelValue:r.value.stackable.vip,"onUpdate:modelValue":t[7]||(t[7]=i=>r.value.stackable.vip=i),label:"会员价"},null,8,["modelValue"]),e.createVNode(P,{modelValue:r.value.stackable.coupon,"onUpdate:modelValue":t[8]||(t[8]=i=>r.value.stackable.coupon=i),label:"优惠券"},null,8,["modelValue"]),e.createVNode(P,{modelValue:r.value.stackable.full,"onUpdate:modelValue":t[9]||(t[9]=i=>r.value.stackable.full=i),label:"满减"},null,8,["modelValue"]),t[24]||(t[24]=e.createElementVNode("span",{class:"tips",style:{"margin-left":"8px"}},[e.createTextVNode(" 优惠叠加可能导致实付金额为 "),e.createElementVNode("i",{style:{color:"red","font-weight":"700","font-style":"unset"}},"0"),e.createTextVNode(" (实付金额= 活动价 - 会员优惠 - 优惠券优惠 - 满减优惠) ")],-1))]),_:1}),e.createVNode(p,{label:"适用商品"},{default:e.withCtx(()=>[e.createVNode(x,{type:"primary",link:"",onClick:l},{default:e.withCtx(()=>t[25]||(t[25]=[e.createTextVNode("选择商品")])),_:1})]),_:1})]),_:1},8,["model","rules","disabled"]),e.createVNode(D,{modelValue:G.value,"onUpdate:modelValue":t[10]||(t[10]=i=>G.value=i),searchParam:M,"onUpdate:searchParam":t[11]||(t[11]=i=>M=i),searchConsignmentProduct:!0,pointGoodsList:B.value,onOnConfirm:O},null,8,["modelValue","searchParam","pointGoodsList"]),e.createVNode(ie,{ref_key:"selectGoodsTableRef",ref:q,mode:r.value.mode,users:r.value.users,productList:B.value,isEdit:e.unref(b),flatGoodList:$.value},null,8,["mode","users","productList","isEdit","flatGoodList"])]),e.createElementVNode("div",ke,[e.createVNode(x,{round:"",onClick:A},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(b)?"返回":"取消"),1)]),_:1}),e.unref(b)?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(x,{key:0,type:"primary",round:"",onClick:j},{default:e.withCtx(()=>t[27]||(t[27]=[e.createTextVNode("确定")])),_:1}))])],64)}}}),ye="";return X(Ve,[["__scopeId","data-v-16539054"]])});

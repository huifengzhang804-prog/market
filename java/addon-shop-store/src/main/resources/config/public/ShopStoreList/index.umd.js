(function(e,a){typeof exports=="object"&&typeof module<"u"?module.exports=a(require("vue"),require("element-plus"),require("vue-router"),require("@/components/SchemaForm.vue"),require("@/libs/validate"),require("@/apis/http"),require("@/components/slide-captcha/SliderCaptcha.vue")):typeof define=="function"&&define.amd?define(["vue","element-plus","vue-router","@/components/SchemaForm.vue","@/libs/validate","@/apis/http","@/components/slide-captcha/SliderCaptcha.vue"],a):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopStoreList=a(e.ShopStoreListContext.Vue,e.ShopStoreListContext.ElementPlus,e.ShopStoreListContext.VueRouter,e.ShopStoreListContext.SchemaForms,e.ShopStoreListContext.LibsValidate,e.ShopStoreListContext.Request,e.ShopStoreListContext.SliderCaptcha))})(this,function(e,a,M,O,D,N,A){"use strict";var L=document.createElement("style");L.textContent=`@charset "UTF-8";[data-v-98639474]{font-size:14px}.addsalesclerk__phone[data-v-3a618851]{display:flex;align-items:center;margin-bottom:15px}.addsalesclerk__phone--input[data-v-3a618851]{margin-left:35px}.addsalesclerk__code[data-v-3a618851]{display:flex;align-items:center}.addsalesclerk__code--title[data-v-3a618851]{width:72px;text-align:right}
`,document.head.appendChild(L);const F={class:"tab_container"},P=e.defineComponent({__name:"ShopStoreList",setup(n){const i={storeList:e.defineAsyncComponent(()=>Promise.resolve().then(()=>ee)),salesclerkList:e.defineAsyncComponent(()=>Promise.resolve().then(()=>he))},_=e.ref("storeList");return(f,r)=>{const C=e.resolveComponent("el-tab-pane"),c=e.resolveComponent("el-tabs");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",F,[e.createVNode(c,{modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=u=>_.value=u)},{default:e.withCtx(()=>[e.createVNode(C,{label:"门店列表",name:"storeList"}),e.createVNode(C,{label:"店员列表",name:"salesclerkList"})]),_:1},8,["modelValue"])]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(i[_.value])))],64)}}}),B=n=>N.get({url:"addon-shop-store/store/list",params:n}),R=(n,i)=>N.del({url:`addon-shop-store/store/del/${n}/${i}`}),v=(n,i)=>N.put({url:`addon-shop-store/store/update/${n}`,data:i}),U=n=>N.post({url:"addon-shop-store/assistant/issue",data:n}),q=n=>N.get({url:"addon-shop-store/assistant/list",data:n}),j=(n,i)=>N.put({url:`addon-shop-store/assistant/set/store/${n}`,params:i}),z=n=>N.del({url:`addon-shop-store/assistant/del/${n}`}),H=n=>{const{captchaTrack:i,form:_,id:f,smsType:r}=n;return N.post({url:`gruul-mall-uaa/uaa/auth/captcha/sms/${r}`,data:{captchaTrack:i,form:_,id:f}})},G={class:"handle_container"},X={class:"table_container"},J={class:"ellipsis"},K={class:"ellipsis"},Q=["onClick"],W=["onClick"],Y=["onClick"],Z=e.defineComponent({__name:"storeList",setup(n){const i=M.useRouter(),_=e.ref([]),f=e.reactive([{value:"",label:"全部"},{value:"NORMAL",label:"正常"},{value:"SHOP_FORBIDDEN",label:"店铺禁用"},{value:"PLATFORM_FORBIDDEN",label:"平台禁用"}]),r=e.ref({state:""}),C=[{label:"门店状态",prop:"state",valueType:"select",options:f,fieldProps:{placeholder:"请选择"}}];c();async function c(){const{code:m,data:d}=await B({size:5,status:r.value.state});m===200&&d?_.value=d.records:a.ElMessage.error("获取列表失败")}const u=(m,d,x)=>{i.push({path:"/shop/store/AddStore",query:{shopId:m,id:d,lookType:x}})},p=(m,d)=>{a.ElMessageBox.confirm("确定删除该门店吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{code:x,msg:g}=await R(m,d);x===200?(a.ElMessage.success("删除成功"),c()):a.ElMessage.error(g||"删除失败")})},k=async(m,d,x)=>{const{code:g,msg:V}=await v(x,[{shopId:m,ids:[d]}]);g===200?(a.ElMessage.success("修改状态成功"),c()):a.ElMessage.error(V||"修改状态失败")},S=m=>{m&&Object.keys(m).forEach(d=>{r.value[d]=m[d]})},E=()=>{Object.keys(r.value).forEach(m=>{r.value[m]=""}),c()};return(m,d)=>{const x=e.resolveComponent("el-config-provider"),g=e.resolveComponent("el-button"),V=e.resolveComponent("el-table-column"),y=e.resolveComponent("el-switch"),b=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(x,{"value-on-clear":"","empty-values":[void 0,null]},{default:e.withCtx(()=>[e.createVNode(O,{"v-model":r.value,columns:C,onSearchHandle:c,onChangeFormItem:S,onHandleReset:E},null,8,["v-model"])]),_:1}),e.createElementVNode("div",G,[e.createVNode(g,{round:"",type:"primary",onClick:d[0]||(d[0]=s=>e.unref(i).push("/shop/store/AddStore"))},{default:e.withCtx(()=>d[1]||(d[1]=[e.createTextVNode("添加门店")])),_:1})]),e.createElementVNode("div",X,[e.createVNode(b,{data:_.value,"header-cell-style":{background:"#f6f8fa",height:"48px"},"header-row-style":{color:"#333"},"empty-text":"暂无数据~",style:{width:"100%"}},{default:e.withCtx(()=>[e.createVNode(V,{label:"门店名称","show-overflow-tooltip":""},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",J,e.toDisplayString(s.storeName),1)]),_:1}),e.createVNode(V,{label:"负责人手机号",width:"130"},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",null,e.toDisplayString(s.functionaryPhone),1)]),_:1}),e.createVNode(V,{label:"负责人姓名",width:"100"},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",null,e.toDisplayString(s.functionaryName),1)]),_:1}),e.createVNode(V,{label:"地址",width:"350","show-overflow-tooltip":""},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",K,e.toDisplayString(s.detailedAddress),1)]),_:1}),e.createVNode(V,{label:"状态"},{default:e.withCtx(({row:s})=>[e.createVNode(y,{modelValue:s.status,"onUpdate:modelValue":l=>s.status=l,"active-value":"NORMAL","inactive-value":"SHOP_FORBIDDEN","inline-prompt":"","active-text":"开启","inactive-text":"关闭",onClick:l=>k(s.shopId,s.id,s.status)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),e.createVNode(V,{align:"right",label:"操作",width:"200px"},{default:e.withCtx(({row:s})=>[e.createElementVNode("span",{style:{color:"#555cfd",cursor:"pointer",margin:"0 10px"},onClick:l=>u(s.shopId,s.id,"OnlyLook")},"查看",8,Q),s.status==="NORMAL"?(e.openBlock(),e.createElementBlock("span",{key:0,style:{color:"#555cfd",cursor:"pointer",margin:"0 10px"},onClick:l=>u(s.shopId,s.id,"Edite")},"编辑",8,W)):e.createCommentVNode("",!0),e.createElementVNode("span",{style:{color:"#f54319",cursor:"pointer"},onClick:l=>p(s.shopId,s.id)},"删除",8,Y)]),_:1})]),_:1},8,["data"])])])}}}),ke="",I=(n,i)=>{const _=n.__vccOpts||n;for(const[f,r]of i)_[f]=r;return _},ee=Object.freeze(Object.defineProperty({__proto__:null,default:I(Z,[["__scopeId","data-v-98639474"]])},Symbol.toStringTag,{value:"Module"})),te={class:"handle_container fcenter"},oe={class:"table_container"},se={class:"ellipsis"},le={class:"ellipsis"},ae=["onClick"],ne=["onClick"],re={class:"addsalesclerk__phone"},de={class:"addsalesclerk__phone--input"},ie={class:"addsalesclerk__code"},ce={class:"dialog-footer"},pe={class:"addsalesclerk__phone"},me={class:"addsalesclerk__phone--input"},_e={class:"addsalesclerk__code"},fe={class:"dialog-footer"},ue=e.defineComponent({__name:"salesclerkList",setup(n){const i=e.ref([]),_=e.ref([]),f=e.ref(!1),r=e.ref(!1),C=e.ref(!1),c=e.ref(60),u=e.ref(null),p=e.ref({assistantPhone:"",assistantPhoneCode:""}),k=e.ref({shopAssistantId:"",storeId:""}),S=e.ref("");e.onMounted(()=>{y(),b()});const E=l=>{a.ElMessage.success("验证码已发送"),c.value-=1,C.value=!1,p.value.assistantPhoneCode=l==null?void 0:l.data,u.value=setInterval(()=>{if(c.value-=1,c.value<=0){c.value=60,u.value&&(clearInterval(u.value),u.value=null);return}},999)},m=()=>{if(!p.value.assistantPhone)return a.ElMessage.error("请填写手机号");if(!D.REGEX_MOBILE(p.value.assistantPhone))return a.ElMessage.error("请填写正确的手机号");C.value=!0},d=async()=>{clearInterval(u.value),u.value=null,c.value=60;const{code:l,msg:t}=await U(p.value);l===200?(a.ElMessage.success("添加成功"),y(),p.value={assistantPhone:"",assistantPhoneCode:""},f.value=!1):(p.value.assistantPhone="",p.value.assistantPhoneCode="",a.ElMessage.error(t||"添加失败"))},x=(l,t,h)=>{S.value=l,k.value.shopAssistantId=t,k.value.storeId=h,r.value=!0},g=async()=>{const{code:l,msg:t}=await j(k.value.shopAssistantId,{storeId:k.value.storeId});l===200?(r.value=!1,a.ElMessage.success("添加成功"),y()):a.ElMessage.error(t||"添加失败")},V=async l=>{a.ElMessageBox.confirm("确定删除该店员吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{code:t,msg:h}=await z(l);t===200?(a.ElMessage.success("删除成功"),y()):a.ElMessage.error(h||"删除失败")})};async function y(){const{code:l,data:t}=await q();l===200&&t?i.value=t:a.ElMessage.error("获取列表失败"),f.value=!1}async function b(){const{code:l,data:t}=await B({size:5});l===200&&t?_.value=t.records:a.ElMessage.error("获取列表失败")}const s=()=>{f.value=!1,Object.keys(p.value).forEach(l=>p.value[l]=""),c.value=60,clearInterval(u.value)};return(l,t)=>{const h=e.resolveComponent("el-button"),w=e.resolveComponent("el-table-column"),Ve=e.resolveComponent("el-table"),$=e.resolveComponent("el-input"),T=e.resolveComponent("el-dialog"),Ce=e.resolveComponent("el-option"),xe=e.resolveComponent("el-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",te,[e.createVNode(h,{round:"",type:"primary",onClick:t[0]||(t[0]=o=>f.value=!0)},{default:e.withCtx(()=>t[8]||(t[8]=[e.createTextVNode(" 添加店员")])),_:1}),t[9]||(t[9]=e.createElementVNode("div",{style:{color:"#8f8f95"},class:"mla"},"店员凭手机号登录门店移动端，核销到店自提订单",-1))]),e.createElementVNode("div",oe,[e.createVNode(Ve,{data:i.value,"header-cell-style":{"background-color":"#F6F8FA","font-weight":"bold",color:"#515151"},"empty-text":"暂无数据~",style:{width:"100%",height:"calc(100vh - 210px)"}},{default:e.withCtx(()=>[e.createVNode(w,{align:"center",label:"店员手机号"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",se,e.toDisplayString(o.assistantPhone),1)]),_:1}),e.createVNode(w,{align:"center",label:"所属门店"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",le,e.toDisplayString(o.storeName?o.storeName:""),1)]),_:1}),e.createVNode(w,{align:"center",label:"操作"},{default:e.withCtx(({row:o})=>[e.createElementVNode("span",{style:{color:"#2e99f3",cursor:"pointer","margin-right":"20px"},onClick:Ne=>x(o.assistantPhone,o.id,o.storeId)},"编辑",8,ae),e.createElementVNode("span",{style:{color:"#f56c6c",cursor:"pointer"},onClick:Ne=>V(o.id)},"删除",8,ne)]),_:1})]),_:1},8,["data"])]),e.createVNode(T,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=o=>f.value=o),center:"",title:"店员",width:"500px","before-close":s},{footer:e.withCtx(()=>[e.createElementVNode("span",ce,[e.createVNode(h,{round:"",onClick:s},{default:e.withCtx(()=>t[13]||(t[13]=[e.createTextVNode("取消")])),_:1}),e.createVNode(h,{round:"",type:"primary",onClick:d},{default:e.withCtx(()=>t[14]||(t[14]=[e.createTextVNode(" 保存 ")])),_:1})])]),default:e.withCtx(()=>[e.createElementVNode("div",re,[t[11]||(t[11]=e.createTextVNode(" 店员手机号 ")),e.createElementVNode("div",de,[e.createVNode($,{modelValue:p.value.assistantPhone,"onUpdate:modelValue":t[1]||(t[1]=o=>p.value.assistantPhone=o),maxlength:"11",placeholder:"请输入电话号码",style:{width:"200px"}},null,8,["modelValue"]),c.value===60?(e.openBlock(),e.createBlock(h,{key:0,plain:"",onClick:m},{default:e.withCtx(()=>t[10]||(t[10]=[e.createTextVNode("获取验证码")])),_:1})):(e.openBlock(),e.createBlock(h,{key:1,disabled:"",link:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(c.value),1)]),_:1}))])]),e.createElementVNode("div",ie,[t[12]||(t[12]=e.createElementVNode("div",{class:"addsalesclerk__code--title"},"验证码",-1)),e.createVNode($,{modelValue:p.value.assistantPhoneCode,"onUpdate:modelValue":t[2]||(t[2]=o=>p.value.assistantPhoneCode=o),maxlength:"6",placeholder:"请输入验证码",style:{width:"200px","margin-left":"35px"}},null,8,["modelValue"])])]),_:1},8,["modelValue"]),e.createVNode(T,{modelValue:r.value,"onUpdate:modelValue":t[6]||(t[6]=o=>r.value=o),center:"",title:"所属门店",width:"500px"},{footer:e.withCtx(()=>[e.createElementVNode("span",fe,[e.createVNode(h,{round:"",onClick:t[5]||(t[5]=o=>r.value=!1)},{default:e.withCtx(()=>t[17]||(t[17]=[e.createTextVNode("取消")])),_:1}),e.createVNode(h,{round:"",type:"primary",onClick:g},{default:e.withCtx(()=>t[18]||(t[18]=[e.createTextVNode(" 保存 ")])),_:1})])]),default:e.withCtx(()=>[e.createElementVNode("div",pe,[t[15]||(t[15]=e.createTextVNode(" 店员手机号 ")),e.createElementVNode("div",me,e.toDisplayString(S.value),1)]),e.createElementVNode("div",_e,[t[16]||(t[16]=e.createElementVNode("div",{class:"addsalesclerk__code--title"},"所属门店",-1)),e.createVNode(xe,{modelValue:k.value.storeId,"onUpdate:modelValue":t[4]||(t[4]=o=>k.value.storeId=o),placeholder:"选择门店",style:{"margin-left":"35px"}},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(_.value,o=>(e.openBlock(),e.createBlock(Ce,{key:o.id,label:o.storeName,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"]),e.createVNode(A,{modelValue:C.value,"onUpdate:modelValue":t[7]||(t[7]=o=>C.value=o),"do-submit":e.unref(H),"get-form":()=>p.value.assistantPhone,scale:1,"sms-type":"SHOP_STORE_FOUND",onSuccess:E},null,8,["modelValue","do-submit","get-form"])],64)}}}),ye="",he=Object.freeze(Object.defineProperty({__proto__:null,default:I(ue,[["__scopeId","data-v-3a618851"]])},Symbol.toStringTag,{value:"Module"}));return P});

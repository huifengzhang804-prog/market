(function(e,R){typeof exports=="object"&&typeof module<"u"?module.exports=R(require("vue"),require("@/components/chrome-tab/index.vue"),require("@/components/schema-form/index.vue"),require("lodash-es"),require("@element-plus/icons-vue"),require("@/components/PageManage.vue"),require("@/utils/date"),require("@/components/remark/remark-popup.vue"),require("decimal.js"),require("@/composables/useConvert"),require("element-plus"),require("@/apis/http")):typeof define=="function"&&define.amd?define(["vue","@/components/chrome-tab/index.vue","@/components/schema-form/index.vue","lodash-es","@element-plus/icons-vue","@/components/PageManage.vue","@/utils/date","@/components/remark/remark-popup.vue","decimal.js","@/composables/useConvert","element-plus","@/apis/http"],R):(e=typeof globalThis<"u"?globalThis:e||self,e.Rebate=R(e.RebateContext.Vue,e.RebateContext.ChromeTab,e.RebateContext.SchemaForm,e.RebateContext.Lodash,e.RebateContext.ElementPlusIconsVue,e.RebateContext.PageManageTwo,e.RebateContext.DateUtil,e.RebateContext.RemarkPopup,e.RebateContext.Decimal,e.RebateContext.UseConvert,e.RebateContext.ElementPlus,e.RebateContext.Request))})(this,function(e,R,be,W,H,pe,fe,_e,X,U,L,q){"use strict";var Q=document.createElement("style");Q.textContent=`@charset "UTF-8";.o_table{width:100%;table-layout:fixed;border-collapse:separate;font-size:12px}.o_table .hide{display:none}.o_table--container{position:relative}.o_table--container.single{background:none}.o_table--container.single .o_table--head th:first-child{border-radius:10px 0 0}.o_table--container.single .o_table--head th:last-child{border-radius:0 10px 0 0}.o_table--container.single .o_table--head:after{display:none}.o_table--shrink{flex:1;text-align:left;color:#333}.o_table--center{display:flex;align-items:center}.o_table .close{background:#f5f5f5!important}.o_table .ordinary--class:hover .body--header,.o_table .ordinary--class:hover .body--content td{border-color:#bcdfff}.o_table .ordinary--class:hover .body--content td:last-child{border-color:#bcdfff}.o_table .need--border .body--content td{border-right:1px solid #bcdfff}.o_table .need--border .body--content td:last-child{border-color:#bcdfff}.o_table--empty .empty__td{width:960px;height:80px;background-color:#fff;margin-left:-15px;font-size:14px;color:#b3b3b3}.o_table--head th{background:#f7f8fa;padding:10px;text-align:center;color:#515a6e;font-weight:550;border-top:1px solid #f7f8fa;border-bottom:1px solid #f7f8fa;height:50px;vertical-align:middle;font-size:14px;color:#586884}.o_table--head th:first-child{border-left:1px solid #f7f8fa}.o_table--head th:last-child{border-right:1px solid #f7f8fa}.o_table--head:after{content:"-";display:block;line-height:14px;color:transparent}.o_table--head.padding:after{content:"-";display:block;color:transparent}.o_table--body .body--header{display:flex;justify-content:flex-start;align-items:center;padding:0 10px;font-size:13px;height:55px;vertical-align:middle;background:#f7f8fa}.o_table--body.default .body--content .o_table--item:first-child,.o_table--body.default .body--content .o_table--item:last-child{border-radius:0}.o_table--body.default .o_table--item{vertical-align:middle}.o_table--body .body--content td{padding:8px 10px;font-size:12px;color:#50596d;background:#fff;vertical-align:middle}.o_table--body .body--content td .item__content{display:flex;justify-content:center;align-items:center}.o_table--body .body--content td .selection__checkbox{display:inline-block;width:100%;height:100%}.o_table--body .body--content td .selection__checkbox.selection{display:flex;justify-content:flex-start;align-items:center}.o_table--body .body--content.is--multiple td:first-child{border-right:1px solid #d8eaf9!important}.o_table .el-checkbox{margin-right:10px!important;float:left}.rebate-data[data-v-d5670c0f]{padding:16px;background-color:#555cfd0d;display:flex;justify-content:center;align-items:center;justify-content:space-between}.rebate-data__left[data-v-d5670c0f]{display:flex;justify-content:center;align-items:center}.rebate-data__item[data-v-d5670c0f]{color:#333;margin-right:50px;display:flex;justify-content:center;align-items:center}.rebate-data__item--price[data-v-d5670c0f]{font-size:16px}.rebate-data__item--price[data-v-d5670c0f]:before{content:"￥";font-size:12px}[data-v-bbbdea2b]{font-size:14px}.goods__content[data-v-bbbdea2b]{display:flex;justify-content:center;align-items:center}.shop-name[data-v-bbbdea2b]{width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.orderIndex-table[data-v-bbbdea2b]{position:relative;overflow-x:auto;transition:height .5s}.orderIndex-table__top[data-v-bbbdea2b]{display:flex;justify-content:space-between;align-items:center;width:100%}.orderIndex-table__top-time[data-v-bbbdea2b]{display:flex;justify-content:center;align-items:center}.orderIndex-table__top-time>div[data-v-bbbdea2b]:nth-child(2){padding:0 60px}.orderIndex-table__commodity[data-v-bbbdea2b]{width:100%;display:flex;height:92px}.orderIndex-table__img-box[data-v-bbbdea2b]{width:320px;display:flex;align-items:center;font-size:14px;justify-content:space-between}.orderIndex-table__img[data-v-bbbdea2b]{flex-shrink:0;border-radius:5px;position:relative}.orderIndex-table__img-mask[data-v-bbbdea2b]{display:flex;flex-direction:column;justify-content:space-around;align-items:end;font-size:12px;color:#666;margin-left:20px}.caozuo_btn[data-v-bbbdea2b]:hover{color:#fff;background:#309af3!important}.money_text[data-v-bbbdea2b]{font-size:12px;color:#000;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.avatar_text[data-v-bbbdea2b]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.avatar_text__bottom[data-v-bbbdea2b]{margin-bottom:5px}.el-icon--right-top[data-v-bbbdea2b]{margin-left:5px}.el-icon--right[data-v-bbbdea2b]{top:10px;position:absolute;left:-20px;opacity:0}.header-table[data-v-bbbdea2b]{width:100%;display:flex;justify-content:"";align-items:"center"}.header-table span[data-v-bbbdea2b]:after{content:"|";margin:0 10px;color:#999}.header-table span[data-v-bbbdea2b]:last-child:after{content:"";margin:0}.order-info[data-v-bbbdea2b]{flex:1;display:flex;flex-direction:column;justify-content:space-around;height:68px;margin:0 8px;word-break:break-all;line-height:1.5;overflow:hidden;width:0}.order-info__name[data-v-bbbdea2b]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden;line-height:18px;color:#333}.order-info__spec[data-v-bbbdea2b]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:#999}.customer[data-v-bbbdea2b]{text-align:left;width:100%;line-height:1.3}.customer__copy[data-v-bbbdea2b]{text-align:right;margin-bottom:8px}.copy[data-v-bbbdea2b]{color:#1890ff;margin-left:8px;cursor:pointer}.example-showcase .el-dropdown-link[data-v-bbbdea2b]{cursor:pointer;color:var(--el-color-primary);display:flex;align-items:center}.el-popper.is-customized[data-v-bbbdea2b]{padding:6px 12px;background:linear-gradient(90deg,rgb(159,229,151),rgb(204,229,129))}.el-popper.is-customized .el-popper__arrow[data-v-bbbdea2b]:before{background:linear-gradient(45deg,#b2e68d,#bce689);right:0}.submit[data-v-bdb77e7e]{margin-top:auto;width:100%;height:55px;text-align:center;align-content:center;box-shadow:0 -3px 8px #0000001a}
`,document.head.appendChild(Q);const he={class:"fdc1 overh"},ge=e.defineComponent({__name:"Rebate",setup(a){const n=[{label:"消费返利订单",name:"REBATE_ORDER"},{label:"消费返利设置",name:"REBATE_SET"}],d=e.ref("REBATE_ORDER"),c={REBATE_ORDER:e.defineAsyncComponent(()=>Promise.resolve().then(()=>ot)),REBATE_SET:e.defineAsyncComponent(()=>Promise.resolve().then(()=>_t))},s=y=>{y&&(d.value=y)};return(y,m)=>(e.openBlock(),e.createElementBlock("div",he,[e.createVNode(R,{"tab-list":n,value:d.value,onHandleTabs:s},null,8,["value"]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(c[d.value])))]))}}),ye=e.defineComponent({__name:"search",emits:["getSearchParams","showChange"],setup(a,{emit:n}){const d=n,c=e.reactive({orderNo:"",productName:"",shopName:"",buyerNickname:"",clinchTime:""}),s=e.ref(!1),y=[{label:"订单号",prop:"orderNo",valueType:"copy",fieldProps:{placeholder:"请填写订单号",maxlength:21}},{label:"商品名称",prop:"productName",valueType:"copy",fieldProps:{placeholder:"请填写商品名称",maxlength:20}},{label:"店铺名称",prop:"shopName",valueType:"copy",fieldProps:{placeholder:"请填写店铺名称",maxlength:20}},{label:"买家昵称",prop:"buyerNickname",valueType:"copy",fieldProps:{placeholder:"请填写买家昵称",maxlength:20}},{label:"下单时间",prop:"clinchTime",valueType:"date-picker",fieldProps:{type:"daterange",startPlaceholder:"开始时间",endPlaceholder:"结束时间",format:"YYYY/MM/DD",valueFormat:"YYYY-MM-DD"}}],m=l=>{l&&Object.keys(l).forEach(x=>c[x]=l[x])},o=()=>{var x,g;const l=W.cloneDeep(c);l.clinchTime&&Array.isArray(l.clinchTime)&&(l.orderCreateTime=(x=l.clinchTime)==null?void 0:x[0],l.orderEndTime=(g=l.clinchTime)==null?void 0:g[1]),delete l.clinchTime,d("getSearchParams",l)},p=()=>{Object.keys(c).forEach(l=>c[l]=""),o()};return e.watch(()=>s.value,l=>{d("showChange",l)}),(l,x)=>(e.openBlock(),e.createElementBlock("div",null,[e.createVNode(be,{columns:y,"v-model":c,"has-unfold":"",onChangeFormItem:m,onSearchHandle:o,onHandleReset:p},null,8,["v-model"])]))}}),xe=()=>({data:{type:Array,default(){return[]}},selection:{type:Boolean,default:!1},custom:{type:Boolean,default:!1},needBorder:{type:Boolean,default:!1},columns:{type:Array,default(){return[]}},tableHeaderClass:{type:String,default:""},rowHeaderClass:{type:String,default:""},needHoverBorder:{type:Boolean,default:!1},multipleKey:{type:String,default:""}}),ue=e.defineComponent({props:xe(),emits:["check"],setup(a,{slots:n,emit:d}){const c=e.ref([]),s=e.computed({get:()=>!!(m.value.length&&m.value.every(r=>r.checked)),set:r=>{l(r),d("check",x())}}),y=e.computed(()=>{const r=m.value.filter(_=>_.checked).length;return r!==0&&r!==m.value.length}),m=e.computed(()=>{const r=c.value;return r?o(r):[]}),o=r=>r?(r.forEach(_=>{const N=_,T=N.rebateOrderItems;N.packageMap=T.reduce((E,V)=>{var h;const f=`${V.productId}-${V.skuId}`;return E.has(f)?(h=E.get(f))==null||h.push(V):E.set(f,[V]),E},new Map)}),r):[];e.watch(a,r=>{c.value=r.data},{immediate:!0});const p=(r,_)=>{Object.assign(r.props?r.props:{},_)};function l(r){m.value=m.value.map(_=>(_.checked=r,_))}function x(){return m.value.filter(r=>r.checked)}const g=(r,_)=>{const N=[],T=r.packageMap;let E=!0;return T.forEach((V,f)=>{N.push(e.createVNode("tr",{class:"body--content"},[n.default&&n.default().map((h,M)=>{var k;p(h,{row:r,packageId:f,shopOrderItems:V});const w=(k=h.props)==null?void 0:k["is-mixed"];if(w&&E||!w)return e.createVNode("td",{class:["o_table--item",!h&&"hide"],rowspan:w?T.size:void 0},[e.createVNode("div",{class:["selection__checkbox",a.selection&&M===0&&"selection"]},[e.createVNode("div",{class:["o_table--shrink"]},[h])])])})])),E=!1}),N};return()=>e.createVNode("table",{class:["o_table"],cellpadding:"0",cellspacing:"0"},[e.createVNode("colgroup",null,[a.columns.map(r=>e.createVNode("col",{width:r.width},null))]),e.createVNode("thead",{class:["o_table--head",a.tableHeaderClass,n.header&&"padding"]},[e.createVNode("tr",{class:"m__tr"},[a.columns.map((r,_)=>e.createVNode("th",{style:r.customStyle,class:_===0&&a.selection&&["o_table--center"]},[_===0&&a.selection&&e.createVNode(e.resolveComponent("el-checkbox"),{indeterminate:y.value,modelValue:s.value,"onUpdate:modelValue":N=>s.value=N,onChange:l.bind(this,s.value)},null),e.createVNode("div",{class:["o_table--shrink"]},[r.label])]))])]),m.value.length?m.value.map((r,_)=>e.createVNode("tbody",{class:["o_table--body",a.custom?"custom":"default",a.needBorder&&"need--border",a.needHoverBorder&&r.close?"hover--class":"ordinary--class"]},[n.header&&e.createVNode("tr",null,[e.createVNode("td",{colspan:a.columns.length},[e.createVNode("div",{class:["body--header",a.rowHeaderClass,{close:r.close}]},[n.header({row:r,index:_})])])]),g(r)])):e.createVNode("tbody",{class:"o_table--empty"},[e.createVNode("tr",null,[e.createVNode("td",{class:"empty__td",colspan:a.columns.length,align:"center"},[e.createTextVNode("暂无数据~")])])])])}}),Bt="",Ne=()=>({data:{type:Array,default(){return[]}},selection:{type:Boolean,default:!1},custom:{type:Boolean,default:!1},needBorder:{type:Boolean,default:!1},columns:{type:Array,default(){return[]}},tableHeaderClass:{type:String,default:""},rowHeaderClass:{type:String,default:""},needHoverBorder:{type:Boolean,default:!1},multipleKey:{type:String,default:""}}),Ee=e.defineComponent({props:Ne(),emits:["update:checkedItem"],setup(a,{slots:n,emit:d}){const c=e.ref(),s=e.ref(),y=()=>a.columns.length>0&&a.columns||n.default&&n.default().map(p=>{const l=p.props;return{label:l==null?void 0:l.label,width:l==null?void 0:l.width,prop:l==null?void 0:l.prop,customStyle:l==null?void 0:l.customStyle,isMixed:(l==null?void 0:l.isMixed)||!1}}),m=p=>{d("update:checkedItem",p)},o=()=>{const p={default:()=>n.default&&n.default()};if(!n.default&&!a.columns.length&&!n.custom)throw new Error("请传入MTableColumn");return n.header&&(p.header=l=>n.header&&n.header(l)),p};return e.watch(a,p=>{s.value=W.cloneDeep(p.data)},{immediate:!0}),()=>e.createVNode("div",{class:["o_table--container"]},[e.createVNode(ue,{onCheck:m,columns:y(),data:s.value,custom:a.custom,selection:a.selection,tableHeaderClass:a.tableHeaderClass,rowHeaderClass:a.rowHeaderClass,needHoverBorder:a.needHoverBorder,multipleKey:a.multipleKey,needBorder:a.needBorder,ref:c},o())])}}),P=e.defineComponent({__name:"split-table-column",props:{prop:{type:String,default:""},align:{type:String,default:"center"},row:{type:Object,default(){return{}}},packageId:{type:String,default(){}},shopOrderItems:{type:Object,default(){return[]}}},setup(a){const n=a,d=c=>{switch(c){case"left":return"flex-start";case"right":return"flex-end";default:return"center"}};return(c,s)=>(e.openBlock(),e.createElementBlock("div",{class:"item__content",style:e.normalizeStyle({justifyContent:d(n.align)})},[e.renderSlot(c.$slots,"default",{row:n.row,shopOrderItems:n.shopOrderItems})],4))}}),Ve=()=>q.get({url:"addon-rebate/rebateConf"}),ke=a=>q.put({url:"addon-rebate/rebateConf",data:a}),Ce=a=>q.get({url:"addon-rebate/rebateOrder",params:a});var j=(a=>(a.UNPAID="待付款",a.PAID="已付款",a.COMPLETED="已完成",a.CLOSED="已关闭",a))(j||{});const we={class:"rebate-data"},Se={class:"rebate-data__left"},Te={class:"rebate-data__item"},Be={class:"rebate-data__item--price"},De={class:"rebate-data__item"},Pe={class:"rebate-data__item--price",style:{color:"red","font-weight":"bold"}},Re={class:"rebate-data__item"},Me={class:"rebate-data__item--price",style:{color:"#999","font-weight":"bold"}},Ae=e.defineComponent({__name:"rebate-data",props:{rebateDetailStatistic:{default:()=>({totalExpired:"",totalPendingSettlement:"",totalRebate:""})}},setup(a){const{divTenThousand:n}=U(),d=a;return(c,s)=>{const y=e.resolveComponent("el-popover");return e.openBlock(),e.createElementBlock("div",we,[e.createElementVNode("div",Se,[e.createElementVNode("div",Te,[s[0]||(s[0]=e.createElementVNode("p",null,"累计总返利：",-1)),e.createElementVNode("span",Be,e.toDisplayString(e.unref(n)(d.rebateDetailStatistic.totalRebate)),1)]),e.createElementVNode("div",De,[s[1]||(s[1]=e.createElementVNode("p",null,"待结算总返利：",-1)),e.createElementVNode("span",Pe,e.toDisplayString(e.unref(n)(d.rebateDetailStatistic.totalPendingSettlement)),1)]),e.createElementVNode("div",Re,[s[2]||(s[2]=e.createElementVNode("p",null,"已失效总返利：",-1)),e.createElementVNode("span",Me,e.toDisplayString(e.unref(n)(d.rebateDetailStatistic.totalExpired)),1)])]),e.createElementVNode("div",null,[e.createVNode(y,{placement:"top-start",title:"",width:400,trigger:"hover"},{reference:e.withCtx(()=>s[3]||(s[3]=[e.createElementVNode("span",{style:{color:"#f54319",cursor:"pointer"}},"消费返利订单说明",-1)])),default:e.withCtx(()=>s[4]||(s[4]=[e.createElementVNode("div",{class:"demo-rich-conent",style:{display:"flex",gap:"16px","flex-direction":"column"}},[e.createElementVNode("div",{class:"title"},"消费返利订单说明"),e.createElementVNode("div",null,[e.createElementVNode("p",{class:"demo-rich-content__name",style:{margin:"0","font-weight":"500"}}," 统计开启消费返利期间整个平台（积分订单除外）的所有订单，消费返利以商品为统计粒度计算。 "),e.createElementVNode("h5",{style:{"margin-top":"10px"}},"订单状态"),e.createElementVNode("div",null,"1、已付款：是指支付成功，订单处于待发货或物流配送中"),e.createElementVNode("div",null,"2、已完成：是指商品客户已确认收货未退款或部分退款"),e.createElementVNode("div",null,"3、已关闭：是指订单内商品【退款成功】"),e.createElementVNode("h5",{style:{"margin-top":"10px"}},"结算状态"),e.createElementVNode("div",null,"1、待结算：是指订单未完结(可能退款退货等情况)暂不计入累计返利；"),e.createElementVNode("div",null,"2、已返：是指对应商品没有退款(或退款失败)，返利统计到【累计返利】中"),e.createElementVNode("div",null,"3、已失效：是指对应商品已退款成功，您无法获得对应返利"),e.createElementVNode("h5",{style:{"margin-top":"10px"}},"返利统计维度"),e.createElementVNode("div",null,"1、累计返利：已返的返利之和"),e.createElementVNode("div",null,"2、待结算返利：待结算返利之和"),e.createElementVNode("div",null,"3、已失效返利：已失效返利之和")])],-1)])),_:1})])])}}}),Dt="",G=(a,n)=>{const d=a.__vccOpts||a;for(const[c,s]of n)d[c]=s;return d},je=G(Ae,[["__scopeId","data-v-d5670c0f"]]),ze={class:"fdc1 overh"},$e={class:"tab_container"},Fe={class:"handle_container"},He={class:"header-table"},Ue={class:"orderIndex-table__commodity"},Le={class:"orderIndex-table__img-box"},qe={class:"order-info__name"},Ge={key:1,class:"order-info__name"},Ye={class:"order-info__spec"},Ke={key:3,class:"order-info__spec"},We={class:"orderIndex-table__img-mask"},Xe={style:{"font-size":"12px"}},Qe={style:{color:"#838383","font-size":"10px"}},Je={class:"delivery"},Ze={key:0,style:{color:"#f54319"}},Ie={key:1,style:{color:"#999999"}},Oe={key:2,style:{color:"#00bb2c"}},ve={key:0},et={key:1},tt={key:2},at=e.defineComponent({__name:"rebate-list",props:{searchRetract:{type:Boolean,default:!1},searchForm:{type:Object,default:()=>({})},statistic:{type:Object,default:()=>({})}},emits:["update:searchForm","update:statistic"],setup(a,{emit:n}){const d=["近三个月订单","近一个月订单","全部订单"],c=a,s=n,y=e.computed({get(){return c.searchForm},set(i){s("update:searchForm",i)}}),m=e.computed({get(){return c.statistic},set(i){s("update:statistic",i)}});e.watch(()=>{var i;return(i=c.searchForm)==null?void 0:i.forceSearch},i=>{i&&(y.value.forceSearch=!1,k())});const{divTenThousand:o}=U(),p=e.ref("全部订单"),l=[],x=e.ref(),g=e.ref(!1),r=e.ref([]),_=e.ref(" "),N=e.ref([]),T=e.ref(!1),E=e.ref([]),V=e.ref([]),f=e.ref(""),h=e.reactive({size:20,current:1,total:0}),M=new fe,w=e.reactive({params:{buyerNickname:"",receiverName:"",orderNo:"",productName:"",startTime:"",endTime:""}});k(),ht(),gt();function k(){e.nextTick(()=>{const i={...h,...c.searchForm,forceSearch:void 0,status:_.value.trim()};p.value==="近一个月订单"?i.monthOrders="ONE_MONTH_AGO":p.value==="近三个月订单"&&(i.monthOrders="THREE_MONTHS_AGO"),Ce(i).then(({data:b})=>{const C=b==null?void 0:b.statistic;Object.keys(m.value).forEach(A=>{const F=A;m.value[F]=(C==null?void 0:C[F])||""}),h.current=b.current,h.size=b.size,h.total=b.total,E.value=b.records})})}function ht(){const i={UNPAID:"待付款",PAID:"已付款",COMPLETED:"已完成",CLOSED:"已关闭"};for(const[b,C]of Object.entries(i))l.push({key:b,value:C})}function gt(){const i=l.map(b=>({title:b.value,name:b.key}));i.unshift({title:"全部订单",name:" "}),r.value=i}const O=i=>{p.value=i,yt()};function yt(){if(p.value==="近一个月订单"){const i=M.getLastMonth();v(i)}else if(p.value==="近三个月订单"){const i=M.getLastThreeMonth();v(i)}else w.params.startTime="",w.params.endTime="",k()}const v=async i=>{const b=M.getYMDs();w.params.startTime=i,w.params.endTime=b,k()},xt=async()=>{if(_.value!==" "){w.params.endTime="",w.params.startTime="",k();return}else O(p.value)},ut=()=>{g.value=!g.value,g.value?x.value.handleOpen():x.value.handleClose()},Nt=e.computed(()=>i=>o(i[0].salePrice)),Et=e.computed(()=>i=>i.reduce((b,C)=>C.num+b,0)),Vt=i=>{h.size=i,k()},kt=i=>{h.current=i,k()},Ct=()=>{V.value=[],k()},K=(i,b)=>!!i.find(A=>A.settlementStatus===b);return(i,b)=>{const C=e.resolveComponent("el-icon"),A=e.resolveComponent("el-dropdown-item"),F=e.resolveComponent("el-dropdown-menu"),wt=e.resolveComponent("el-dropdown"),ee=e.resolveComponent("el-tab-pane"),St=e.resolveComponent("el-tabs"),Tt=e.resolveComponent("el-image"),te=e.resolveComponent("el-tooltip");return e.openBlock(),e.createElementBlock("div",ze,[e.createElementVNode("div",$e,[e.createVNode(St,{modelValue:_.value,"onUpdate:modelValue":b[0]||(b[0]=t=>_.value=t),style:{"margin-top":"15px"},onTabChange:xt},{default:e.withCtx(()=>[e.createVNode(ee,{name:" "},{label:e.withCtx(()=>[e.createElementVNode("span",null,e.toDisplayString(p.value),1),e.createVNode(C,{class:"el-icon--right-top"},{default:e.withCtx(()=>[e.createVNode(e.unref(H.ArrowDown))]),_:1}),e.createVNode(wt,{ref_key:"dropdownRef",ref:x,placement:"bottom-end",trigger:"click",onCommand:O},{dropdown:e.withCtx(()=>[e.createVNode(F,null,{default:e.withCtx(()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(d,t=>e.createVNode(A,{key:t,command:t},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t),1)]),_:2},1032,["command"])),64))]),_:1})]),default:e.withCtx(()=>[e.createElementVNode("span",{class:"el-dropdown-link",style:{height:"40px"},onClick:e.withModifiers(ut,["stop"])},[e.createVNode(C,{class:"el-icon--right"},{default:e.withCtx(()=>[e.createVNode(e.unref(H.ArrowDown))]),_:1})])]),_:1},512)]),_:1}),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(l,t=>e.createVNode(ee,{key:t.key,label:t.value,name:t.key},null,8,["label","name"])),64))]),_:1},8,["modelValue"])]),e.createElementVNode("div",Fe,[e.createVNode(je,{"rebate-detail-statistic":a.statistic},null,8,["rebate-detail-statistic"])]),e.createVNode(e.unref(Ee),{checkedItem:V.value,"onUpdate:checkedItem":b[1]||(b[1]=t=>V.value=t),class:e.normalizeClass(["orderIndex-table table_container",{tableUp:!a.searchRetract}]),data:E.value,"no-border":""},{header:e.withCtx(({row:t})=>[e.createElementVNode("div",He,[e.createElementVNode("span",null,"订单号："+e.toDisplayString(t.orderNo),1),e.createElementVNode("span",null,"下单时间："+e.toDisplayString(t.orderTime),1),e.createElementVNode("span",null,"买家："+e.toDisplayString(t.buyerNickname),1),e.createElementVNode("span",null,"店铺："+e.toDisplayString(t.shopName),1),e.createElementVNode("span",{style:e.normalizeStyle({color:e.unref(j)[t.status]==="已关闭"?"#999":e.unref(j)[t.status]==="待付款"?"#F54319":""})},e.toDisplayString(e.unref(j)[t.status]),5)])]),default:e.withCtx(()=>[e.createVNode(P,{prop:"name",label:"商品",width:"400px"},{default:e.withCtx(({shopOrderItems:t})=>{var u,S,D,ae,ne,oe,le,re,de,ce,ie,se;return[e.createElementVNode("div",Ue,[e.createElementVNode("div",Le,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.slice(0,1),B=>(e.openBlock(),e.createBlock(Tt,{key:B.skuId,fits:"cover",style:{width:"68px",height:"68px"},shape:"square",size:"large",src:B.image,title:B.productName},null,8,["src","title"]))),128)),e.createElementVNode("div",{class:"order-info",style:e.normalizeStyle({justifyContent:((S=(u=t==null?void 0:t[0])==null?void 0:u.specs)==null?void 0:S.join("、").length)<1?"center":"space-between"})},[((D=t==null?void 0:t[0])==null?void 0:D.productName.length)>=44?(e.openBlock(),e.createBlock(te,{key:0,effect:"dark",content:(ae=t==null?void 0:t[0])==null?void 0:ae.productName,placement:"top-start"},{default:e.withCtx(()=>{var B;return[e.createElementVNode("p",qe,e.toDisplayString((B=t==null?void 0:t[0])==null?void 0:B.productName),1)]}),_:2},1032,["content"])):(e.openBlock(),e.createElementBlock("p",Ge,e.toDisplayString((ne=t==null?void 0:t[0])==null?void 0:ne.productName),1)),((le=(oe=t==null?void 0:t[0])==null?void 0:oe.specs)==null?void 0:le.join("、").length)>=20?(e.openBlock(),e.createBlock(te,{key:2,effect:"dark",content:(de=(re=t==null?void 0:t[0])==null?void 0:re.specs)==null?void 0:de.join("、"),placement:"top-start"},{default:e.withCtx(()=>{var B,me;return[e.createElementVNode("p",Ye,e.toDisplayString((me=(B=t==null?void 0:t[0])==null?void 0:B.specs)==null?void 0:me.join("、")),1)]}),_:2},1032,["content"])):(e.openBlock(),e.createElementBlock("p",Ke,e.toDisplayString((ie=(ce=t==null?void 0:t[0])==null?void 0:ce.specs)==null?void 0:ie.join("、")),1))],4)]),e.createElementVNode("div",We,[e.createElementVNode("span",Xe,"￥"+e.toDisplayString((se=Nt.value(t))==null?void 0:se.toFixed(2)),1),e.createElementVNode("span",Qe,"x"+e.toDisplayString(Et.value(t)),1)])])]}),_:1}),e.createVNode(P,{prop:"age",label:"实付款(元)",width:"130",align:"left"},{default:e.withCtx(({row:t})=>[e.createTextVNode(e.toDisplayString(t.rebateOrderItems.reduce((u,S)=>u.plus(e.unref(o)(+S.dealPrice*S.num)),new(e.unref(X))(0)).toFixed(2)),1)]),_:1}),e.createVNode(P,{prop:"age",label:"平台服务费(元)",width:"110",align:"left"},{default:e.withCtx(({shopOrderItems:t})=>{var u;return[e.createTextVNode(e.toDisplayString(e.unref(o)((u=t==null?void 0:t[0])==null?void 0:u.platformServiceFee)),1)]}),_:1}),e.createVNode(P,{prop:"deliveryStatus",label:"结算状态",width:"100",align:"left"},{default:e.withCtx(({shopOrderItems:t})=>{var u,S,D;return[e.createElementVNode("div",Je,[((u=t==null?void 0:t[0])==null?void 0:u.settlementStatus)==="PENDING_SETTLEMENT"?(e.openBlock(),e.createElementBlock("span",Ze,"待结算")):((S=t==null?void 0:t[0])==null?void 0:S.settlementStatus)==="EXPIRED"?(e.openBlock(),e.createElementBlock("span",Ie,"已失效")):((D=t==null?void 0:t[0])==null?void 0:D.settlementStatus)==="SETTLED"?(e.openBlock(),e.createElementBlock("span",Oe,"已返")):e.createCommentVNode("",!0)])]}),_:1}),e.createVNode(P,{prop:"orderStatus",label:"预计返利(元)",width:"140",align:"left"},{default:e.withCtx(({shopOrderItems:t})=>{var u;return[e.createTextVNode(e.toDisplayString((u=t==null?void 0:t[0])==null?void 0:u.rebateCalculation.split("=")[1]),1)]}),_:1}),e.createVNode(P,{prop:"sex",label:"佣金结算(元)",width:"120","is-mixed":!0,align:"left"},{default:e.withCtx(({row:t,shopOrderItems:u})=>[e.createElementVNode("div",null,[e.createElementVNode("div",null," 返利合计："+e.toDisplayString(t.rebateOrderItems.reduce((S,D)=>S.plus(e.unref(o)(+D.estimatedRebate)),new(e.unref(X))(0))),1),K(u,"PENDING_SETTLEMENT")?(e.openBlock(),e.createElementBlock("div",ve,"待结算："+e.toDisplayString(e.unref(o)(t==null?void 0:t.pendingSettlement)),1)):e.createCommentVNode("",!0),K(u,"SETTLED")?(e.openBlock(),e.createElementBlock("div",et,"已返："+e.toDisplayString(e.unref(o)(t==null?void 0:t.settled)),1)):e.createCommentVNode("",!0),K(u,"EXPIRED")?(e.openBlock(),e.createElementBlock("div",tt,"已失效："+e.toDisplayString(e.unref(o)(t==null?void 0:t.expired)),1)):e.createCommentVNode("",!0)])]),_:1})]),_:1},8,["checkedItem","class","data"]),e.createVNode(pe,{"page-size":h.size,"page-num":h.current,total:h.total,onReload:k,onHandleSizeChange:Vt,onHandleCurrentChange:kt},null,8,["page-size","page-num","total"]),e.createVNode(_e,{isShow:T.value,"onUpdate:isShow":b[2]||(b[2]=t=>T.value=t),ids:N.value,"onUpdate:ids":b[3]||(b[3]=t=>N.value=t),remark:f.value,"onUpdate:remark":b[4]||(b[4]=t=>f.value=t),"remark-type":"GOODS",onSuccess:Ct},null,8,["isShow","ids","remark"])])}}}),Pt="",Rt="",nt=G(at,[["__scopeId","data-v-bbbdea2b"]]),ot=Object.freeze(Object.defineProperty({__proto__:null,default:e.defineComponent({__name:"rebate-order",setup(a){const n=e.ref(!1),d=e.reactive({orderNo:"",productName:"",shopName:"",buyerNickname:"",orderCreateTime:"",orderEndTime:"",forceSearch:!1}),c=y=>{Object.keys(d).forEach(m=>{const o=m;d[o]=y[o]}),d.forceSearch=!0},s=e.reactive({totalExpired:"",totalPendingSettlement:"",totalRebate:""});return(y,m)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(ye,{onShowChange:m[0]||(m[0]=o=>n.value=o),onGetSearchParams:c}),e.createVNode(nt,{"search-form":d,"onUpdate:searchForm":m[1]||(m[1]=o=>d=o),statistic:s,"onUpdate:statistic":m[2]||(m[2]=o=>s=o),"search-retract":n.value},null,8,["search-form","statistic","search-retract"])],64))}})},Symbol.toStringTag,{value:"Module"}));var Y=(a=>(a.PAID_MEMBER="PAID_MEMBER",a.ALL_MEMBERS="ALL_MEMBERS",a))(Y||{}),J;(a=>{(n=>{n.REDUCE="REDUCE",n.INCREASE="INCREASE"})(a.CHANGE_TYPE||(a.CHANGE_TYPE={})),(n=>{n.INCOME="INCOME",n.EXPENDITURE="EXPENDITURE",n.REFUND="REFUND",n.WITHDRAW="WITHDRAW"})(a.REBATE_TYPE||(a.REBATE_TYPE={}))})(J||(J={}));const{mulHundred:z,divHundred:$,mulTenThousand:Z,divTenThousand:I}=U(),lt=()=>{const a=e.ref([]),n=e.ref([]),d=e.reactive({id:"",rebateStatus:!1,rebateUsers:"PAID_MEMBER"}),c=async()=>{const m=await Ve();if(m.code!==200)return L.ElMessage.error(m.msg||"获取设置失败");const o=m.data;d.id=(o==null?void 0:o.id)||"",d.rebateStatus=(o==null?void 0:o.rebateStatus)||!1,d.rebateUsers=o.rebateUsers||"PAID_MEMBER",a.value=rt(o),n.value=dt(o)};return{currentMemberRebates:e.computed(()=>d.rebateUsers==="PAID_MEMBER"?a.value:n.value),initialRebates:c,baseRebateConfig:d,onSubmit:async()=>{var x;const m={...d,payRebateUsers:(x=a.value)==null?void 0:x.map(g=>({...g,rebatePaymentPercentage:z(g.rebatePaymentPercentage).toString(),rebatePercentage:z(g.rebatePercentage).toString(),withdrawalThreshold:Z(g.withdrawalThreshold).toString()})),allRebateUsers:n.value.map(g=>({...g,rebatePaymentPercentage:z(g.rebatePaymentPercentage).toString(),rebatePercentage:z(g.rebatePercentage).toString(),withdrawalThreshold:Z(g.withdrawalThreshold).toString()}))},{code:o,data:p,msg:l}=await ke(m);o===200?(L.ElMessage.success(l||"修改成功"),c()):L.ElMessage.error(l||"修改失败")}}},rt=a=>(a.payRebateUsers.forEach(n=>{n.rebatePaymentPercentage=$(n.rebatePaymentPercentage).toNumber(),n.rebatePercentage=$(n.rebatePercentage).toNumber(),n.withdrawalThreshold=I(n.withdrawalThreshold).toNumber()}),a.payRebateUsers),dt=a=>(a.allRebateUsers.forEach(n=>{n.rebatePaymentPercentage=$(n.rebatePaymentPercentage).toNumber(),n.rebatePercentage=$(n.rebatePercentage).toNumber(),n.withdrawalThreshold=I(n.withdrawalThreshold).toNumber()}),a.allRebateUsers),ct={style:{width:"100%",height:"calc(100vh - 200px)","overflow-y":"auto"}},it={style:{display:"flex","justify-content":"space-between","align-items":"center",width:"80%"}},st={style:{padding:"0 16px"}},mt={class:"name",style:{color:"#ce732f"}},bt={class:"name"},pt={class:"submit"},ft=e.defineComponent({__name:"rebate-set",setup(a){const{currentMemberRebates:n,initialRebates:d,baseRebateConfig:c,onSubmit:s}=lt(),y=e.reactive({rebateStatus:[{required:!0,message:"",trigger:"blur"}],rebateUsers:[{required:!0,message:"",trigger:"blur"}]});return e.onMounted(()=>d()),(m,o)=>{const p=e.resolveComponent("el-radio"),l=e.resolveComponent("el-icon"),x=e.resolveComponent("el-popover"),g=e.resolveComponent("el-radio-group"),r=e.resolveComponent("el-form-item"),_=e.resolveComponent("el-table-column"),N=e.resolveComponent("el-input-number"),T=e.resolveComponent("el-table"),E=e.resolveComponent("el-form"),V=e.resolveComponent("el-button");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ct,[e.createVNode(E,{model:e.unref(c),"label-width":"90",style:{position:"relative","padding-top":"30px"},rules:y},{default:e.withCtx(()=>[e.createVNode(r,{label:"消费返利",prop:"rebateStatus"},{default:e.withCtx(()=>[e.createVNode(g,{modelValue:e.unref(c).rebateStatus,"onUpdate:modelValue":o[0]||(o[0]=f=>e.unref(c).rebateStatus=f)},{default:e.withCtx(()=>[e.createVNode(p,{value:!0},{default:e.withCtx(()=>o[2]||(o[2]=[e.createTextVNode("开启")])),_:1}),e.createVNode(p,{value:!1},{default:e.withCtx(()=>[o[4]||(o[4]=e.createTextVNode("关闭")),e.createVNode(x,{width:400,placement:"top-start",title:"",trigger:"hover"},{reference:e.withCtx(()=>[e.createVNode(l,{style:{color:"#ccc",position:"relative",top:"3px",left:"5px","font-size":"16px"}},{default:e.withCtx(()=>[e.createVNode(e.unref(H.QuestionFilled))]),_:1})]),default:e.withCtx(()=>o[3]||(o[3]=[e.createElementVNode("div",{class:"demo-rich-conent",style:{display:"flex",gap:"16px","flex-direction":"column"}},[e.createElementVNode("div",{class:"title"},"消费返利说明"),e.createElementVNode("div",null,[e.createElementVNode("p",{class:"demo-rich-content__name",style:{margin:"0","font-weight":"500"}}," 消费返利属于平台层级的营销活动，通过该营销工具可促进付费会员的购买及续费，同时还可提高用户粘性将用户未来的交易固定在本平台发生的营销神器。平台从各店铺交易获得的【平台服务费】拿出小部分用于消费返利的资金支出(订单完成后才返利)，系统可实现不同会员等级获得不同的返利权益支持您的灵活营销。 "),e.createElementVNode("div",{style:{"text-indent":"1em"}}," 1、返利百分比：是指将平台收到的平台服务费的百分之几用于消费返利，消费返利是以商品为粒度计算的。商品返利金额 = 该商品实收平台服务费 * 商品数 * 返利百分比 "),e.createElementVNode("div",{style:{"text-indent":"1em"}}," 例1: 商品 A 销售价 100 提佣10% 返利百分比80% ， 如用户购买1个商品A可获得返利金额为： (100 *10%) * 1 * 80% = 8 "),e.createElementVNode("div",{style:{"text-indent":"1em"}}," 2、返利支付百分比：用户在使用消费返利余额支付占订单实付金额的百分之几，百分比越大则其实付现金越小 "),e.createElementVNode("div",{style:{"text-indent":"1em"}}," 例2: 商品 A 销售价 100 返利支付百分比80% ， 如用户购买1个商品A 可通过消费余额支付： (100 *80%) * 1 = 80 即其只需支付现金 20 元 即可购买到该商品。 其中实付现金20元计算出来的平台服务费，参与重复返利：（20*10%）*1 *80% = 1.6 "),e.createElementVNode("div",{style:{"text-indent":"1em"}}," 3、重复返利：使用消费返利支付购买商品，也可获得消费返利。重复返利需按【实收现金】计算即需剔除消费返利支付的金额、各项优惠金额 ，可参考例2辅助理解 "),e.createElementVNode("div",{style:{"text-indent":"1em"}}," 4、提现门槛：是指消费返利余额需大于该金额才能提现，可提现金额 = 消费返利余额 - 提现门槛，未达到提现门槛时虽不能提现但可用于购买平台上的商品。 "),e.createElementVNode("div",{style:{"text-indent":"1em"}},"5、积分商品：消费返利支付不能购买积分商品，购买积分也无法获得消费返利")])],-1)])),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.unref(c).rebateStatus?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(r,{label:"返利用户",prop:"rebateUsers"},{default:e.withCtx(()=>[e.createElementVNode("div",it,[e.createVNode(g,{modelValue:e.unref(c).rebateUsers,"onUpdate:modelValue":o[1]||(o[1]=f=>e.unref(c).rebateUsers=f)},{default:e.withCtx(()=>[e.createVNode(p,{value:e.unref(Y).PAID_MEMBER},{default:e.withCtx(()=>o[5]||(o[5]=[e.createTextVNode("付费会员")])),_:1},8,["value"]),e.createVNode(p,{value:e.unref(Y).ALL_MEMBERS},{default:e.withCtx(()=>o[6]||(o[6]=[e.createTextVNode("所有会员（含免费会员）")])),_:1},8,["value"])]),_:1},8,["modelValue"])])]),_:1}),e.createElementVNode("div",st,[e.createVNode(T,{"cell-style":{fontSize:"12px",color:"#333333"},data:e.unref(n),"header-cell-style":{background:"#f6f8fa"},"header-row-style":{fontSize:"14px",color:"#333"},"max-height":"calc(100vh - 350px)"},{default:e.withCtx(()=>[e.createVNode(_,{label:"等级",width:"140"},{default:e.withCtx(({row:f})=>[e.createElementVNode("div",mt,e.toDisplayString((f.memberType==="PAID_MEMBER"?"SVIP":"vip")+f.rankCode),1)]),_:1}),e.createVNode(_,{label:"会员名称",width:"200"},{default:e.withCtx(({row:f})=>[e.createElementVNode("div",bt,e.toDisplayString(f.memberName),1)]),_:1}),e.createVNode(_,{label:"返利百分比(0~100%)"},{default:e.withCtx(({row:f})=>[e.createVNode(N,{modelValue:f.rebatePercentage,"onUpdate:modelValue":h=>f.rebatePercentage=h,controls:!1,max:100,min:0,precision:2},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e.createVNode(_,{label:"返利支付百分比(0~90%)"},{default:e.withCtx(({row:f})=>[e.createVNode(N,{modelValue:f.rebatePaymentPercentage,"onUpdate:modelValue":h=>f.rebatePaymentPercentage=h,controls:!1,max:90,min:0,precision:2},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e.createVNode(_,{label:"提现门槛"},{default:e.withCtx(({row:f})=>[e.createVNode(N,{modelValue:f.withdrawalThreshold,"onUpdate:modelValue":h=>f.withdrawalThreshold=h,precision:2,min:0,max:1e5,controls:!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])])],64)):e.createCommentVNode("",!0)]),_:1},8,["model","rules"])]),e.createElementVNode("div",pt,[e.createVNode(V,{type:"primary",onClick:e.unref(s)},{default:e.withCtx(()=>o[7]||(o[7]=[e.createTextVNode("保存")])),_:1},8,["onClick"])])],64)}}}),jt="",_t=Object.freeze(Object.defineProperty({__proto__:null,default:G(ft,[["__scopeId","data-v-bdb77e7e"]])},Symbol.toStringTag,{value:"Module"}));return ge});

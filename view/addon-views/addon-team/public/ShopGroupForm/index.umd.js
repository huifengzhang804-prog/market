(function(e,D){typeof exports=="object"&&typeof module<"u"?module.exports=D(require("vue"),require("@/components/q-choose-goods-popup/q-choose-goods-popup.vue"),require("element-plus"),require("@/composables/useConvert"),require("@/utils/date"),require("@/utils/http"),require("decimal.js"),require("@/apis/good"),require("vue-router"),require("lodash-es"),require("@/components/QSafeBtn/QSafeBtn.vue")):typeof define=="function"&&define.amd?define(["vue","@/components/q-choose-goods-popup/q-choose-goods-popup.vue","element-plus","@/composables/useConvert","@/utils/date","@/utils/http","decimal.js","@/apis/good","vue-router","lodash-es","@/components/QSafeBtn/QSafeBtn.vue"],D):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopGroupForm=D(e.ShopGroupFormContext.Vue,e.ShopGroupFormContext.QChooseGoodsPopup,e.ShopGroupFormContext.ElementPlus,e.ShopGroupFormContext.UseConvert,e.ShopGroupFormContext.DateUtil,e.ShopGroupFormContext.UtilsHttp,e.ShopGroupFormContext.Decimal,e.ShopGroupFormContext.GoodAPI,e.ShopGroupFormContext.VueRouter,e.ShopGroupFormContext.Lodash,e.ShopGroupFormContext.QSafeBtn))})(this,function(e,D,N,X,Z,H,he,v,J,ee,te){"use strict";var K=document.createElement("style");K.textContent=`@charset "UTF-8";.com[data-v-3f7e4e07]{display:flex;justify-content:center;align-items:center}.com__pic[data-v-3f7e4e07]{width:62px;height:62px}.com__name[data-v-3f7e4e07]{width:113px;font-size:14px;color:#333;margin-left:10px;display:flex;flex-direction:column;align-items:baseline}.com__name--text[data-v-3f7e4e07]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.flex[data-v-3f7e4e07]{display:flex;justify-content:space-between;align-items:center}.groupForm[data-v-d44f441d]{overflow-y:auto;padding:16px}.groupForm__title[data-v-d44f441d]{font-size:14px;color:#323233;font-weight:700;margin-bottom:30px;text-align:center}.groupForm__stairs[data-v-d44f441d]{margin-bottom:16px}.groupForm__stairs--title[data-v-d44f441d]{font-size:12px;color:#333;font-weight:700}.groupForm__stairs--input[data-v-d44f441d]{margin:0 7px}.groupForm__btn[data-v-d44f441d]{height:60px;display:flex;justify-content:center;align-items:center}.tips[data-v-d44f441d]{font-size:12px;color:#c4c4c4}.btns[data-v-d44f441d]{margin-top:auto;width:100%;padding:15px 0;box-shadow:0 0 10px #d5d5d5;background-color:#fff}
`,document.head.appendChild(K);const oe={class:"com"},le={class:"com__name"},re={class:"com__name--text",style:{"margin-top":"5px"}},ae={class:"flex"},se={key:0},ne={class:"dialog-footer"},de=e.defineComponent({__name:"select-good-table",props:{mode:{type:String,default:"COMMON"},users:{type:Array,default(){return[]}},productList:{type:Array,default(){return[]}},isEdit:{type:Boolean,default:!1},flatGoodList:{type:Array,default(){return[]}}},setup(C,{expose:l}){const i=C,{divTenThousand:h,mulTenThousand:T}=X(),V=e.ref([]);e.watch(()=>i.productList,o=>{const a=G(o);if((a==null?void 0:a.length)===0)return N.ElMessage.error("请至少选择一个存在库存的商品");V.value=B(a)},{deep:!0}),e.watch(()=>i.flatGoodList,o=>{V.value=B(o)});function w(o){return o.skuItem.stockType==="LIMITED"?Number(o.skuItem.skuStock):1e5}function g(o){return h(o.skuItem.skuPrice).toNumber()}function G(o,a){if(!o.length)return[];const u=[];return o.forEach(d=>{d.skuIds.forEach((m,n)=>{(d.stocks[n]>0&&d.stockTypes[n]==="LIMITED"||d.stockTypes[n]==="UNLIMITED")&&u.push({productId:d.productId,productName:d.productName,productPic:d.pic,skuItem:{productId:d.productId,skuId:m,skuName:d.specs[n]?d.specs[n]:"",skuPrice:d.salePrices[n],skuStock:d.stocks[n]?d.stocks[n]:"",stockType:d.stockTypes[n]},rowTag:0,stock:+d.stocks[n],prices:[d.salePrices[n]],isJoin:d.stocks[n]>0})})}),u}function B(o,a){let u=0,d=o.length;for(let m=0;m<d;m++){const n=o[m];m===0&&(n.rowTag=1,u=0),m!==0&&(n.productId===o[m-1].productId?(n.rowTag=0,o[u].rowTag=o[u].rowTag+1):(n.rowTag=1,u=m)),n.prices=n.prices.map(x=>+x),n.stock=+n.stock}return o}const L=({row:o,column:a,rowIndex:u,columnIndex:d})=>{if(d===0)return{rowspan:o.rowTag,colspan:o.rowTag?1:0}};function q(o){return o.stockType==="UNLIMITED"?"无限库存":`${"库存"+o.skuStock||0}`}function M(){const o=e.toRaw(V.value),a=[],u=new Map;if(o.length)for(let d=0;d<o.length;d++){if(!o[d].isJoin)continue;const m=o[d],n=m.productId,x={skuId:m.skuItem.skuId,stock:+m.stock,prices:m.prices.map(S=>T(S).toNumber())};if(!u.has(n))u.set(n,a.length),a.push({productId:n,skus:[x]});else{const S=u.get(n);a[S].skus.push(x)}}return a}function A(){let o=!0;const a=V.value;if(!a.length)N.ElMessage.warning("请选择商品"),o=!1;else for(let u=0;u<a.length;u++)if(a[u].isJoin){if(!a[u].stock){N.ElMessage.warning("商品库存必须大于零"),o=!1;break}if(a[u].prices.length!==i.users.length||a[u].prices.some(d=>d===null)){N.ElMessage.warning("拼团价格填写完整"),o=!1;break}}return o}const f=e.ref({stock:1,price:[.01]}),E=e.ref(!1),O=e.ref("0"),R=o=>{O.value=o.productId,f.value.stock=o.skuItem.skuStock,E.value=!0},j=()=>{f.value={stock:1,price:[.01]},E.value=!1},$=()=>{i.mode==="COMMON"?V.value.forEach(o=>{o.productId===O.value&&(o.stock=f.value.stock>w(o)?w(o):f.value.stock,o.prices[0]=f.value.price[0]>g(o)?g(o):f.value.price[0])}):V.value.forEach(o=>{if(o.productId===O.value){o.stock=f.value.stock>w(o)?w(o):f.value.stock;for(let a=0;a<i.users.length;a++)o.prices[a]=f.value.price[a]>g(o)?g(o):f.value.price[a]}}),E.value=!1},Q=(o,a)=>typeof o=="string"?o:o.length===1?o[0]:o[a];return l({getProduct:M,validateProduct:A}),(o,a)=>{const u=e.resolveComponent("el-image"),d=e.resolveComponent("el-button"),m=e.resolveComponent("el-table-column"),n=e.resolveComponent("el-input-number"),x=e.resolveComponent("el-input"),S=e.resolveComponent("el-table"),Y=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(S,{data:V.value,"span-method":L},{default:e.withCtx(()=>[e.createVNode(m,{label:"商品信息",width:"215"},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",oe,[e.createVNode(u,{src:s.productPic,class:"com__pic"},null,8,["src"]),e.createElementVNode("div",le,[i.isEdit?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(d,{key:0,class:"com__batch",type:"primary",link:"",onClick:r=>R(s)},{default:e.withCtx(()=>a[4]||(a[4]=[e.createTextVNode(" 批量设置 ")])),_:2},1032,["onClick"])),e.createElementVNode("span",re,e.toDisplayString(s.productName),1)])])]),_:1}),e.createVNode(m,{label:"规格"},{default:e.withCtx(({row:s,$index:r})=>[e.createTextVNode(e.toDisplayString(Q(s.skuItem.skuName,r)),1)]),_:1}),e.createVNode(m,{label:"库存"},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",null,[e.createVNode(n,{modelValue:s.stock,"onUpdate:modelValue":r=>s.stock=r,min:0,style:{width:"80px"},max:w(s),disabled:i.isEdit,precision:0,controls:!1},null,8,["modelValue","onUpdate:modelValue","max","disabled"])]),e.createElementVNode("div",null,e.toDisplayString(q(s.skuItem)),1)]),_:1}),i.mode==="COMMON"?(e.openBlock(),e.createBlock(m,{key:0,label:"拼团价"},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",null,[i.isEdit?(e.openBlock(),e.createBlock(x,{key:0,style:{width:"80px"},disabled:"",placeholder:e.unref(h)(s.prices[0]).toString()},null,8,["placeholder"])):(e.openBlock(),e.createBlock(n,{key:1,modelValue:s.prices[0],"onUpdate:modelValue":r=>s.prices[0]=r,min:.01,style:{width:"80px"},disabled:i.isEdit,precision:2,max:g(s),controls:!1},null,8,["modelValue","onUpdate:modelValue","disabled","max"]))]),e.createElementVNode("div",null,"销售价"+e.toDisplayString(e.unref(h)(s.skuItem.skuPrice)),1)]),_:1})):e.createCommentVNode("",!0),i.mode==="STAIRS"&&i.users.length>0?(e.openBlock(),e.createBlock(m,{key:1,label:"第一阶段拼团"},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",null,[i.isEdit?(e.openBlock(),e.createBlock(x,{key:0,style:{width:"80px"},disabled:"",placeholder:e.unref(h)(s.prices[0]).toString()},null,8,["placeholder"])):(e.openBlock(),e.createBlock(n,{key:1,modelValue:s.prices[0],"onUpdate:modelValue":r=>s.prices[0]=r,min:.01,style:{width:"80px"},disabled:i.isEdit,precision:2,max:g(s),controls:!1},null,8,["modelValue","onUpdate:modelValue","disabled","max"]))]),e.createElementVNode("div",null,"销售价"+e.toDisplayString(e.unref(h)(s.skuItem.skuPrice)),1)]),_:1})):e.createCommentVNode("",!0),i.mode==="STAIRS"&&i.users.length>1?(e.openBlock(),e.createBlock(m,{key:2,label:"第二阶段拼团"},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",null,[i.isEdit?(e.openBlock(),e.createBlock(x,{key:0,style:{width:"80px"},disabled:"",placeholder:e.unref(h)(s.prices[1]).toString()},null,8,["placeholder"])):(e.openBlock(),e.createBlock(n,{key:1,modelValue:s.prices[1],"onUpdate:modelValue":r=>s.prices[1]=r,disabled:i.isEdit,min:.01,style:{width:"80px"},max:g(s),precision:2,controls:!1},null,8,["modelValue","onUpdate:modelValue","disabled","max"]))]),e.createElementVNode("div",null,"销售价"+e.toDisplayString(g(s)),1)]),_:1})):e.createCommentVNode("",!0),i.mode==="STAIRS"&&i.users.length>2?(e.openBlock(),e.createBlock(m,{key:3,label:"第三阶段拼团"},{default:e.withCtx(({row:s})=>[e.createElementVNode("div",null,[i.isEdit?(e.openBlock(),e.createBlock(x,{key:0,style:{width:"80px"},disabled:"",placeholder:e.unref(h)(s.prices[2]).toString()},null,8,["placeholder"])):(e.openBlock(),e.createBlock(n,{key:1,modelValue:s.prices[2],"onUpdate:modelValue":r=>s.prices[2]=r,disabled:i.isEdit,min:.01,style:{width:"80px"},precision:2,max:g(s),controls:!1},null,8,["modelValue","onUpdate:modelValue","disabled","max"]))]),e.createElementVNode("div",null,"销售价"+e.toDisplayString(g(s)),1)]),_:1})):e.createCommentVNode("",!0)]),_:1},8,["data"]),e.createVNode(Y,{modelValue:E.value,"onUpdate:modelValue":a[3]||(a[3]=s=>E.value=s),title:"批量设置","destroy-on-close":"",center:"",width:i.mode==="COMMON"?500:"50%",top:"30vh",onClose:j},{footer:e.withCtx(()=>[e.createElementVNode("div",ne,[e.createVNode(d,{onClick:a[2]||(a[2]=s=>E.value=!1)},{default:e.withCtx(()=>a[7]||(a[7]=[e.createTextVNode("取消")])),_:1}),e.createVNode(d,{type:"primary",onClick:$},{default:e.withCtx(()=>a[8]||(a[8]=[e.createTextVNode(" 确定 ")])),_:1})])]),default:e.withCtx(()=>[e.createElementVNode("div",ae,[e.createElementVNode("div",null,[a[5]||(a[5]=e.createTextVNode(" 库存 ")),e.createVNode(n,{modelValue:f.value.stock,"onUpdate:modelValue":a[0]||(a[0]=s=>f.value.stock=s),controls:!1,style:e.normalizeStyle({width:i.mode==="COMMON"?"150px":"80px"}),min:0,precision:0},null,8,["modelValue","style"])]),i.mode==="COMMON"?(e.openBlock(),e.createElementBlock("div",se,[a[6]||(a[6]=e.createTextVNode(" 拼团价 ")),e.createVNode(n,{modelValue:f.value.price[0],"onUpdate:modelValue":a[1]||(a[1]=s=>f.value.price[0]=s),precision:2,controls:!1,min:.01},null,8,["modelValue"])])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(i.users,(s,r)=>(e.openBlock(),e.createElementBlock("div",{key:r},[e.createTextVNode(" 第"+e.toDisplayString(r+1)+"阶段拼团 ",1),e.createVNode(n,{modelValue:f.value.price[r],"onUpdate:modelValue":t=>f.value.price[r]=t,style:{width:"80px"},precision:2,controls:!1,min:.01},null,8,["modelValue","onUpdate:modelValue"])]))),128))])]),_:1},8,["modelValue","width"])],64)}}}),xe="",W=(C,l)=>{const i=C.__vccOpts||C;for(const[h,T]of l)i[h]=T;return i},ie=W(de,[["__scopeId","data-v-3f7e4e07"]]),ce=C=>H.http.post({url:"addon-team/team/activity",data:C}),pe=C=>H.http.get({url:`addon-team/team/activity/${C}`}),me={class:"groupForm"},ue={class:"groupForm__title"},fe={key:1},ke={class:"groupForm__stairs--title"},Ve={class:"groupForm__btn btns"},ge=e.defineComponent({__name:"ShopGroupForm",setup(C){const l=e.ref({name:"",startTime:"",endTime:"",effectTimeout:0,mode:"COMMON",users:[],payTimeout:0,simulate:!1,huddle:!0,stackable:{vip:!1,coupon:!1,full:!1},products:[]}),i=J.useRoute(),h=J.useRouter(),T=!!i.query.id&&!!i.query.isLookUp,V=new Z,w=e.ref(),g=e.ref([]),G=e.ref(!1),B=e.ref([]),L=e.ref([]),q=e.ref(),M=e.reactive({maxPrice:"",minPrice:"",activity:{endTime:"",startTime:""},keyword:"",categoryFirstId:""}),A=e.reactive({name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:1,max:10,message:"活动名称字数为1-10",trigger:"blur"}],startTime:[{required:!0,message:"请选择日期"},{trigger:"blur",validator:n}],endTime:[{required:!0,message:"请选择日期"},{trigger:"blur",validator:n}],effectTimeout:[{required:!0,message:"拼团有效时间必须大于等于15分钟"},{validator:u,trigger:"blur"}],mode:[{required:!0,message:"请选择拼团模式",trigger:"blur"}],users:[{validator:a,trigger:"blur"}],payTimeout:[{validator:d,trigger:"blur"}],simulate:[{required:!0,message:"请选择是否模拟成团",trigger:"blur"}],huddle:[{required:!0,message:"请选择是否凑团",trigger:"blur"}],preheat:[{required:!0,message:"请选择是否预热",trigger:"blur"}]});x();const f=()=>{l.value.users.length<3?l.value.users.push(0):N.ElMessage.warning("最多添加三个梯队")},E=()=>{l.value.users.pop()},O=r=>{B.value=ee.cloneDeep(r.tempGoods)},R=()=>{var r;l.value.effectTimeout=+l.value.effectTimeout>=1440?1440:l.value.effectTimeout,console.log("测试新增"),(r=w.value)==null||r.validate(async t=>{if(t&&q.value.validateProduct()){l.value.products=q.value.getProduct();const{code:p,msg:k}=await ce(l.value);p===200?(N.ElMessage.success("创建成功"),$()):N.ElMessage.error(k||"创建失败")}})},j=r=>{r[0].getTime()>=r[1].getTime()&&N.ElMessage.warning("结束时间大于开始时间"),l.value.startTime=V.getYMDHMSs(r[0]),l.value.endTime=V.getYMDHMSs(r[1]),M.activity.startTime=V.getYMDHMSs(r[0]),M.activity.endTime=V.getYMDHMSs(r[1])},$=()=>{h.push({name:"marketingAppGroup",query:{flag:!0}})},Q=r=>{r==="COMMON"&&(l.value.users=[l.value.users[0]])},o=()=>{if(!l.value.endTime||!l.value.startTime){N.ElMessage.warning("请先选择时间段");return}G.value=!0};function a(r,t,p){l.value.mode==="COMMON"&&(l.value.users.length&&l.value.users[0]>=2?p():p(new Error("参团人数应大于等于两人"))),l.value.mode==="STAIRS"&&(l.value.users.length?(l.value.users.find(I=>I<2)&&p(new Error("阶梯团人数最低为2人")),m(l.value.users)||p(new Error("阶梯团人数应为递增人数")),p()):p(new Error("请至少添加一项阶梯团人数")))}function u(r,t,p){t>=15?p():p(new Error("拼团有效时间必须大于等于15分钟"))}function d(r,t,p){t>=3&&t<=369?p():p(new Error("订单关闭时间3-360分钟"))}function m(r){return r.every((p,k)=>k===0?!0:+p>+r[k-1])}function n(r,t,p){new Date(l.value.startTime).getTime()>=new Date(l.value.endTime).getTime()?p(new Error("开始时间应小于结束时间")):p()}async function x(){const r=i.query.id;if(r){const{data:t}=await pe(r);l.value=t,l.value.payTimeout=+t.payTimeout,g.value=[t.startTime,t.endTime],S(t)}}async function S(r){const t=r.products.map(b=>b.productId),{code:p,data:k}=await v.doGetRetrieveProduct({productId:t});if(p!==200)return N.ElMessage.error("获取活动商品信息失败");let I=[];r.products.forEach(b=>{const y=k.list.find(_=>_.productId===b.productId);y&&(I=[...I,...b.skus.map((_,F)=>({productName:y.productName,productPic:y.pic,productId:y.productId,skuItem:{productId:y.productId,skuId:_.skuId,skuName:y.specs[F],skuPrice:y.salePrices[F],skuStock:y.stocks[F],stockType:y.stockTypes[F]},rowTag:0,stock:_.stock,prices:_.prices,isJoin:!0}))])}),L.value=I}function Y(r){const t=V.getYMD(new Date),p=V.getYMD(r);return t===p?!1:new Date().getTime()>r.getTime()}const s=r=>{const t=Number(`${r}`.replace(/[^\d]/g,""));return t<1440?t:1440};return(r,t)=>{const p=e.resolveComponent("el-input"),k=e.resolveComponent("el-form-item"),I=e.resolveComponent("el-date-picker"),b=e.resolveComponent("el-radio"),y=e.resolveComponent("el-radio-group"),_=e.resolveComponent("el-button"),F=e.resolveComponent("el-input-number"),z=e.resolveComponent("el-checkbox"),ye=e.resolveComponent("el-form");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",me,[e.createElementVNode("div",ue,e.toDisplayString(e.unref(T)?"基本信息":"新增拼团"),1),e.createVNode(ye,{ref_key:"ruleFormRef",ref:w,model:l.value,"label-width":"110","label-position":"right",rules:A,disabled:e.unref(T)},{default:e.withCtx(()=>[e.createVNode(k,{label:"活动名称",prop:"name"},{default:e.withCtx(()=>[e.createVNode(p,{modelValue:l.value.name,"onUpdate:modelValue":t[0]||(t[0]=c=>l.value.name=c),placeholder:"限10字",style:{width:"550px"},maxlength:"10"},null,8,["modelValue"])]),_:1}),e.createVNode(k,{label:"活动时间",prop:"startTime"},{default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(I,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=c=>g.value=c),style:{width:"550px"},type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间","disabled-date":Y,onChange:j},null,8,["modelValue"])])]),_:1}),e.createVNode(k,{label:"拼团有效期",prop:"effectTimeout",required:""},{default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(p,{modelValue:l.value.effectTimeout,"onUpdate:modelValue":t[2]||(t[2]=c=>l.value.effectTimeout=c),formatter:c=>s(c),style:{width:"550px"}},{append:e.withCtx(()=>t[12]||(t[12]=[e.createTextVNode(" 分钟 ")])),_:1},8,["modelValue","formatter"]),t[13]||(t[13]=e.createElementVNode("p",{class:"tips"},"用户发起拼团后开始计时，需在设置时间内邀请到规定好友人数参团，超过时效时间，则系统判定拼团失败，自动发起退款",-1))])]),_:1}),e.createVNode(k,{label:"拼团模式",prop:"mode"},{default:e.withCtx(()=>[e.createVNode(y,{modelValue:l.value.mode,"onUpdate:modelValue":t[3]||(t[3]=c=>l.value.mode=c),onChange:Q},{default:e.withCtx(()=>[e.createVNode(b,{value:"COMMON"},{default:e.withCtx(()=>t[14]||(t[14]=[e.createTextVNode("普通拼团")])),_:1}),e.createVNode(b,{value:"STAIRS"},{default:e.withCtx(()=>t[15]||(t[15]=[e.createTextVNode("阶梯拼团")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createVNode(k,{label:"参团人数",prop:"users",required:""},{default:e.withCtx(()=>[l.value.mode==="COMMON"?(e.openBlock(),e.createBlock(p,{key:0,modelValue:l.value.users[0],"onUpdate:modelValue":t[4]||(t[4]=c=>l.value.users[0]=c),formatter:c=>Number(`${c}`.replace(/[^\d]/g,"")),parser:c=>`${Number(c)>=100?100:c}`,style:{width:"550px"},max:100},{append:e.withCtx(()=>t[16]||(t[16]=[e.createTextVNode(" 人 ")])),_:1},8,["modelValue","formatter","parser"])):(e.openBlock(),e.createElementBlock("div",fe,[e.createVNode(_,{link:"",type:"primary",onClick:f},{default:e.withCtx(()=>t[17]||(t[17]=[e.createTextVNode("添加拼团阶梯")])),_:1}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value.users,(c,P)=>(e.openBlock(),e.createElementBlock("div",{key:P,class:"groupForm__stairs"},[e.createElementVNode("span",ke,"第"+e.toDisplayString(P+1)+"阶段人数",1),e.createVNode(p,{modelValue:l.value.users[P],"onUpdate:modelValue":U=>l.value.users[P]=U,class:"groupForm__stairs--input",style:{width:"450px"},formatter:U=>Number(`${U}`.replace(/[^\d]/g,"")),parser:U=>`${Number(U)>=100?100:U}`,max:100},{append:e.withCtx(()=>t[18]||(t[18]=[e.createTextVNode(" 人 ")])),_:2},1032,["modelValue","onUpdate:modelValue","formatter","parser"]),P>0?(e.openBlock(),e.createBlock(_,{key:0,type:"primary",link:"",onClick:E},{default:e.withCtx(()=>t[19]||(t[19]=[e.createTextVNode("删除")])),_:1})):e.createCommentVNode("",!0)]))),128))]))]),_:1}),e.createVNode(k,{label:"订单关闭时间",prop:"payTimeout"},{default:e.withCtx(()=>[e.createVNode(F,{modelValue:l.value.payTimeout,"onUpdate:modelValue":t[5]||(t[5]=c=>l.value.payTimeout=c),controls:!1,max:360,min:3},null,8,["modelValue"]),t[20]||(t[20]=e.createElementVNode("span",{class:"tips",style:{"margin-left":"8px"}},"商品按下单减库存，请设置未付款订单自动取消时间及时释放库存，可输入3-360分钟",-1))]),_:1}),e.createVNode(k,{label:"自动成团",prop:"simulate"},{default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(y,{modelValue:l.value.simulate,"onUpdate:modelValue":t[6]||(t[6]=c=>l.value.simulate=c)},{default:e.withCtx(()=>[e.createVNode(b,{value:!1},{default:e.withCtx(()=>t[21]||(t[21]=[e.createTextVNode("关闭")])),_:1}),e.createVNode(b,{value:!0},{default:e.withCtx(()=>t[22]||(t[22]=[e.createTextVNode("开启")])),_:1})]),_:1},8,["modelValue"]),t[23]||(t[23]=e.createElementVNode("div",{class:"tips"},"开启后拼团有效时间内人数未满，系统将以“虚拟用户”凑满人数提高成团率。",-1))])]),_:1}),e.createVNode(k,{label:"优惠叠加"},{default:e.withCtx(()=>[e.createVNode(z,{modelValue:l.value.stackable.vip,"onUpdate:modelValue":t[7]||(t[7]=c=>l.value.stackable.vip=c),label:"会员价"},null,8,["modelValue"]),e.createVNode(z,{modelValue:l.value.stackable.coupon,"onUpdate:modelValue":t[8]||(t[8]=c=>l.value.stackable.coupon=c),label:"优惠券"},null,8,["modelValue"]),e.createVNode(z,{modelValue:l.value.stackable.full,"onUpdate:modelValue":t[9]||(t[9]=c=>l.value.stackable.full=c),label:"满减"},null,8,["modelValue"]),t[24]||(t[24]=e.createElementVNode("span",{class:"tips",style:{"margin-left":"8px"}},[e.createTextVNode(" 优惠叠加可能导致实付金额为 "),e.createElementVNode("i",{style:{color:"red","font-weight":"700","font-style":"unset"}},"0"),e.createTextVNode(" (实付金额= 活动价 - 会员优惠 - 优惠券优惠 - 满减优惠) ")],-1))]),_:1}),e.createVNode(k,{label:"适用商品"},{default:e.withCtx(()=>[e.createVNode(_,{type:"primary",link:"",onClick:o},{default:e.withCtx(()=>t[25]||(t[25]=[e.createTextVNode("选择商品")])),_:1})]),_:1})]),_:1},8,["model","rules","disabled"]),e.createVNode(D,{modelValue:G.value,"onUpdate:modelValue":t[10]||(t[10]=c=>G.value=c),searchParam:M,"onUpdate:searchParam":t[11]||(t[11]=c=>M=c),searchConsignmentProduct:!0,pointGoodsList:B.value,onOnConfirm:O},null,8,["modelValue","searchParam","pointGoodsList"]),e.createVNode(ie,{ref_key:"selectGoodsTableRef",ref:q,mode:l.value.mode,users:l.value.users,productList:B.value,isEdit:e.unref(T),flatGoodList:L.value},null,8,["mode","users","productList","isEdit","flatGoodList"])]),e.createElementVNode("div",Ve,[e.createVNode(_,{round:"",onClick:$},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(T)?"返回":"取消"),1)]),_:1}),e.unref(T)?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(te,{key:0,type:"primary",round:"",onClick:R},{default:e.withCtx(()=>t[26]||(t[26]=[e.createTextVNode("确定")])),_:1}))])],64)}}}),Ne="";return W(ge,[["__scopeId","data-v-d44f441d"]])});

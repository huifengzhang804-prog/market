(function(e,k){typeof exports=="object"&&typeof module<"u"?module.exports=k(require("vue"),require("@/components/ChromeTab.vue"),require("@vueuse/core"),require("@/components/SchemaForm.vue"),require("@/components/PageManage.vue"),require("@/store/modules/shopInfo"),require("element-plus"),require("vue-router"),require("@/utils/Storage"),require("@/utils/http"),require("decimal.js"),require("@/composables/useConvert")):typeof define=="function"&&define.amd?define(["vue","@/components/ChromeTab.vue","@vueuse/core","@/components/SchemaForm.vue","@/components/PageManage.vue","@/store/modules/shopInfo","element-plus","vue-router","@/utils/Storage","@/utils/http","decimal.js","@/composables/useConvert"],k):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopGroup=k(e.ShopGroupContext.Vue,e.ShopGroupContext.ChromeTabs,e.ShopGroupContext.VueUse,e.ShopGroupContext.SchemaForm,e.ShopGroupContext.PageManageTwo,e.ShopGroupContext.ShopInfoStore,e.ShopGroupContext.ElementPlus,e.ShopGroupContext.VueRouter,e.ShopGroupContext.Storage,e.ShopGroupContext.UtilsHttp,e.ShopGroupContext.Decimal,e.ShopGroupContext.UseConvert))})(this,function(e,k,M,B,D,P,x,T,q,w,me,R){"use strict";var F=document.createElement("style");F.textContent=`@charset "UTF-8";*,:before,:after{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }::backdrop{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }.fixed,[fixed=\"\"]{position:fixed}.flex{display:flex}.col-last[data-v-5602c119]{display:flex;justify-content:flex-end}.m-l-20[data-v-5602c119]{margin-left:20px}.container[data-v-995d1847]{overflow-y:scroll}.reason[data-v-995d1847]{padding:10px 10px 20px}[data-v-995d1847] .el-button.is-link{padding:0}[data-v-995d1847] .el-button+.el-button{margin-left:10px}.group__head[data-v-70e59029]{display:flex;justify-content:flex-end;align-items:center}.group__head--center[data-v-70e59029]{margin:0 20px}.group__userInfo[data-v-70e59029]{display:flex;align-items:center}.group__userInfo--text[data-v-70e59029]{width:86px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-left:5px}.group__goodInfo[data-v-70e59029]{display:flex;align-items:center}.group__goodInfo--text[data-v-70e59029]{width:154px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden;margin-left:5px}.group__content[data-v-70e59029]{margin-top:10px}
`,document.head.appendChild(F);const he="",j={class:"q_plugin_container"},U={class:"fdc1 overh"},v=e.defineComponent({__name:"ShopGroup",setup(l){const f={GroupActivity:e.defineAsyncComponent(()=>Promise.resolve().then(()=>ae)),GroupOrder:e.defineAsyncComponent(()=>Promise.resolve().then(()=>pe))},s=e.ref("GroupActivity"),c=[{name:"GroupActivity",label:"拼团活动"},{name:"GroupOrder",label:"拼团订单"}],m=_=>{_&&(s.value=_)};return(_,i)=>(e.openBlock(),e.createElementBlock("div",j,[e.createVNode(k,{"tab-list":c,value:s.value,onHandleTabs:m},null,8,["value"]),e.createElementVNode("div",U,[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(f[s.value])))])]))}}),J=e.defineComponent({__name:"head-search",props:{modelValue:{type:Object,default(){return{}}},batchDisabled:{type:Boolean,default:!0},leftBtnText:{type:String,default:"leftBtnText"}},emits:["update:modelValue","search"],setup(l,{emit:f}){const s=l,m=[{label:"活动名称",prop:"keyword",valueType:"copy",fieldProps:{placeholder:"请输入活动名称"}},{label:"活动状态",prop:"status",valueType:"select",options:[{value:"",label:"全部状态"},{value:"OPENING",label:"未开始"},{value:"OPEN",label:"进行中"},{value:"FINISHED",label:"已结束"},{value:"SHOP_OFF_SHELF",label:"已下架"},{value:"VIOLATION",label:"违规下架"}],fieldProps:{placeholder:"请选择"}}],_=f,i=M.useVModel(s,"modelValue",_),E=()=>{Object.keys(i.value).forEach(N=>i.value[N]=""),_("search")};return(N,g)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(B,{modelValue:e.unref(i),"onUpdate:modelValue":g[0]||(g[0]=h=>e.isRef(i)?i.value=h:null),columns:m,onSearchHandle:g[1]||(g[1]=h=>_("search")),onHandleReset:E},null,8,["modelValue"]),g[2]||(g[2]=e.createElementVNode("div",{class:"grey_bar"},null,-1))],64))}}),_e="",I=(l,f)=>{const s=l.__vccOpts||l;for(const[c,m]of f)s[c]=m;return s},K=I(J,[["__scopeId","data-v-5602c119"]]),Q=l=>w.http.get({url:"addon-team/team/activity",params:l},{isMock:!1}),W=l=>w.http.get({url:"addon-team/team/activity/order",params:l},{isMock:!1}),X=l=>w.http.post({url:"addon-team/team/activity/delete/batch",data:l}),Y=l=>w.http.post({url:`addon-team/team/activity/shop/shelf/${l}`}),Z=l=>w.http.get({url:`addon-team/team/activity/illegal/${l}/reason`}),ee={class:"handle_container",style:{"padding-top":"16px"}},te={class:"table_container"},oe={class:"reason"},ne=e.defineComponent({__name:"group-activity",setup(l){const f=T.useRouter(),s=T.useRoute(),c=e.ref([]),m=e.ref({keyword:"",status:"",date:""}),_=e.ref(),i=e.reactive({size:10,current:1,total:0}),E={OPENING:"未开始",PREHEAT:"预售中",OPEN:"进行中",FINISHED:"已结束",SHOP_OFF_SHELF:"已下架",VIOLATION:"违规下架"},N={COMMON:"普通拼团",STAIRS:"阶梯拼团"};e.onBeforeMount(()=>{h()}),e.watch(()=>s.query.flag,()=>{h()});const g=(n,t)=>{f.push({name:"marketingAppGroupForm",query:{id:n,isLookUp:t}})};async function h(){const n={...i,...m.value,shopId:P.useShopInfoStore().shopInfo.id},{code:t,data:d}=await Q(n);if(t!==200)return x.ElMessage.error("获取活动列表失败");c.value=d.records,i.total=d.total}const G=n=>{i.current=n,h()},A=n=>{i.size=n,h()},C=async(n,t)=>{const d=t??"确定删除该活动?";try{if(!await x.ElMessageBox.confirm(d,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}))return;const u=Array.isArray(n)?n.map(o=>({...o,activityId:o.id})):[{...n,activityId:n.id}];u.forEach(o=>{o.activityId=o.id});const{code:L,data:$}=await X(u);if(L!==200){x.ElMessage.error("删除失败");return}x.ElMessage.success("删除成功"),h()}catch{}},r=e.ref([]),y=async()=>{const t=r.value.filter(u=>u.status!=="OPEN").length,d=r.value.length,p=t===d?"确定批量删除活动?":`确定批量删除活动? 其中有${d-t}条数据为进行中,无法进行删除 已自动剔除！`;C(r.value,p)},V=n=>{r.value=n},b=async n=>{try{if(!await x.ElMessageBox.confirm("确定下架商品吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}))return;const{msg:d,code:p}=await Y(n);if(p!==200)return x.ElMessage.error(d??"下架失败");h()}catch(t){console.log("error",t)}},S=e.ref(!1),O=e.ref("违规原因"),a=async n=>{try{const{msg:t,data:d,code:p}=await Z(n);if(p!==200||!d)return x.ElMessage.error(t??"获取下架原因失败！");O.value=d,S.value=!0}catch(t){console.log("error",t)}},H=()=>{O.value="",S.value=!1},ue=()=>{var t;if(((t=new q().getItem("shopStore"))==null?void 0:t.shopMode)==="O2O"){x.ElMessage.warning("O2O店铺暂不支持该活动");return}f.push({name:"marketingAppGroupNewForm"})};return(n,t)=>{const d=e.resolveComponent("el-config-provider"),p=e.resolveComponent("el-button"),u=e.resolveComponent("el-table-column"),L=e.resolveComponent("el-table"),$=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(d,{"empty-values":[void 0,null]},{default:e.withCtx(()=>[e.createVNode(K,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=o=>m.value=o),onSearch:h},null,8,["modelValue"])]),_:1}),e.createElementVNode("div",ee,[e.createVNode(p,{round:"",type:"primary",onClick:ue},{default:e.withCtx(()=>t[2]||(t[2]=[e.createTextVNode("新增拼团")])),_:1}),e.createVNode(p,{disabled:!r.value.length,round:"",onClick:y},{default:e.withCtx(()=>t[3]||(t[3]=[e.createTextVNode(" 批量删除 ")])),_:1},8,["disabled"])]),e.createElementVNode("div",te,[e.createVNode(L,{ref_key:"multipleTableRef",ref:_,data:c.value,"header-cell-style":{background:"#f6f8fa",height:"48px"},"header-row-style":{color:"#333"},onSelectionChange:V},{default:e.withCtx(()=>[e.createVNode(u,{type:"selection",width:"30",fixed:"",selectable:o=>o.status!=="OPEN"},null,8,["selectable"]),e.createVNode(u,{label:"活动名称",width:"220"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(o.name),1)]),_:1}),e.createVNode(u,{label:"拼团模式",width:"140"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(N[o.mode]),1)]),_:1}),e.createVNode(u,{label:"状态",width:"140"},{default:e.withCtx(({row:o})=>[e.createElementVNode("span",{style:e.normalizeStyle({color:["VIOLATION"].includes(o.status)?"#F54319":["SHOP_OFF_SHELF","FINISHED"].includes(o.status)?"#999":"#333"})},e.toDisplayString(E[o.status]),5)]),_:1}),e.createVNode(u,{label:"活动时间",width:"240"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",null,"起："+e.toDisplayString(o.startTime),1),e.createElementVNode("div",null,"止："+e.toDisplayString(o.endTime),1)]),_:1}),e.createVNode(u,{label:"活动商品",width:"120"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(o.productNum||0),1)]),_:1}),e.createVNode(u,{label:"支付单数",width:"120"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(o.orders||0),1)]),_:1}),e.createVNode(u,{label:"操作",fixed:"right",align:"right"},{default:e.withCtx(({row:o})=>[e.createVNode(p,{type:"primary",link:"",onClick:z=>g(o.id,"true")},{default:e.withCtx(()=>t[4]||(t[4]=[e.createTextVNode("查看")])),_:2},1032,["onClick"]),o.status==="OPEN"?(e.openBlock(),e.createBlock(p,{key:0,type:"primary",link:"",onClick:z=>b(o.id)},{default:e.withCtx(()=>t[5]||(t[5]=[e.createTextVNode("下架")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0),o.status==="VIOLATION"?(e.openBlock(),e.createBlock(p,{key:1,type:"primary",link:"",onClick:z=>a(o.id)},{default:e.withCtx(()=>t[6]||(t[6]=[e.createTextVNode("违规原因")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0),o.status!=="OPEN"?(e.openBlock(),e.createBlock(p,{key:2,type:"danger",link:"",onClick:z=>C(o)},{default:e.withCtx(()=>t[7]||(t[7]=[e.createTextVNode("删除")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0)]),_:1})]),_:1},8,["data"])]),e.createVNode(D,{"page-size":i.size,"page-num":i.current,total:i.total,onHandleCurrentChange:G,onHandleSizeChange:A},null,8,["page-size","page-num","total"]),e.createVNode($,{modelValue:S.value,"onUpdate:modelValue":t[1]||(t[1]=o=>S.value=o),title:"违规原因",width:"600px",center:"",onClose:H},{default:e.withCtx(()=>[e.createElementVNode("div",oe,e.toDisplayString(O.value),1)]),_:1},8,["modelValue"])],64)}}}),fe="",ae=Object.freeze(Object.defineProperty({__proto__:null,default:I(ne,[["__scopeId","data-v-995d1847"]])},Symbol.toStringTag,{value:"Module"})),re={class:"table_container",style:{"padding-top":"26px"}},le={class:"group__userInfo"},se={class:"group__userInfo--text"},ie={class:"group__goodInfo"},ce={class:"group__goodInfo--text"},de=e.defineComponent({__name:"group-order",setup(l){const f=T.useRouter(),s=e.reactive({status:"SUCCESS",commander:"",productName:""}),c=e.reactive({current:1,size:10,total:0}),m=e.ref([]),{divTenThousand:_}=R(),i=[{label:"拼团状态",prop:"status",valueType:"select",options:[{label:"拼团成功",value:"SUCCESS"},{label:"拼团失败",value:"FAIL"},{label:"拼团中",value:"ING"}],fieldProps:{placeholder:"请选择"}},{label:"发起人",prop:"commander",valueType:"copy",fieldProps:{placeholder:"请输入发起人姓名"}},{label:"商品名称",prop:"productName",valueType:"copy",fieldProps:{placeholder:"请输入商品名称"}}];C();const E=r=>({SUCCESS:"拼团成功",FAIL:"拼团失败",ING:"拼团中"})[r],N=r=>{f.push({name:"marketingAppGroupOrderDetail",query:{teamNo:r}})},g=r=>{c.size=r,C()},h=r=>{c.current=r,C()},G=()=>{C()},A=()=>{Object.keys(s).forEach(r=>s[r]=""),C()};async function C(){const r={...c,...s},{data:y,code:V}=await W(r);if(V!==200)return x.ElMessage.error("获取拼团订单失败");m.value=y.records,c.total=y.total}return(r,y)=>{const V=e.resolveComponent("el-image"),b=e.resolveComponent("el-table-column"),S=e.resolveComponent("el-button"),O=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(B,{modelValue:s,"onUpdate:modelValue":y[0]||(y[0]=a=>s=a),columns:i,showNumber:3,onSearchHandle:G,onHandleReset:A},null,8,["modelValue"]),e.createElementVNode("div",re,[e.createVNode(O,{data:m.value,"header-cell-style":{height:"48px",background:"#F7F8FA"},"header-row-style":{color:"#333"}},{default:e.withCtx(()=>[e.createVNode(b,{label:"发起人",width:"180"},{default:e.withCtx(({row:a})=>[e.createElementVNode("div",le,[e.createVNode(V,{src:a.commanderAvatar,style:{width:"30px",height:"30px"}},null,8,["src"]),e.createElementVNode("div",se,e.toDisplayString(a.commanderNickname),1)])]),_:1}),e.createVNode(b,{label:"商品信息",width:"210"},{default:e.withCtx(({row:a})=>[e.createElementVNode("div",ie,[e.createVNode(V,{src:a.productImage,style:{width:"36px",height:"36px"}},null,8,["src"]),e.createElementVNode("div",ce,e.toDisplayString(a.productName),1)])]),_:1}),e.createVNode(b,{label:"开团时间",prop:"openTime"}),e.createVNode(b,{label:"参团人数",width:"100"},{default:e.withCtx(({row:a})=>[e.createElementVNode("div",null,e.toDisplayString(a.currentNum)+"/"+e.toDisplayString(a.totalNum),1)]),_:1}),e.createVNode(b,{label:"订单总金额(元)",width:"160"},{default:e.withCtx(({row:a})=>[e.createElementVNode("div",null,e.toDisplayString(e.unref(_)(a.amount).toFixed(2)),1)]),_:1}),e.createVNode(b,{label:"状态",width:"90"},{default:e.withCtx(({row:a})=>[e.createElementVNode("div",{style:e.normalizeStyle({color:a.status==="SUCCESS"?"#00BB2C":a.status==="FAIL"?"#999999":""})},e.toDisplayString(E(a.status)),5)]),_:1}),e.createVNode(b,{label:"操作",align:"right",width:"100",fixed:"right"},{default:e.withCtx(({row:a})=>[e.createVNode(S,{link:"",type:"primary",onClick:H=>N(a.teamNo)},{default:e.withCtx(()=>y[1]||(y[1]=[e.createTextVNode("拼团详情")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e.createVNode(D,{"page-size":c.size,"page-num":c.current,total:c.total,onHandleSizeChange:g,onHandleCurrentChange:h},null,8,["page-size","page-num","total"])],64)}}}),ye="",pe=Object.freeze(Object.defineProperty({__proto__:null,default:I(de,[["__scopeId","data-v-70e59029"]])},Symbol.toStringTag,{value:"Module"}));return v});

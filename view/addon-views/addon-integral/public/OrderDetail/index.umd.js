(function(e,u){typeof exports=="object"&&typeof module<"u"?module.exports=u(require("vue"),require("@/views/order/orderDetails/components/remark-view.vue"),require("element-plus"),require("@/composables/useConvert"),require("vue-router"),require("@/apis/http"),require("@/apis/afs"),require("@/assets/json/data.json")):typeof define=="function"&&define.amd?define(["vue","@/views/order/orderDetails/components/remark-view.vue","element-plus","@/composables/useConvert","vue-router","@/apis/http","@/apis/afs","@/assets/json/data.json"],u):(e=typeof globalThis<"u"?globalThis:e||self,e.OrderDetail=u(e.OrderDetailContext.Vue,e.OrderDetailContext.RemarkView,e.OrderDetailContext.ElementPlus,e.OrderDetailContext.UseConvert,e.OrderDetailContext.VueRouter,e.OrderDetailContext.Request,e.OrderDetailContext.ApisAfs,e.OrderDetailContext.handleGetCompanyName))})(this,function(e,u,b,w,k,S,B,R){"use strict";var E=document.createElement("style");E.textContent=`@charset "UTF-8";.orderInfo__title[data-v-03019e47]{padding:20px;font-size:18px;font-weight:700;color:#515151;width:223px;text-align:center}.orderInfo__steps[data-v-03019e47]{padding:20px;margin:20px;width:700px;border-left:1px solid #d5d5d5}.orderInfo__priceInfo[data-v-03019e47]{height:40px;color:#999;display:flex;justify-content:space-between;align-items:flex-end;flex-direction:column;margin:50px 0 20px}.orderInfo__shopName[data-v-03019e47]{font-size:14px;color:#333;font-weight:700;margin:22px 0 12px 5px}.orderInfo__footer[data-v-03019e47]{text-align:right}.orderInfo__footer span[data-v-03019e47]:nth-child(n+1){font-size:20px;font-weight:700;color:#ee420d}.orderInfo__userInfo[data-v-03019e47]{display:flex;background:#f7f8fa;margin-bottom:22px;padding:0 30px}.orderInfo__userInfo--left[data-v-03019e47]{flex:.5}.orderInfo__userInfo--left div[data-v-03019e47]:nth-of-type(n+2){margin-bottom:11px}.orderInfo__userInfo--right[data-v-03019e47]{flex:.5}.orderInfo__userInfo--right div[data-v-03019e47]:nth-of-type(n+2){margin-bottom:11px}.orderInfo__userInfo--title[data-v-03019e47]{font-size:14px;color:#333;font-weight:700;margin:17px 0}.orderInfo__tab--goods[data-v-03019e47]{display:flex;justify-content:space-between}.orderInfo__tab--goods-right[data-v-03019e47]{font-size:12px;color:#586884;width:132px;margin-left:10px;display:flex;justify-content:space-between;align-items:flex-start;flex-direction:column}.orderInfo__tab--goods-right-show[data-v-03019e47]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.orderInfo__tab--price[data-v-03019e47]{display:flex;justify-content:center;align-items:center;font-size:12px;color:#50596d;flex-direction:column}.el-table td[data-v-03019e47]{border-bottom:none}.tableStyle[data-v-03019e47]:before{width:0}.el-table[data-v-03019e47]{border-radius:9px;border:1px solid #d5d5d5}.el-table th.is-leaf[data-v-03019e47]{border-bottom:none}.logisticsInfo[data-v-46ce6ddb]{padding:0 16px;overflow-y:scroll}.logisticsInfo__overflow[data-v-46ce6ddb]{height:calc(100vh - 400px);overflow-y:auto;padding:0 10px}.logisticsInfo__title[data-v-46ce6ddb]{font-size:14px;color:#333;font-weight:700;margin:17px 0}.logisticsInfo__text[data-v-46ce6ddb]{margin-bottom:11px}.logisticsInfo__timeline[data-v-46ce6ddb]{margin-top:42px}.logisticsInfo__timeline li[data-v-46ce6ddb]:nth-child(1) .el-timeline-item__timestamp{color:#000}.logisticsInfo__timeline--status[data-v-46ce6ddb]{font-size:13px;font-weight:700;margin-right:10px;color:#838383}.logisticsInfo__timeline--time[data-v-46ce6ddb]{color:#838383}.logisticsInfo__divider[data-v-46ce6ddb]{height:4px;background:#f2f2f2}
`,document.head.appendChild(E);const P={class:"tab_container"},A=e.defineComponent({__name:"OrderDetail",setup(f){const p=[{label:"订单信息",name:"orderInfo"},{label:"物流信息",name:"logisticsInfo"}],s={orderInfo:e.defineAsyncComponent(()=>Promise.resolve().then(()=>re)),logisticsInfo:e.defineAsyncComponent(()=>Promise.resolve().then(()=>pe))},i=e.ref("orderInfo");return(l,a)=>{const t=e.resolveComponent("el-tab-pane"),x=e.resolveComponent("el-tabs");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",P,[e.createVNode(x,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=_=>i.value=_)},{default:e.withCtx(()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(p,_=>e.createVNode(t,{key:_.label,label:_.label,name:_.name},null,8,["label","name"])),64))]),_:1},8,["modelValue"])]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(s[i.value])))],64)}}}),$="addon-integral/integral/"+"order/",V=f=>S.get({url:$+`get/${f}`}),j={UNPAID:"未支付",PAID:"待发货",ON_DELIVERY:"已发货",ACCOMPLISH:"已完成",SYSTEM_CLOSED:"已关闭"},L={style:{padding:"0 16px","overflow-y":"scroll"}},z={class:"orderInfo"},q={style:{display:"flex","align-items":"center"}},U={class:"orderInfo__title"},F={class:"orderInfo__steps"},M={class:"orderInfo__userInfo"},G={class:"orderInfo__userInfo--left"},W={class:"orderInfo__userInfo--right"},H={class:"orderInfo__tab--goods"},Y={class:"orderInfo__tab--goods-right"},J={class:"orderInfo__tab--goods-right-show"},K={class:"orderInfo__tab--price"},Q={key:0},X={class:"orderInfo__priceInfo"},Z={key:0},ee={class:"orderInfo__footer"},te={key:0},oe=e.defineComponent({__name:"IntegralOrderDetail",setup(f){const{divTenThousand:p}=w(),s=e.ref(0),l=k.useRoute().query.no,a=e.ref({}),t=e.ref({sellerRemark:"",buyerRemark:"",payTime:"",deliveryTime:"",accomplishTime:"",buyerId:"",buyerNickname:"",createTime:"",freightPrice:0,image:"",integralOrderReceiver:{address:"",area:[],createTime:"",id:"",mobile:"",name:"",orderNo:"",updateTime:""},no:"",num:1,price:"",productName:"",status:"PAID",salePrice:"",productType:"REAL_PRODUCT",affiliationPlatform:0});x();async function x(){if(l){const{code:d,msg:n,data:m}=await V(l);if(d!==200||!m){b.ElMessage.error(n||"订单详情获取失败");return}t.value=m,_()}}function _(){var d,n,m;(d=t.value)!=null&&d.accomplishTime?s.value=2:(n=t.value)!=null&&n.deliveryTime?s.value=1:(m=t.value)!=null&&m.payTime&&(s.value=0)}const h=e.computed(()=>t.value.price&&t.value.num?t.value.price:0),r=e.computed(()=>t.value.freightPrice?p(t.value.freightPrice):0),o=e.computed(()=>t.value.salePrice&&t.value.num?t.value.salePrice:0);return(d,n)=>{var D,O;const m=e.resolveComponent("el-step"),N=e.resolveComponent("el-steps"),I=e.resolveComponent("el-image"),g=e.resolveComponent("el-table-column"),y=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock("div",L,[e.createElementVNode("div",z,[e.createElementVNode("div",q,[e.createElementVNode("div",U,e.toDisplayString(e.unref(j)[(D=t.value)==null?void 0:D.status]),1),e.createElementVNode("div",F,[e.createVNode(N,{active:s.value,"align-center":"","process-status":"finish"},{default:e.withCtx(()=>[e.createVNode(m,{title:"买家已付款",description:t.value.payTime},null,8,["description"]),e.createVNode(m,{title:"商家发货",description:t.value.deliveryTime},null,8,["description"]),e.createVNode(m,{title:"成功订单",description:t.value.accomplishTime},null,8,["description"])]),_:1},8,["active"])])]),e.createElementVNode("div",M,[e.createElementVNode("div",G,[n[0]||(n[0]=e.createElementVNode("div",{class:"orderInfo__userInfo--title"},"物流信息",-1)),e.createElementVNode("div",null,"用户昵称："+e.toDisplayString(t.value.buyerNickname||"无"),1),e.createElementVNode("div",null,"买家姓名："+e.toDisplayString(t.value.integralOrderReceiver.name||"无"),1),e.createElementVNode("div",null,"买家手机号："+e.toDisplayString(t.value.integralOrderReceiver.mobile||"无"),1),e.createElementVNode("div",null,"收货地址："+e.toDisplayString((O=t.value.integralOrderReceiver.area)==null?void 0:O.join(""))+" "+e.toDisplayString(t.value.integralOrderReceiver.address),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value,(c,T,v)=>(e.openBlock(),e.createBlock(u,{key:v,class:"detail__item","remark-key":T,remark:a.value},null,8,["remark-key","remark"]))),128))]),e.createElementVNode("div",W,[n[1]||(n[1]=e.createElementVNode("div",{class:"orderInfo__userInfo--title"},"订单信息",-1)),e.createElementVNode("div",null,"订单编号："+e.toDisplayString(t.value.no),1),e.createElementVNode("div",null,"创建时间："+e.toDisplayString(t.value.createTime),1)])]),e.createVNode(y,{"cell-style":({row:c,column:T,rowIndex:v,columnIndex:_e})=>{if(_e===0)return{borderBottom:"none"}},data:[t.value],style:{width:"100%"},calss:"orderInfo__tab",border:""},{default:e.withCtx(()=>[e.createVNode(g,{label:"商品",width:"230",align:"center"},{default:e.withCtx(({row:c})=>[e.createElementVNode("div",H,[e.createVNode(I,{fits:"cover",style:{width:"70px",height:"70px"},shape:"square",size:"large",src:c.image,title:c.productName},null,8,["src","title"]),e.createElementVNode("div",Y,[e.createElementVNode("div",J,e.toDisplayString(c.productName),1)])])]),_:1}),e.createVNode(g,{label:"单价&数量",align:"center"},{default:e.withCtx(({row:c})=>[e.createElementVNode("div",K,[e.createElementVNode("div",null,"单价："+e.toDisplayString(c.price)+" 积分",1),e.createElementVNode("div",null,"数量： *"+e.toDisplayString(c.num),1)])]),_:1}),e.createVNode(g,{label:"总价",align:"center"},{default:e.withCtx(({row:c})=>[e.createElementVNode("div",null,[e.createTextVNode(" 总价： "+e.toDisplayString(c.price)+" 积分 ",1),c.salePrice!=="0"?(e.openBlock(),e.createElementBlock("span",Q," + ￥ "+e.toDisplayString(e.unref(p)(c.salePrice)),1)):e.createCommentVNode("",!0)])]),_:1})]),_:1},8,["cell-style","data"])]),e.createElementVNode("div",X,[e.createElementVNode("span",null," 运费:￥"+e.toDisplayString(r.value),1),e.createElementVNode("span",null,[e.createTextVNode("商品总价:"+e.toDisplayString(h.value)+" 积分 ",1),+o.value!=0?(e.openBlock(),e.createElementBlock("span",Z," + ￥ "+e.toDisplayString(e.unref(p)(o.value)),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("div",ee,[n[2]||(n[2]=e.createTextVNode(" 实收款：")),e.createElementVNode("span",null,[e.createTextVNode(e.toDisplayString(h.value)+" 积分 ",1),+o.value!=0?(e.openBlock(),e.createElementBlock("span",te," + ￥ "+e.toDisplayString(+e.unref(p)(o.value)+ +r.value)+"元",1)):e.createCommentVNode("",!0)])])])}}}),ge="",C=(f,p)=>{const s=f.__vccOpts||f;for(const[i,l]of p)s[i]=l;return s},re=Object.freeze(Object.defineProperty({__proto__:null,default:C(oe,[["__scopeId","data-v-03019e47"]])},Symbol.toStringTag,{value:"Module"})),ne={class:"logisticsInfo"},ie={key:0},le={class:"logisticsInfo__text"},ae={class:"logisticsInfo__text"},se={class:"logisticsInfo__text",style:{"margin-bottom":"20px"}},ce={key:1,class:"logisticsInfo__text"},de={class:"logisticsInfo__overflow"},me=e.defineComponent({__name:"integral-order-logistics",setup(f){const s=k.useRoute().query.no,i=e.ref(!1),l=e.ref({sellerRemark:"",buyerRemark:"",payTime:"",deliveryTime:"",accomplishTime:"",buyerId:"",buyerNickname:"",createTime:"",freightPrice:0,image:"",salePrice:"",integralOrderReceiver:{address:"",area:[],createTime:"",id:"",mobile:"",name:"",orderNo:"",updateTime:""},no:"",num:1,price:"",productName:"",status:"PAID",productType:"REAL_PRODUCT"}),a=e.ref([{context:"",status:"",time:""}]);x();function t(r){return r==="WITHOUT"}async function x(){if(s){const{code:r,data:o,msg:d}=await V(s);if(r!==200||!o){b.ElMessage.error(d||"订单详情获取失败");return}if(l.value=o,t(o.integralOrderDeliverType))return;_(o)}}const _=async r=>{if(r.integralOrderDeliverType==="WITHOUT"){a.value=[{context:"无需物流",time:r.createTime,status:"无需物流"}];return}try{if(r.expressCompanyName&&r.expressNo){const{data:o,code:d,msg:n}=await B.doGetLogisticsTrajectoryByWaybillNo(r.expressCompanyName,r.expressNo);if(d!==200)return b.ElMessage.error(n||"物流轨迹获取失败");if(!o.data){h(o,r);return}a.value=o.data}else throw new Error("包裹信息获取失败")}catch{i.value=!0,a.value=[{context:"包裹异常",time:r.integralOrderReceiver.updateTime,status:"包裹异常"}]}};function h(r,o){switch(r.returnCode){case"401":i.value=!0,a.value=[{status:"包裹异常",time:o.integralOrderReceiver.updateTime,context:r.message}];break;case"400":i.value=!0,a.value=[{status:"包裹异常",time:o.integralOrderReceiver.updateTime,context:r.message}];break;default:i.value=!0,a.value=[{status:"包裹异常",time:o.integralOrderReceiver.updateTime,context:r.message}];break}}return(r,o)=>{var I;const d=e.resolveComponent("el-row"),n=e.resolveComponent("el-timeline-item"),m=e.resolveComponent("el-timeline"),N=e.resolveComponent("el-alert");return e.openBlock(),e.createElementBlock("div",ne,[l.value.integralOrderDeliverType?(e.openBlock(),e.createElementBlock("div",ie,[o[0]||(o[0]=e.createElementVNode("div",{class:"logisticsInfo__title"},"物流信息",-1)),e.createElementVNode("div",le," 收货地址："+e.toDisplayString((I=l.value.integralOrderReceiver.area)==null?void 0:I.join(""))+" "+e.toDisplayString(l.value.integralOrderReceiver.address),1),l.value.integralOrderDeliverType!=="WITHOUT"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("div",ae,"物流公司："+e.toDisplayString(e.unref(R)(l.value.expressCompanyName)),1),e.createElementVNode("div",se,"物流单号："+e.toDisplayString(l.value.expressNo),1)],64)):(e.openBlock(),e.createElementBlock("div",ce,"物流公司：无需物流")),o[1]||(o[1]=e.createElementVNode("div",{class:"logisticsInfo__divider"},null,-1)),o[2]||(o[2]=e.createElementVNode("div",{class:"logisticsInfo__title"},"物流详情",-1)),e.createElementVNode("div",de,[e.createVNode(m,{class:"logisticsInfo__timeline"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value.reverse(),(g,y)=>(e.openBlock(),e.createBlock(n,{key:y,timestamp:`${g.context}`,style:{"padding-bottom":"42px"},color:y===0?i.value?"#F56C6C":"#409eff":" ",class:"logisticsInfo__timeline--item"},{default:e.withCtx(()=>[e.createVNode(d,null,{default:e.withCtx(()=>[e.createElementVNode("div",{style:e.normalizeStyle({color:y===0?i.value?"#F56C6C":"#409eff":" "}),class:"logisticsInfo__timeline--status"},e.toDisplayString(g.status),5),e.createElementVNode("div",{style:e.normalizeStyle({color:y===0?i.value?"#F56C6C":"#409eff":" "}),class:"logisticsInfo__timeline--time"},e.toDisplayString(g.time),5)]),_:2},1024)]),_:2},1032,["timestamp","color"]))),128))]),_:1})])])):(e.openBlock(),e.createBlock(N,{key:1,title:"暂无物流信息",type:"info",closable:!1}))])}}}),ue="",pe=Object.freeze(Object.defineProperty({__proto__:null,default:C(me,[["__scopeId","data-v-46ce6ddb"]])},Symbol.toStringTag,{value:"Module"}));return A});

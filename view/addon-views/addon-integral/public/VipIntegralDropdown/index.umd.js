(function(e,l){typeof exports=="object"&&typeof module<"u"?module.exports=l(require("vue"),require("element-plus"),require("@/apis/http")):typeof define=="function"&&define.amd?define(["vue","element-plus","@/apis/http"],l):(e=typeof globalThis<"u"?globalThis:e||self,e.VipIntegralDropdown=l(e.VipIntegralDropdownContext.Vue,e.VipIntegralDropdownContext.ElementPlus,e.VipIntegralDropdownContext.Request))})(this,function(e,l,c){"use strict";const _=(a,s,r)=>c.post({url:"/gruul-mall-user/user/integral/system/change",data:{userId:a,integral:s,changeType:r}}),w=a=>c.get({url:"gruul-mall-user/user/integral/system/total",params:{userId:a}}),V=e.defineComponent({__name:"integral-update-dialog",props:{showDialog:{type:Boolean,default:!1},userId:{type:[String,Number],default:""}},emits:["reset"],setup(a,{emit:s}){const r=s,i=a,n=e.ref(0),d=e.ref(),o=e.reactive({num:0,changeType:"INCREASE"}),x=e.reactive({changeType:[{required:!0,message:"请选择正确的操作类型"}],num:[{required:!0,message:"请输入正确的数额"},{type:"number",message:"请输入一个正确的数字",min:1}]});e.watch(()=>i.showDialog,p=>{p&&N()},{immediate:!0});async function N(){const{code:p,data:t,msg:m}=await w(i.userId);if(p!==200)return l.ElMessage.error(m||"获取用户积分失败");n.value=t}const y=async()=>{if(!d.value||!await d.value.validate())return;const{code:t}=await _(i.userId,o.num,o.changeType);if(t!==200)return l.ElMessage.error("操作失败");l.ElMessage.success("操作成功"),n.value=0,o.num=0,o.changeType="INCREASE",r("reset")},f=()=>{o.num=0,o.changeType="INCREASE",r("reset")};return(p,t)=>{const m=e.resolveComponent("el-form-item"),g=e.resolveComponent("el-radio"),h=e.resolveComponent("el-radio-group"),E=e.resolveComponent("el-input-number"),T=e.resolveComponent("el-form"),C=e.resolveComponent("el-button"),I=e.resolveComponent("el-dialog");return e.openBlock(),e.createBlock(I,{"model-value":i.showDialog,"append-to-body":"",class:"label-view-dialog",title:"积分调整",width:"40%",onClose:f},{footer:e.withCtx(()=>[e.createVNode(C,{onClick:f},{default:e.withCtx(()=>t[5]||(t[5]=[e.createTextVNode("取消")])),_:1}),e.createVNode(C,{type:"primary",onClick:y},{default:e.withCtx(()=>t[6]||(t[6]=[e.createTextVNode("确认")])),_:1})]),default:e.withCtx(()=>[e.createVNode(T,{ref_key:"ruleFormRef",ref:d,model:o,rules:x,"label-width":"90px"},{default:e.withCtx(()=>[e.createVNode(m,{label:"当前数值"},{default:e.withCtx(()=>[e.createElementVNode("div",null,e.toDisplayString(n.value),1)]),_:1}),e.createVNode(m,{label:"操作",prop:"changeType"},{default:e.withCtx(()=>[e.createVNode(h,{modelValue:o.changeType,"onUpdate:modelValue":t[0]||(t[0]=u=>o.changeType=u),class:"ml-4"},{default:e.withCtx(()=>[e.createVNode(g,{value:"INCREASE",size:"large"},{default:e.withCtx(()=>t[2]||(t[2]=[e.createTextVNode("充值")])),_:1}),e.createVNode(g,{value:"REDUCE",size:"large"},{default:e.withCtx(()=>t[3]||(t[3]=[e.createTextVNode("扣除")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createVNode(m,{label:"调整数值",prop:"num"},{default:e.withCtx(()=>[e.createVNode(E,{modelValue:o.num,"onUpdate:modelValue":t[1]||(t[1]=u=>o.num=u),controls:!1,min:0},null,8,["modelValue"]),t[4]||(t[4]=e.createElementVNode("span",null,"请输入正整数",-1))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])}}});return e.defineComponent({__name:"VipIntegralDropdown",props:{properties:{type:Object,required:!0}},setup(a){const s=a,r=e.ref(!1);return(i,n)=>{const d=e.resolveComponent("el-dropdown-item");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(d,{onClick:n[0]||(n[0]=e.withModifiers(o=>r.value=!0,["stop"]))},{default:e.withCtx(()=>n[2]||(n[2]=[e.createTextVNode("积分调整")])),_:1}),e.createVNode(V,{"show-dialog":r.value,"user-id":s.properties.userId,onReset:n[1]||(n[1]=o=>r.value=!1)},null,8,["show-dialog","user-id"])],64)}}})});

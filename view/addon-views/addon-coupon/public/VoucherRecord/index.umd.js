(function(e,l){typeof exports=="object"&&typeof module<"u"?module.exports=l(require("vue"),require("element-plus"),require("@/components/BetterPageManage/BetterPageManage.vue"),require("@/apis/http"),require("@/components/SchemaForm.vue"),require("@/components/q-icon/q-icon.vue")):typeof define=="function"&&define.amd?define(["vue","element-plus","@/components/BetterPageManage/BetterPageManage.vue","@/apis/http","@/components/SchemaForm.vue","@/components/q-icon/q-icon.vue"],l):(e=typeof globalThis<"u"?globalThis:e||self,e.VoucherRecord=l(e.VoucherRecordContext.Vue,e.VoucherRecordContext.ElementPlus,e.VoucherRecordContext.PageManage,e.VoucherRecordContext.Request,e.VoucherRecordContext.SchemaForm,e.VoucherRecordContext.QIcon))})(this,function(e,l,C,f,N,E){"use strict";var y=document.createElement("style");y.textContent=`@charset "UTF-8";*,:before,:after{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }::backdrop{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }.fixed{position:fixed}.border,[border=\"\"]{border-width:1px}.cup{cursor:pointer}.export[data-v-3b03d543]{margin-left:auto}
`,document.head.appendChild(y);const M="",k=s=>f.get({url:"addon-coupon/coupon/consumer/use/record",params:s}),R=s=>f.post({url:"addon-coupon/coupon/consumer/export",data:s}),P={class:"q_plugin_container f1 overh"},U={class:"q_plugin_container"},z={class:"handle_container df"},D={class:"export cup"},I={class:"table_container"},S=e.defineComponent({__name:"VoucherRecord",setup(s){const c=e.ref({status:"",associatedOrderNo:"",name:"",userPhone:"",couponUserId:"",giftUserPhone:""}),r=e.ref({size:10,current:1,total:0}),p=[{label:"手机号",prop:"userPhone",valueType:"input",fieldProps:{placeholder:"",maxlength:11,type:"text","v-model.number":"",oninput:"value=value.replace(/[^\\d]/g,'')",pattern:"^1[3-9]\\d{9}$"}},{label:"关联订单",prop:"associatedOrderNo",valueType:"copy",fieldProps:{placeholder:""}},{label:"优惠券名称",prop:"name",valueType:"copy",fieldProps:{placeholder:""}},{label:"状态",prop:"status",valueType:"select",options:[{label:"全部状态",value:""},{label:"未使用",value:"UNUSED"},{label:"已使用",value:"USED"},{label:"已过期",value:"EXPIRED"}],fieldProps:{placeholder:"请选择"}},{label:"优惠券号",prop:"couponUserId",valueType:"copy",fieldProps:{placeholder:""}},{label:"赠券用户",prop:"giftUserPhone",valueType:"copy",fieldProps:{placeholder:""}}],i={PRICE_DISCOUNT:"无门槛折扣券",PRICE_REDUCE:"无门槛现金券",REQUIRED_PRICE_DISCOUNT:"满折券",REQUIRED_PRICE_REDUCE:"满减券"},x=e.ref([]),V=e.ref([]),T=()=>{c.value={status:"",associatedOrderNo:"",name:"",userPhone:"",giftUserPhone:"",couponUserId:""},d()},d=async()=>{const{code:n,data:o}=await k({...c.value,page:r.value.current,size:r.value.size});n===200&&(x.value=o.records,r.value.total=o.total)};d();function q(n){V.value=n}const v=async()=>{var w;let n={};const{status:o,userPhone:_,associatedOrderNo:m,name:t,giftUserPhone:u,couponUserId:g}=c.value;n={status:o,userPhone:_,associatedOrderNo:m,name:t,giftUserPhone:u,couponUserId:g},n.exportCouponUserIds=((w=V.value)==null?void 0:w.map(F=>F.couponUserId))||[];const{code:b,msg:a}=await R(n);b===200?l.ElMessage.success({message:a||"导出成功"}):l.ElMessage.error({message:a||"导出失败"})},L=n=>{r.value.current=n,d()},B=n=>{r.value.size=n,d()},h=e.ref(!1),O=[{status:"待使用",description:"该优惠券未核销"},{status:"已使用",description:"该优惠券已使用"},{status:"已过期",description:"优惠券未使用并且超过有效期"},{status:"平台赠送",description:"平台运营人员赠送的会员优惠券"},{status:"店铺赠送",description:"店铺运营人员赠送的会员优惠券"},{status:"手动领取",description:"用户自行领取的优惠券"},{status:"关联订单",description:"优惠券在哪笔订单中使用"},{status:"赠券用户",description:"该优惠券是由哪个系统用户赠送会员的"}];return(n,o)=>{const _=e.resolveComponent("el-button"),m=e.resolveComponent("el-config-provider"),t=e.resolveComponent("el-table-column"),u=e.resolveComponent("el-table"),g=e.resolveComponent("ElTableEmpty"),b=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock("div",P,[e.createElementVNode("div",U,[e.createVNode(m,{"empty-values":[void 0,null]},{default:e.withCtx(()=>[e.createVNode(N,{modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=a=>c.value=a),columns:p,onSearchHandle:d,onHandleReset:T},{otherOperations:e.withCtx(()=>[e.createVNode(_,{type:"primary",onClick:v},{default:e.withCtx(()=>o[3]||(o[3]=[e.createTextVNode("导出")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createElementVNode("div",z,[e.createElementVNode("div",D,[e.createVNode(E,{name:"icon-wenhao",size:"18px",onClick:o[1]||(o[1]=a=>h.value=!0)})])]),e.createElementVNode("div",I,[e.createVNode(u,{ref:"multipleTableRef","cell-style":{color:"#333333",height:"60px"},data:x.value,"header-cell-style":{background:"#F7F8FA",height:"48px"},"header-row-style":{color:"#333"},onSelectionChange:q},{default:e.withCtx(()=>[e.createVNode(t,{type:"selection",width:"30",fixed:"left",label:"全选"}),e.createVNode(t,{label:"优惠券号",prop:"couponUserId",width:"180"}),e.createVNode(t,{label:"用户",prop:"userNickname",width:"120"}),e.createVNode(t,{label:"手机号",prop:"userPhone",width:"120"}),e.createVNode(t,{label:"优惠券名称",prop:"name",width:"120"}),e.createVNode(t,{label:"面值",prop:"parValue",width:"90"}),e.createVNode(t,{label:"状态",prop:"queryStatus",width:"120"},{default:e.withCtx(({row:a})=>[e.createElementVNode("span",null,e.toDisplayString(a.queryStatus==="UNUSED"?"未使用":a.queryStatus==="USED"?"已使用":"已过期"),1)]),_:1}),e.createVNode(t,{label:"优惠券类型",prop:"type",width:"120"},{default:e.withCtx(({row:a})=>[e.createElementVNode("span",null,e.toDisplayString(i[a.type]),1)]),_:1}),e.createVNode(t,{label:"优惠券规则",prop:"typeDescription",width:"150"}),e.createVNode(t,{label:"领取方式",prop:"collectTypeText",width:"100"}),e.createVNode(t,{label:"关联订单",prop:"associatedOrderNo",width:"200"}),e.createVNode(t,{label:"领券时间",prop:"createTime",width:"160"}),e.createVNode(t,{label:"到期时间",prop:"endDate",width:"160"}),e.createVNode(t,{label:"赠券用户",prop:"giftUserPhone",width:"120"})]),_:1},8,["data"])]),e.createVNode(C,{"page-size":r.value.size,"page-num":r.value.current,total:r.value.total,onHandleCurrentChange:L,onHandleSizeChange:B},null,8,["page-size","page-num","total"]),e.createVNode(b,{modelValue:h.value,"onUpdate:modelValue":o[2]||(o[2]=a=>h.value=a),title:"用券记录说明",center:"",width:"573px"},{default:e.withCtx(()=>[e.createVNode(u,{data:O,border:"",class:"description_table","header-cell-style":{background:"#BEBEBE",color:"#000",height:"36px"}},{empty:e.withCtx(()=>[e.createVNode(g)]),default:e.withCtx(()=>[e.createVNode(t,{prop:"status",label:"字段",width:"120"}),e.createVNode(t,{prop:"description",label:"说明"})]),_:1})]),_:1},8,["modelValue"])])])}}}),A="";return((s,c)=>{const r=s.__vccOpts||s;for(const[p,i]of c)r[p]=i;return r})(S,[["__scopeId","data-v-3b03d543"]])});

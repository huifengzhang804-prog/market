(function(e,_){typeof exports=="object"&&typeof module<"u"?module.exports=_(require("vue"),require("vue-router"),require("@/components/BetterPageManage/BetterPageManage.vue"),require("@/components/SchemaForm.vue"),require("decimal.js"),require("@/apis/http"),require("element-plus"),require("@/components/element-plus/el-table/ElTableEmpty/index.vue"),require("@/components/chrome-tab/index.vue")):typeof define=="function"&&define.amd?define(["vue","vue-router","@/components/BetterPageManage/BetterPageManage.vue","@/components/SchemaForm.vue","decimal.js","@/apis/http","element-plus","@/components/element-plus/el-table/ElTableEmpty/index.vue","@/components/chrome-tab/index.vue"],_):(e=typeof globalThis<"u"?globalThis:e||self,e.PlatformSeckillList=_(e.PlatformSeckillListContext.Vue,e.PlatformSeckillListContext.VueRouter,e.PlatformSeckillListContext.PageManage,e.PlatformSeckillListContext.SchemaForm,e.PlatformSeckillListContext.Decimal,e.PlatformSeckillListContext.Request,e.PlatformSeckillListContext.ElementPlus,e.PlatformSeckillListContext.ElTableEmpty,e.PlatformSeckillListContext.ChromeTab))})(this,function(e,_,S,L,ce,b,f,E,F){"use strict";var x=document.createElement("style");x.textContent=`@charset "UTF-8";*,:before,:after{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }::backdrop{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }.absolute{position:absolute}.fixed{position:fixed}.flex{display:flex}.resize{resize:both}[resize~=none]{resize:none}.blur{--un-blur:blur(8px);filter:var(--un-blur) var(--un-brightness) var(--un-contrast) var(--un-drop-shadow) var(--un-grayscale) var(--un-hue-rotate) var(--un-invert) var(--un-saturate) var(--un-sepia)}.name[data-v-1839ca45]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[data-v-1839ca45] .el-button.is-link{padding:0}[data-v-1839ca45] .el-button+.el-button{margin-left:10px}.submit-btn[data-v-1839ca45]{position:absolute;width:100%;text-align:center;padding:10px;bottom:0;left:0;background:#fff;z-index:999;box-shadow:0 0 10px #d5d5d5}.el-dialog__body{padding:20px 20px 0}[data-v-1839ca45] .el-table__body-wrapper .el-table__body .el-table__row .cell .el-button{padding:0}
`,document.head.appendChild(x);var r=(a=>(a.NOT_START="NOT_START",a.IN_PROGRESS="IN_PROGRESS",a.FINISHED="FINISHED",a.OFF_SHELF="OFF_SHELF",a.VIOLATION_OFF_SHELF="VIOLATION_OFF_SHELF",a.ALL="",a))(r||{});const k={"":"全部状态",NOT_START:"未开始",IN_PROGRESS:"进行中",FINISHED:"已结束",OFF_SHELF:"已下架",VIOLATION_OFF_SHELF:"违规下架"},V="addon-seckill/seckill/activity",T=a=>b.post({url:`${V}/page`,data:a}),O=a=>b.post({url:`${V}/off/shelf`,data:a}),I=a=>b.post({url:"addon-seckill/common/config/seckill",data:{duration:a}}),z=a=>b.get({url:"addon-seckill/common/config/seckill"}),de="",P={class:"q_plugin_container"},A={key:0,class:"fdc1 overh"},R={class:"table_container"},H={class:"name"},B={class:"name"},D={class:"dialog-footer"},q={key:1},M={style:{padding:"16px",display:"flex","align-items":"center"}},U={class:"submit-btn"},G=e.defineComponent({__name:"PlatformSeckillList",setup(a){const h=_.useRouter(),c=e.ref("activity"),d=e.ref(""),y=[1,2,3,4,6,8,12,24],l=e.reactive({showDialog:!1,row:void 0,violation:"",edit:!1}),N=e.ref([]),g=e.reactive({name:"",status:r.ALL}),i=e.reactive({size:10,current:1,total:0}),w=e.ref(),j=[{label:"秒杀活动",name:"activity"},{label:"活动设置",name:"setUp"}],K=[{label:"活动名称",prop:"name",valueType:"copy",fieldProps:{placeholder:"请输入活动名称"}},{label:"活动状态",labelWidth:75,prop:"status",valueType:"select",options:Object.entries(k).map(([o,t])=>({label:t,value:o})),fieldProps:{placeholder:"请选择"}}],$=o=>{o&&(c.value=o)};async function p(){const{code:o,data:t}=await T({...g,...i});if(o!==200)return f.ElMessage.error("获取活动列表失败");N.value=t.records,i.current=t.current,i.size=t.size,i.total=t.total}p();const v=()=>{Object.keys(g).forEach(o=>g[o]=""),p()},W=o=>{i.size=o,p()},J=o=>{i.current=o,p()},X=(o,t)=>{h.push({name:"secondsKillEdit",query:{shopId:o,secKillId:t}})},Y=async o=>{l.showDialog=!0,l.row=o,l.edit=o.status!==r.VIOLATION_OFF_SHELF},Z=()=>{w.value.validate(async(o,t)=>{if(o){const u=l.row,{code:s}=await O({shopId:u.shopId,activityId:u.activityId,reason:l.violation});if(s!==200){f.ElMessage.error("下架失败");return}f.ElMessage.success("下架成功"),l.showDialog=!1,u.violation=l.violation,u.status=r.VIOLATION_OFF_SHELF}else console.log("error submit!",t)})},C=()=>{l.showDialog=!1,l.row=void 0,l.violation="",l.edit=!1};(async()=>{const{code:o,data:t}=await z();console.log(o,t),o===200&&(d.value=t.duration)})();const Q=async()=>{const{code:o,msg:t}=await I(d.value);o===200?(f.ElMessage.success("活动设置成功"),p()):f.ElMessage.error(t||"活动设置失败")};return(o,t)=>{const u=e.resolveComponent("el-config-provider"),s=e.resolveComponent("el-table-column"),m=e.resolveComponent("el-button"),ee=e.resolveComponent("el-tooltip"),te=e.resolveComponent("el-table"),ne=e.resolveComponent("el-input"),oe=e.resolveComponent("el-form-item"),ae=e.resolveComponent("el-form"),le=e.resolveComponent("el-dialog"),re=e.resolveComponent("el-option"),ie=e.resolveComponent("el-select");return e.openBlock(),e.createElementBlock("div",P,[e.createVNode(F,{"tab-list":j,value:c.value,onHandleTabs:$},null,8,["value"]),c.value==="activity"?(e.openBlock(),e.createElementBlock("div",A,[e.createVNode(u,{"empty-values":[void 0,null]},{default:e.withCtx(()=>[e.createVNode(L,{modelValue:g,"onUpdate:modelValue":t[0]||(t[0]=n=>g=n),columns:K,onSearchHandle:p,onHandleReset:v},null,8,["modelValue"])]),_:1}),e.createElementVNode("div",R,[e.createVNode(te,{ref:"multipleTableRef",data:N.value,"header-row-style":{fontSize:"14px",color:"#333"},"header-cell-style":{background:"#f6f8fa",height:"50px"}},{empty:e.withCtx(()=>[e.createVNode(E,{imageIndex:"7"})]),default:e.withCtx(()=>[e.createVNode(s,{label:"店铺名称",width:"200"},{default:e.withCtx(({row:n})=>[e.createElementVNode("span",H,e.toDisplayString(n.shopName),1)]),_:1}),e.createVNode(s,{label:"活动名称",width:"200"},{default:e.withCtx(({row:n})=>[e.createElementVNode("span",B,e.toDisplayString(n.name),1)]),_:1}),e.createVNode(s,{label:"状态",width:"140"},{default:e.withCtx(({row:n})=>[e.createElementVNode("span",{style:e.normalizeStyle({color:[e.unref(r).VIOLATION_OFF_SHELF].includes(n.status)?"#F54319":[e.unref(r).FINISHED,e.unref(r).OFF_SHELF].includes(n.status)?"#999":"#333"})},e.toDisplayString(e.unref(k)[n.status]),5)]),_:1}),e.createVNode(s,{label:"活动时间",width:"230"},{default:e.withCtx(({row:n})=>[e.createElementVNode("div",null,e.toDisplayString(n.startTime),1),e.createElementVNode("div",null,e.toDisplayString(n.endTime),1)]),_:1}),e.createVNode(s,{label:"活动商品",width:"140"},{default:e.withCtx(({row:n})=>[e.createTextVNode(e.toDisplayString(n.product),1)]),_:1}),e.createVNode(s,{label:"支付单数",width:"140"},{default:e.withCtx(({row:n})=>[e.createTextVNode(e.toDisplayString(n.payOrder),1)]),_:1}),e.createVNode(s,{fixed:"right",align:"right",label:"操作"},{default:e.withCtx(({row:n})=>[e.createVNode(m,{link:"",type:"primary",onClick:se=>X(n.shopId,n.activityId)},{default:e.withCtx(()=>t[4]||(t[4]=[e.createTextVNode("查看 ")])),_:2},1032,["onClick"]),n.status===e.unref(r).NOT_START||n.status===e.unref(r).IN_PROGRESS?(e.openBlock(),e.createBlock(m,{key:0,link:"",type:"danger",onClick:se=>Y(n)},{default:e.withCtx(()=>t[5]||(t[5]=[e.createTextVNode(" 违规下架 ")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0),n.status===e.unref(r).VIOLATION_OFF_SHELF?(e.openBlock(),e.createBlock(ee,{key:1,class:"box-item",effect:"dark",content:n.violation,placement:"bottom-end"},{default:e.withCtx(()=>[e.createVNode(m,{link:"",type:"primary"},{default:e.withCtx(()=>t[6]||(t[6]=[e.createTextVNode("违规原因 ")])),_:1})]),_:2},1032,["content"])):e.createCommentVNode("",!0)]),_:1})]),_:1},8,["data"])]),e.createVNode(S,{"page-size":i.size,total:i.total,"page-num":i.current,onHandleSizeChange:W,onHandleCurrentChange:J},null,8,["page-size","total","page-num"]),e.createVNode(le,{modelValue:l.showDialog,"onUpdate:modelValue":t[2]||(t[2]=n=>l.showDialog=n),center:"",title:"违规下架",width:"500",onClose:C},e.createSlots({default:e.withCtx(()=>[l.edit?(e.openBlock(),e.createBlock(ae,{key:0,ref_key:"illegalReasonFormRef",ref:w,model:l,rules:{violation:[{required:!0,message:"请输入违规原因",trigger:"blur"}]},"status-icon":""},{default:e.withCtx(()=>[e.createVNode(oe,{label:"",prop:"violation"},{default:e.withCtx(()=>[e.createVNode(ne,{modelValue:l.violation,"onUpdate:modelValue":t[1]||(t[1]=n=>l.violation=n),maxlength:"50",placeholder:"请输入违规原因，必填",resize:"none","show-word-limit":"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):e.createCommentVNode("",!0)]),_:2},[l.edit?{name:"footer",fn:e.withCtx(()=>[e.createElementVNode("div",D,[e.createVNode(m,{onClick:C},{default:e.withCtx(()=>t[7]||(t[7]=[e.createTextVNode("取消")])),_:1}),e.createVNode(m,{type:"primary",onClick:Z},{default:e.withCtx(()=>t[8]||(t[8]=[e.createTextVNode("确定 ")])),_:1})])]),key:"0"}:void 0]),1032,["modelValue"])])):(e.openBlock(),e.createElementBlock("div",q,[e.createElementVNode("div",M,[t[9]||(t[9]=e.createElementVNode("label",{style:{"margin-right":"10px"}},"活动时长",-1)),e.createVNode(ie,{modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=n=>d.value=n),placeholder:"",style:{width:"220px"}},{default:e.withCtx(()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(y,n=>e.createVNode(re,{key:n,label:n,value:n},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t[10]||(t[10]=e.createElementVNode("span",{style:{"margin-left":"10px"}},"小时",-1)),t[11]||(t[11]=e.createElementVNode("div",{style:{"margin-left":"40px",color:"#999"}},"每场活动的持续时间",-1))]),e.createElementVNode("div",U,[e.createVNode(m,{type:"primary",onClick:Q},{default:e.withCtx(()=>t[12]||(t[12]=[e.createTextVNode("保存")])),_:1})])]))])}}}),pe="",ue="",me="";return((a,h)=>{const c=a.__vccOpts||a;for(const[d,y]of h)c[d]=y;return c})(G,[["__scopeId","data-v-1839ca45"]])});

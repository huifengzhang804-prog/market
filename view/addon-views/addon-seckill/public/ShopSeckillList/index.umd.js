(function(e,_){typeof exports=="object"&&typeof module<"u"?module.exports=_(require("vue"),require("vue-router"),require("@vueuse/core"),require("@/components/SchemaForm.vue"),require("@/components/BetterPageManage/BetterPageManage.vue"),require("decimal.js"),require("@/apis/http"),require("element-plus")):typeof define=="function"&&define.amd?define(["vue","vue-router","@vueuse/core","@/components/SchemaForm.vue","@/components/BetterPageManage/BetterPageManage.vue","decimal.js","@/apis/http","element-plus"],_):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopSeckillList=_(e.ShopSeckillListContext.Vue,e.ShopSeckillListContext.VueRouter,e.ShopSeckillListContext.VueUse,e.ShopSeckillListContext.SchemaForm,e.ShopSeckillListContext.PageManage,e.ShopSeckillListContext.Decimal,e.ShopSeckillListContext.Request,e.ShopSeckillListContext.ElementPlus))})(this,function(e,_,E,F,O,K,b,p){"use strict";var N=document.createElement("style");N.textContent=`@charset "UTF-8";*,:before,:after{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }::backdrop{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow-inset: ;--un-shadow:0 0 rgba(0,0,0,0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,.5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }.fixed,[fixed=\"\"]{position:fixed}.disabled{opacity:.5;cursor:not-allowed}.container[data-v-120660d6]{overflow-y:scroll}[data-v-120660d6] .el-button.is-link{padding:0}[data-v-120660d6] .el-button+.el-button{margin-left:10px}
`,document.head.appendChild(N);const T=e.defineComponent({__name:"head-search",props:{modelValue:{type:Object,default(){return{}}}},emits:["update:modelValue","search"],setup(o,{emit:h}){const m=o,f=[{label:"活动名称",prop:"name",valueType:"copy",fieldProps:{placeholder:"请输入活动名称"}},{label:"活动状态",prop:"status",valueType:"select",options:[{value:"",label:"全部状态"},{value:"NOT_START",label:"未开始"},{value:"IN_PROGRESS",label:"进行中"},{value:"FINISHED",label:"已结束"},{value:"OFF_SHELF",label:"已下架"},{value:"VIOLATION_OFF_SHELF",label:"违规下架"}],fieldProps:{placeholder:"请选择"}}],s=h,i=E.useVModel(m,"modelValue",s),k=()=>{Object.keys(i.value).forEach(g=>i.value[g]=""),s("search")};return(g,l)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(F,{modelValue:e.unref(i),"onUpdate:modelValue":l[0]||(l[0]=u=>e.isRef(i)?i.value=u:null),columns:f,onSearchHandle:l[1]||(l[1]=u=>s("search")),onHandleReset:k},null,8,["modelValue"]),l[2]||(l[2]=e.createElementVNode("div",{class:"grey_bar"},null,-1))],64))}});var r=(o=>(o.NOT_START="NOT_START",o.IN_PROGRESS="IN_PROGRESS",o.FINISHED="FINISHED",o.OFF_SHELF="OFF_SHELF",o.VIOLATION_OFF_SHELF="VIOLATION_OFF_SHELF",o.ALL="",o))(r||{});const w={"":"全部状态",NOT_START:"未开始",IN_PROGRESS:"进行中",FINISHED:"已结束",OFF_SHELF:"已下架",VIOLATION_OFF_SHELF:"违规下架"},x="addon-seckill/seckill/activity",I=o=>b.post({url:x+"/delete",data:o}),R=o=>b.post({url:`${x}/page`,data:o}),z=o=>b.post({url:`${x}/off/shelf`,data:o}),J="",B={class:"q_plugin_container"},H={class:"handle_container",style:{"padding-top":"16px"}},A={class:"table_container"},D=e.defineComponent({__name:"ShopSeckillList",setup(o){const h=_.useRouter(),m=_.useRoute(),f=e.ref(""),s=e.ref([]),i=e.ref(!1),k=e.ref(),g=e.reactive({name:"",status:r.ALL}),l=e.reactive({size:10,current:1,total:0});e.watch(()=>m.query.flag,a=>{a&&u()});async function u(){const{code:a,data:t}=await R({...g,...l});if(a!==200)return p.ElMessage.error("获取活动列表失败");s.value=t.records,l.current=t.current,l.size=t.size,l.total=t.total}u();const C=a=>{a!=null&&a.length&&p.ElMessageBox.confirm("确定删除选中的活动?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:async t=>{if(t==="cancel")return;const{code:S}=await I(a);if(S!==200){p.ElMessage.error("删除失败");return}const c=new Set(a);s.value=s.value.filter(d=>!c.has(d.activityId)),l.total-=c.size,p.ElMessage.success("删除成功")}})},y=e.ref([]),M=a=>{y.value=a},q=a=>{l.size=a,u()},P=a=>{l.current=a,u()},G=a=>{p.ElMessageBox.confirm("确定下架选中活动?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:async t=>{if(t==="cancel")return;const{code:S}=await z({activityId:a.activityId});if(S!==200){p.ElMessage.error("下架失败");return}p.ElMessage.success("下架成功"),a.status=r.OFF_SHELF}})},$=async a=>{f.value=a,i.value=!0},L=(a,t)=>{h.push({name:"seckillCreate",query:{shopId:a,secKillId:t}})};return(a,t)=>{const S=e.resolveComponent("el-config-provider"),c=e.resolveComponent("el-button"),d=e.resolveComponent("el-table-column"),U=e.resolveComponent("el-table"),j=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock("div",B,[e.createVNode(S,{"empty-values":[void 0,null]},{default:e.withCtx(()=>[e.createVNode(T,{modelValue:g,"onUpdate:modelValue":t[0]||(t[0]=n=>g=n),onSearch:u},null,8,["modelValue"])]),_:1}),e.createElementVNode("div",H,[e.createVNode(c,{round:"",type:"primary",onClick:t[1]||(t[1]=()=>L())},{default:e.withCtx(()=>t[5]||(t[5]=[e.createTextVNode("新增秒杀")])),_:1}),e.createVNode(c,{disabled:!y.value.length,round:"",onClick:t[2]||(t[2]=()=>C(y.value.filter(n=>n.status!==e.unref(r).IN_PROGRESS).map(n=>n.activityId)))},{default:e.withCtx(()=>t[6]||(t[6]=[e.createTextVNode("批量删除 ")])),_:1},8,["disabled"])]),e.createElementVNode("div",A,[e.createVNode(U,{ref_key:"multipleTableRef",ref:k,"header-cell-style":{background:"#f6f8fa",height:"48px"},"header-row-style":{color:"#333"},data:s.value,onSelectionChange:M},{default:e.withCtx(()=>[e.createVNode(d,{selectable:n=>n.status!==e.unref(r).IN_PROGRESS,align:"center",fixed:"",type:"selection",width:"30"},null,8,["selectable"]),e.createVNode(d,{label:"活动名称",width:"220"},{default:e.withCtx(({row:n})=>[e.createTextVNode(e.toDisplayString(n.name),1)]),_:1}),e.createVNode(d,{label:"状态",width:"160"},{default:e.withCtx(({row:n})=>[e.createElementVNode("span",{style:e.normalizeStyle({color:[e.unref(r).VIOLATION_OFF_SHELF].includes(n.status)?"#F54319":[e.unref(r).OFF_SHELF,e.unref(r).FINISHED].includes(n.status)?"#999":"#333"})},e.toDisplayString(e.unref(w)[n.status]),5)]),_:1}),e.createVNode(d,{label:"活动时间",width:"300"},{default:e.withCtx(({row:n})=>[e.createElementVNode("div",null,"起："+e.toDisplayString(n.startTime),1),e.createElementVNode("div",null,"止："+e.toDisplayString(n.endTime),1)]),_:1}),e.createVNode(d,{label:"活动商品",width:"140"},{default:e.withCtx(({row:n})=>[e.createTextVNode(e.toDisplayString(n.product),1)]),_:1}),e.createVNode(d,{label:"支付单数",width:"140"},{default:e.withCtx(({row:n})=>[e.createElementVNode("span",null,e.toDisplayString(n.payOrder||0),1)]),_:1}),e.createVNode(d,{fixed:"right",label:"操作",align:"right"},{default:e.withCtx(({row:n})=>[e.createVNode(c,{link:"",type:"primary",onClick:V=>L(n.shopId,n.activityId)},{default:e.withCtx(()=>t[7]||(t[7]=[e.createTextVNode("查看 ")])),_:2},1032,["onClick"]),n.status===e.unref(r).IN_PROGRESS?(e.openBlock(),e.createBlock(c,{key:0,link:"",type:"primary",onClick:V=>G(n)},{default:e.withCtx(()=>t[8]||(t[8]=[e.createTextVNode("下架 ")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0),n.status===e.unref(r).VIOLATION_OFF_SHELF?(e.openBlock(),e.createBlock(c,{key:1,link:"",type:"primary",onClick:V=>$(n==null?void 0:n.violation)},{default:e.withCtx(()=>t[9]||(t[9]=[e.createTextVNode("违规原因 ")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0),n.status!==e.unref(r).IN_PROGRESS?(e.openBlock(),e.createBlock(c,{key:2,link:"",type:"danger",onClick:V=>C([n.activityId])},{default:e.withCtx(()=>t[10]||(t[10]=[e.createTextVNode("删除 ")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0)]),_:1})]),_:1},8,["data"])]),e.createVNode(O,{"page-size":l.size,total:l.total,"page-num":l.current,onHandleSizeChange:q,onHandleCurrentChange:P},null,8,["page-size","total","page-num"]),e.createVNode(j,{modelValue:i.value,"onUpdate:modelValue":t[3]||(t[3]=n=>i.value=n),center:"",title:"违规原因",width:"500",onClose:t[4]||(t[4]=()=>f.value="")},{default:e.withCtx(()=>[e.createElementVNode("span",null,e.toDisplayString(f.value),1)]),_:1},8,["modelValue"])])}}}),W="";return((o,h)=>{const m=o.__vccOpts||o;for(const[f,s]of h)m[f]=s;return m})(D,[["__scopeId","data-v-120660d6"]])});

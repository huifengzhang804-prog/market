(function(e,h){typeof exports=="object"&&typeof module<"u"?module.exports=h(require("vue"),require("@/components/PageManage.vue"),require("element-plus"),require("@/apis/http"),require("@/composables/useConvert"),require("@/store/modules/shopInfo")):typeof define=="function"&&define.amd?define(["vue","@/components/PageManage.vue","element-plus","@/apis/http","@/composables/useConvert","@/store/modules/shopInfo"],h):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopDecorationSeckillSelectGood=h(e.ShopDecorationSeckillSelectGoodContext.Vue,e.ShopDecorationSeckillSelectGoodContext.PageManageTwo,e.ShopDecorationSeckillSelectGoodContext.ElementPlus,e.ShopDecorationSeckillSelectGoodContext.Request,e.ShopDecorationSeckillSelectGoodContext.UseConvert,e.ShopDecorationSeckillSelectGoodContext.ShopInfoStore))})(this,function(e,h,g,y,w,I){"use strict";var b=document.createElement("style");b.textContent=`@charset "UTF-8";.title[data-v-5883f527]{font-size:15px;font-weight:700;display:flex;margin-bottom:20px;margin-top:-20px}.digGoods[data-v-5883f527]{border-top:1px solid #d7d7d7;padding-top:10px}.digGoods__box[data-v-5883f527]{background-color:#f2f2f2;padding:10px}.digGoods__box--top[data-v-5883f527]{display:flex;justify-content:space-between}.digGoods__box--content[data-v-5883f527]{margin-top:10px;background-color:#fff;border-radius:5px;display:flex;flex-wrap:wrap;padding:5px}.digGoods__box--content--good[data-v-5883f527]{width:33%;margin-left:2px;margin-bottom:4px;height:80px;border-radius:5px;padding:5px;display:flex}.digGoods__box--content--good--img[data-v-5883f527]{width:65px;height:65px;position:relative}.digGoods__box--content--good--imgShadow[data-v-5883f527]{width:65px;height:65px;position:absolute;background-color:#0009;display:flex;justify-content:center;align-items:center}.digGoods__box--content--good--shopName[data-v-5883f527]{margin-left:10px;font-size:12px;display:flex;flex-direction:column;justify-content:space-between}.digGoods__box--bottom[data-v-5883f527]{display:flex;justify-content:space-between;align-items:center}.serachBtn[data-v-5883f527]{width:32px;height:32px;display:flex;justify-content:center;align-items:center;border:1px solid #dcdfe6;background-color:#fff;cursor:pointer;border-left:none;border-radius:4px}
`,document.head.appendChild(b);const B=i=>y.get({url:`addon-seckill/seckillPromotion/notStartedAndProcessing?size=1000&shopId=${i}`}),D=i=>y.get({url:"addon-seckill/seckillPromotion/secKillProduct",params:i}),z={class:"digGoods"},T={class:"digGoods__box"},j={class:"digGoods__box--top"},M={key:0,class:"digGoods__box--content"},P=["onClick"],q=["src"],v={key:0,class:"digGoods__box--content--good--imgShadow"},L={class:"digGoods__box--content--good--shopName"},O={key:1,class:"digGoods__box--content",style:{display:"flex","justify-content":"center","align-items":"center",height:"250px"}},$={class:"digGoods__box--bottom"},A=e.defineComponent({__name:"ShopDecorationSeckillSelectGood",props:{properties:{type:Object,default:()=>{}}},setup(i,{expose:C}){const m=i,x=I.useShopInfoStore(),{divTenThousand:u}=w(),p=e.ref([]),_=e.ref([]),G=e.ref([]),a=e.ref(!1),s=e.shallowReactive({current:1,size:10,total:0,choosedSession:""});e.watch(m.properties,async o=>{o.goodsVisible&&(R(),_.value=JSON.parse(JSON.stringify(o.pointGoodsList)),Q(),await W(),S())},{immediate:!0}),C({tempGoods:_,search:s,goodsList:p,allChecked:a});const V={borderGet:"2px solid #2D8CF0",borderNoGet:"2px solid #f2f2f2"},F=o=>{s.choosedSession=o,S()},U=o=>{o.isCheck=!o.isCheck;const t=_.value;if(t.length>=16)return g.ElMessage.error("最多选择16个商品"),!1;if(o.isCheck)t.push(o);else{const c=t.findIndex(r=>r.productId===o.productId);c!==-1&&t.splice(c,1)}},H=()=>{let o=!1;const t=p.value,c=_.value,r=a.value;if(t.map(d=>{if(r){if(c.length>=16)return o=!0;c.find(l=>l.productId===d.productId)||c.push(d)}return d.isCheck=r}),o)return g.ElMessage.error("自多选择16个商品");r||t.forEach(d=>{const l=c.findIndex(f=>f.productId===d.productId);l!==-1&&c.splice(l,1)})},J=o=>{s.size=o,S()},K=o=>{s.current=o,a.value=!1,S()};async function R(){s.current=1,s.size=10,a.value=!1}async function Q(){let o=!0;p.value.forEach(t=>{const c=E(t.productId);t.isCheck=c,o=o&&c}),a.value=o}async function W(){const{code:o,data:t}=await B(x.getterShopInfo.id);o===200?t.records.length&&(G.value=t.records,s.choosedSession=t.records[0].startTime):g.ElMessage.error("获取场次失败")}async function S(){const{current:o,size:t,choosedSession:c}=s;if(!s.choosedSession)return g.ElMessage.warning("请先选中场次");const{code:r,data:d}=await D({current:o,size:t,startTime:c,shopId:x.getterShopInfo.id});if(r!==200)return g.ElMessage.error("获取商品失败");if(d.records.length){let l=!0;d.records.forEach(f=>{const k=E(f.productId);f.isCheck=k,l=l&&k}),a.value=l,p.value=d.records,s.total=d.total}}function E(o){return _.value.findIndex(t=>t.productId===o)!==-1}return(o,t)=>{const c=e.resolveComponent("el-option"),r=e.resolveComponent("el-option-group"),d=e.resolveComponent("el-select"),l=e.resolveComponent("i-ep-check"),f=e.resolveComponent("el-icon"),k=e.resolveComponent("el-checkbox");return e.openBlock(),e.createElementBlock("div",null,[t[3]||(t[3]=e.createElementVNode("div",{class:"title"},"选择商品",-1)),e.createElementVNode("div",z,[e.createElementVNode("div",T,[e.createElementVNode("div",j,[e.createVNode(d,{modelValue:e.unref(s).choosedSession,"onUpdate:modelValue":t[0]||(t[0]=n=>e.unref(s).choosedSession=n),style:{width:"190px"},placeholder:"全部分类"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(G.value,n=>(e.openBlock(),e.createBlock(r,{key:n.startTime},{default:e.withCtx(()=>[e.createVNode(c,{label:n.startTime,value:n.startTime,onClick:N=>F(n.startTime)},null,8,["label","value","onClick"])]),_:2},1024))),128))]),_:1},8,["modelValue"])]),p.value.length>0?(e.openBlock(),e.createElementBlock("div",M,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,(n,N)=>(e.openBlock(),e.createElementBlock("div",{key:N,class:"digGoods__box--content--good",style:e.normalizeStyle({border:n.isCheck?V.borderGet:V.borderNoGet}),onClick:ee=>U(n)},[e.createElementVNode("img",{src:n.productPic,class:"digGoods__box--content--good--img"},null,8,q),n.isCheck?(e.openBlock(),e.createElementBlock("div",v,[e.createVNode(f,{color:"#fff",size:"40px"},{default:e.withCtx(()=>[e.createVNode(l)]),_:1})])):e.createCommentVNode("",!0),e.createElementVNode("div",L,[e.createElementVNode("div",null,e.toDisplayString(n.productName),1),e.createElementVNode("div",null,"￥"+e.toDisplayString(e.unref(u)(n.minPrice))+"-￥"+e.toDisplayString(e.unref(u)(n.maxPrice)),1)])],12,P))),128))])):e.createCommentVNode("",!0),p.value.length===0?(e.openBlock(),e.createElementBlock("div",O," 暂无相关商品信息，请选择其他时段 ")):e.createCommentVNode("",!0),e.createElementVNode("div",$,[e.createVNode(k,{modelValue:a.value,"onUpdate:modelValue":t[1]||(t[1]=n=>a.value=n),style:{"margin-top":"40px"},onChange:H},{default:e.withCtx(()=>t[2]||(t[2]=[e.createTextVNode("全选")])),_:1},8,["modelValue"]),e.createVNode(h,{"page-size":e.unref(s).size,"page-num":e.unref(s).current,total:e.unref(s).total,onHandleSizeChange:J,onHandleCurrentChange:K},null,8,["page-size","page-num","total"])])])])])}}}),X="";return((i,C)=>{const m=i.__vccOpts||i;for(const[x,u]of C)m[x]=u;return m})(A,[["__scopeId","data-v-5883f527"]])});

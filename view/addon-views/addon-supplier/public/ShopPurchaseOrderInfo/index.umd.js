(function(e,F){typeof exports=="object"&&typeof module<"u"?module.exports=F(require("vue"),require("vue-router"),require("decimal.js"),require("element-plus"),require("vue-clipboard3"),require("@/composables/useConvert"),require("@/components/q-upload/q-upload.vue"),require("@/apis/http")):typeof define=="function"&&define.amd?define(["vue","vue-router","decimal.js","element-plus","vue-clipboard3","@/composables/useConvert","@/components/q-upload/q-upload.vue","@/apis/http"],F):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopPurchaseOrderInfo=F(e.ShopPurchaseOrderInfoContext.Vue,e.ShopPurchaseOrderInfoContext.VueRouter,e.ShopPurchaseOrderInfoContext.Decimal,e.ShopPurchaseOrderInfoContext.ElementPlus,e.ShopPurchaseOrderInfoContext.VueClipboard3,e.ShopPurchaseOrderInfoContext.UseConvert,e.ShopPurchaseOrderInfoContext.QUpload,e.ShopPurchaseOrderInfoContext.Request))})(this,function(e,F,P,S,be,Ie,pe,A){"use strict";var me=document.createElement("style");me.textContent=`@charset "UTF-8";.el-form-item[data-v-e699432b]{margin-bottom:5px}.details[data-v-1d02d6c0]{overflow-y:auto;padding:0 30px 30px}.details__status[data-v-1d02d6c0]{display:flex;align-items:center}.details__status--steps[data-v-1d02d6c0]{padding:20px;margin:20px;width:700px;border-left:1px solid #d5d5d5}.details__status--title[data-v-1d02d6c0]{font-size:28px;font-weight:700;color:#515151;width:223px;text-align:center}.details__userInfo[data-v-1d02d6c0]{display:flex;margin-bottom:22px;padding:0 30px}.details__userInfo--left[data-v-1d02d6c0]{flex:.5}.details__userInfo--left div[data-v-1d02d6c0]:nth-of-type(n+2){margin-bottom:11px}.details__userInfo--right[data-v-1d02d6c0]{margin-left:30px;flex:.5}.details__userInfo--right div[data-v-1d02d6c0]:nth-of-type(n+2){margin-bottom:11px}.details__userInfo--title[data-v-1d02d6c0]{font-size:14px;color:#333;font-weight:700;margin:17px 0;display:flex;justify-content:space-between;align-items:center}.details__table--main[data-v-1d02d6c0]{height:300px}.details__table--main .commodity[data-v-1d02d6c0]{display:flex;align-items:stretch}.details__table--main .commodity .commodity__info[data-v-1d02d6c0]{margin-left:15px;flex:1;overflow:hidden;display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;text-align:left}.details__table--main .commodity .commodity__info--title[data-v-1d02d6c0]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%}.details__table--main .commodity .commodity__info--spec[data-v-1d02d6c0]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-size:.8em;width:100%}.details__subtotal[data-v-1d02d6c0]{display:flex;flex-direction:column;align-items:flex-end;width:100%;margin-top:30px;line-height:1.5}.details__subtotal--title[data-v-1d02d6c0]{font-size:1.3em;font-weight:600}.details__subtotal .pay-price[data-v-1d02d6c0]{font-size:1.2em}.details .text-red[data-v-1d02d6c0]{color:red}.proof-img[data-v-1d02d6c0]{width:350px;height:350px;object-fit:contain}.copy[data-v-1d02d6c0]{margin-left:5px;color:#409eff;cursor:pointer}.logisticsInfo[data-v-84c76846]{display:flex;justify-content:space-between}.logisticsInfo__left[data-v-84c76846]{flex:3}.logisticsInfo__right[data-v-84c76846]{flex:2}.logisticsInfo__timeline-con[data-v-84c76846]{max-height:500px;overflow:auto}.logisticsInfo__title[data-v-84c76846]{font-size:14px;color:#333;font-weight:700;margin:17px 0}.logisticsInfo__text[data-v-84c76846]{margin-bottom:11px}.logisticsInfo__timeline[data-v-84c76846]{margin-top:20px}.logisticsInfo__timeline li[data-v-84c76846]:nth-child(1) .el-timeline-item__timestamp{color:#000}.logisticsInfo__timeline--status[data-v-84c76846]{font-size:13px;font-weight:700;margin-right:10px;color:#838383}.logisticsInfo__timeline--time[data-v-84c76846]{color:#838383}.logisticsInfo__divider[data-v-84c76846]{height:4px;margin:0 -15px;background:#f2f2f2}[data-v-84c76846] .el-timeline-item__node--normal{left:0}[data-v-84c76846] .el-scrollbar__wrap{max-height:500px}
`,document.head.appendChild(me);const ke=(r={})=>A.put({url:"addon-supplier/supplier/order/pay",data:r}),Se=r=>A.get({url:`addon-supplier/supplier/order/delivery/${r}`}),Te=r=>A.get({url:`addon-supplier/supplier/order/${r}`}),Oe=(r,p)=>A.get({url:"gruul-mall-freight/logistics/node",params:{companyCode:r,waybillNo:p}}),Be=()=>A.get({url:"gruul-mall-overview/overview/shop/balance"}),Pe=()=>A.get({url:"addon-supplier/supplier/order/config/payment/method"}),we={class:"tab_container"},De=e.defineComponent({__name:"ShopPurchaseOrderInfo",setup(r){const p=e.ref("basic"),o={basic:e.defineAsyncComponent(()=>Promise.resolve().then(()=>Nt)),delivery:e.defineAsyncComponent(()=>Promise.resolve().then(()=>Ft))},t=e.ref(0),i=F.useRoute(),d=e.ref();async function y(){if(i.query.orderNo){const{code:u,data:c}=await Te(i.query.orderNo);d.value=c,t.value=Date.now()}}const g=e.computed(()=>{var u,c;return(c=(u=d==null?void 0:d.value)==null?void 0:u.orderItems)==null?void 0:c.filter(s=>s.packageStatus!=="WAITING_FOR_DELIVER").length});return y(),(u,c)=>{const s=e.resolveComponent("el-tab-pane"),h=e.resolveComponent("el-tabs");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",we,[e.createVNode(h,{modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=C=>p.value=C)},{default:e.withCtx(()=>[e.createVNode(s,{label:"订单信息",name:"basic"}),g.value&&g.value>0?(e.openBlock(),e.createBlock(s,{key:0,label:"物流信息",name:"delivery"})):e.createCommentVNode("",!0)]),_:1},8,["modelValue"])]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(o[p.value]),{key:t.value,order:d.value,reload:y},null,8,["order"]))],64)}}}),$e={待支付:1,待审核:2,待发货:2,部分发货:2,待入库:3,已完成:4,已关闭:1},Fe={OFFLINE:"线下支付",BALANCE:"余额支付"},{divTenThousand:de}=Ie(),{toClipboard:_e}=be(),Ae=(r,p)=>{const o=e.ref(!1),t=e.ref(),i=e.ref(null);t.value=r;const d=e.reactive({statusText:"",activeStep:0}),y=d.statusText=Me(r);d.activeStep=$e[y];const g=async()=>{var E,I;const m=await((E=i.value)==null?void 0:E.getPayOrderFormModel()),{code:l,msg:f}=await ke({...m,orderNo:(I=t.value)==null?void 0:I.no});l===200?(S.ElMessage.success("支付成功"),o.value=!1,p&&p()):S.ElMessage.error(f||"支付失败")},u=()=>{o.value=!0},c=async m=>{try{await _e(m),S.ElMessage.success("复制成功")}catch{S.ElMessage.error("复制失败")}},s=async()=>{var l,f,E,I,n,x,N,k,w,b,D,T,O;const m=`
            收货人姓名：${(E=(f=(l=t==null?void 0:t.value)==null?void 0:l.extra)==null?void 0:f.receiver)==null?void 0:E.name}

            联系人电话：${(x=(n=(I=t==null?void 0:t.value)==null?void 0:I.extra)==null?void 0:n.receiver)==null?void 0:x.mobile}

            收货地址：${(k=(N=t==null?void 0:t.value)==null?void 0:N.extra)==null?void 0:k.receiver.area.join("")} ${(D=(b=(w=t==null?void 0:t.value)==null?void 0:w.extra)==null?void 0:b.receiver)==null?void 0:D.address}

            采购备注：${(O=(T=t==null?void 0:t.value)==null?void 0:T.extra)==null?void 0:O.remark}
        `;try{await _e(m),S.ElMessage.success("复制成功")}catch{S.ElMessage.error("复制失败")}},h=e.computed(()=>m=>Re(m)),C=e.computed(()=>m=>Le(m));return{orderDetails:t,stepInfo:d,payTypeMap:Fe,divTenThousand:de,computedCalculateFreight:h,computedCalculateCommodityPrice:C,handlePayOrder:g,showPayDialog:o,handlePay:u,payOrderRef:i,copyOrderNo:c,handleCopyReceiver:s}},Me=r=>{if(!r)return"";if(r.status==="UNPAID")return"待支付";if(r.status==="PAYMENT_AUDIT")return"待审核";const p=["WAITING_FOR_DELIVER","WAITING_FOR_RECEIVE","COMPLETED"],o={WAITING_FOR_DELIVER:"待发货",WAITING_FOR_RECEIVE:"待入库",COMPLETED:"已完成"};if(r.status==="PAID"){let t="COMPLETED";for(const d of r.orderItems){const y=p.findIndex(g=>g===t);if(d.packageStatus==="WAITING_FOR_DELIVER"&&y>0){t="WAITING_FOR_DELIVER";continue}d.packageStatus==="WAITING_FOR_RECEIVE"&&y>1&&(t="WAITING_FOR_RECEIVE")}let i=o[t];return i==="待发货"&&r.orderItems.find(y=>y.packageStatus!=="WAITING_FOR_DELIVER")&&(i="部分发货"),i}return"已关闭"},Re=(r=[])=>r.reduce((p,o)=>p.plus(new P(de(o.freightPrice))),new P(0)),Le=(r=[])=>r.reduce((p,o)=>p.plus(new P(de(o.salePrice).mul(new P(o.num)))),new P(0)),je={style:{color:"red"}},qe={style:{"font-size":"18px"}},ze={style:{color:"red","font-size":"16px"}},Ue={style:{display:"flex","flex-wrap":"wrap"}},We=e.defineComponent({__name:"pay-order",props:{price:{default:()=>new P(0)}},setup(r,{expose:p}){const o=r,t=e.reactive({payType:"",proof:[]}),i=e.ref([]),d=e.ref(),y={payType:[{required:!0,message:"请选择支付方式",trigger:"blur"}],proof:[{required:!0,message:"请选择支付方式",trigger:"change"},{validator:(m,l,f)=>{t.payType==="OFFLINE"&&(l||f(new Error("请上传凭证"))),f()},trigger:"change"}]},g=e.ref(null),u=()=>new Promise((m,l)=>{g.value?g.value.validate(f=>{f?m(t):l("valid error")}):l("none instance")}),c=m=>{typeof m=="string"&&t.proof.push(m)},s=async()=>{const{data:m,code:l}=await Be();l===200&&m&&(d.value=m)},h=e.ref(!1);function C(){s().then(async()=>{var f;const{code:m,data:l}=await Pe();m===200&&(i.value=l.paymentMethods,console.log(i),l.paymentMethods.includes("SHOP_BALANCE")&&((f=d.value)==null?void 0:f.undrawn)/1e4>Number(o.price)?(t.payType="BALANCE",h.value=!1):l.paymentMethods.includes("PAY_OFF_LINE")?(t.payType="OFFLINE",h.value=!0):(t.payType="",h.value=!0))})}return C(),p({getPayOrderFormModel:u}),(m,l)=>{const f=e.resolveComponent("el-form-item"),E=e.resolveComponent("el-radio"),I=e.resolveComponent("el-radio-group"),n=e.resolveComponent("el-form");return e.openBlock(),e.createBlock(n,{ref_key:"formRef",ref:g,model:t,rules:y,"label-width":"80px","label-position":"right"},{default:e.withCtx(()=>[e.createVNode(f,{label:"应付款"},{default:e.withCtx(()=>[e.createElementVNode("span",je,[l[1]||(l[1]=e.createTextVNode("￥")),e.createElementVNode("text",qe,e.toDisplayString(o.price.toFixed(2)),1)])]),_:1}),e.createVNode(f,{label:"支付方式",prop:"payType"},{default:e.withCtx(()=>[e.createVNode(I,{modelValue:t.payType,"onUpdate:modelValue":l[0]||(l[0]=x=>t.payType=x)},{default:e.withCtx(()=>[i.value.includes("SHOP_BALANCE")?(e.openBlock(),e.createBlock(E,{key:0,value:"BALANCE",disabled:h.value},{default:e.withCtx(()=>{var x;return[l[2]||(l[2]=e.createTextVNode("店铺余额(")),e.createElementVNode("span",ze,e.toDisplayString(String((((x=d.value)==null?void 0:x.undrawn)/1e4).toFixed(2))),1),l[3]||(l[3]=e.createTextVNode(") "))]}),_:1},8,["disabled"])):e.createCommentVNode("",!0),i.value.includes("PAY_OFF_LINE")?(e.openBlock(),e.createBlock(E,{key:1,value:"OFFLINE"},{default:e.withCtx(()=>l[4]||(l[4]=[e.createTextVNode("线下付款")])),_:1})):e.createCommentVNode("",!0)]),_:1},8,["modelValue"])]),_:1}),t.payType==="OFFLINE"?(e.openBlock(),e.createBlock(f,{key:0,label:"付款凭证",prop:"proof"},{default:e.withCtx(()=>[e.createElementVNode("div",null,[l[5]||(l[5]=e.createElementVNode("div",{style:{color:"#999","font-size":"12px"}},"【最多可上传3张】，至少 1 张，每张2MB以内，jpg、jpeg、png",-1)),e.createElementVNode("div",Ue,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.proof,(x,N)=>(e.openBlock(),e.createElementBlock("div",{key:x},[e.createVNode(pe,{src:t.proof[N],"onUpdate:src":k=>t.proof[N]=k,style:{"margin-right":"10px"},format:{size:2,width:1e4,height:1e4,types:["image/png","image/jpg","image/jpeg"]},cropper:!1,height:100,width:100},null,8,["src","onUpdate:src"])]))),128)),e.withDirectives(e.createVNode(pe,{format:{size:2,width:1e4,height:1e4,types:["image/png","image/jpg","image/jpeg"]},height:100,width:100,onChange:c},null,512),[[e.vShow,t.proof.length<3]])])])]),_:1})):e.createCommentVNode("",!0)]),_:1},8,["model"])}}}),Mt="",ce=(r,p)=>{const o=r.__vccOpts||r;for(const[t,i]of p)o[t]=i;return o},Ge=ce(We,[["__scopeId","data-v-e699432b"]]),He=()=>{const r=e.ref(!1),p=e.ref("");return{showProof:r,goToShowProof:t=>{var i,d;p.value=((d=(i=t==null?void 0:t.extra)==null?void 0:i.pay)==null?void 0:d.proof)||"",r.value=!0},currentProof:p}},Ye={class:"details"},Je={class:"details__status"},Ke={class:"details__status--title"},Qe={style:{"font-size":"26px"}},Xe={class:"details__status--steps"},Ze={class:"details__userInfo"},ve={class:"details__userInfo--left"},et={class:"details__userInfo--left"},tt={class:"details__userInfo--title"},ot={class:"details__userInfo--right"},nt={class:"details__table"},at={class:"commodity"},lt={class:"commodity__info"},rt={class:"commodity__info--title"},st={class:"commodity__info--spec"},it={class:"details__subtotal"},dt={class:"details__subtotal--line"},ct={class:"details__subtotal--line"},pt={class:"text-red"},mt={class:"details__subtotal--line"},_t={class:"text-red"},ft={class:"details__subtotal--line pay-price"},yt={class:"text-red"},gt={class:"dialog-footer"},xt=["src"],ht=e.defineComponent({__name:"basic",props:{order:{type:Object,default:()=>({})},reload:{type:Object,default:()=>({})}},setup(r){const p=r,{orderDetails:o,stepInfo:t,payTypeMap:i,divTenThousand:d,computedCalculateFreight:y,computedCalculateCommodityPrice:g,handlePayOrder:u,showPayDialog:c,handlePay:s,payOrderRef:h,copyOrderNo:C,handleCopyReceiver:m}=Ae(p.order,p.reload),{showProof:l,goToShowProof:f,currentProof:E}=He();return(I,n)=>{var O,M,L,j,q,z,U,W,G,H,Y,J,K,Q,X,Z,v,ee,B,R,te,oe,ne,ae,le,re,_,$,fe,ye,ge,xe,he,Ne,Ve;const x=e.resolveComponent("el-button"),N=e.resolveComponent("el-step"),k=e.resolveComponent("el-steps"),w=e.resolveComponent("el-image"),b=e.resolveComponent("el-table-column"),D=e.resolveComponent("el-table"),T=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ye,[e.createElementVNode("div",Je,[e.createElementVNode("div",Ke,[e.createElementVNode("p",Qe,e.toDisplayString(e.unref(t).statusText),1),e.unref(t).statusText==="待支付"?(e.openBlock(),e.createBlock(x,{key:0,type:"danger",onClick:e.unref(s)},{default:e.withCtx(()=>n[6]||(n[6]=[e.createTextVNode("去支付")])),_:1},8,["onClick"])):e.createCommentVNode("",!0)]),e.createElementVNode("div",Xe,[e.createVNode(k,{active:e.unref(t).activeStep,"align-center":"","finish-status":"finish"},{default:e.withCtx(()=>{var a,V,se,ie,ue,Ee,Ce;return[e.createVNode(N,{description:(a=e.unref(o))==null?void 0:a.createTime,title:"买家下单"},null,8,["description"]),e.createVNode(N,{description:(se=(V=e.unref(o))==null?void 0:V.timeNodes)==null?void 0:se.payTime,title:"买家付款"},null,8,["description"]),e.createVNode(N,{description:(ue=(ie=e.unref(o))==null?void 0:ie.timeNodes)==null?void 0:ue.deliveryTime,title:"卖家发货"},null,8,["description"]),e.createVNode(N,{description:(Ce=(Ee=e.unref(o))==null?void 0:Ee.timeNodes)==null?void 0:Ce.receiveTime,title:"买家收货"},null,8,["description"])]}),_:1},8,["active"])])]),e.createElementVNode("div",Ze,[e.createElementVNode("div",ve,[n[7]||(n[7]=e.createElementVNode("div",{class:"details__userInfo--title"},"订单信息",-1)),e.createElementVNode("div",null,[e.createElementVNode("span",null,"订单编号："+e.toDisplayString((O=e.unref(o))==null?void 0:O.no),1),e.createElementVNode("span",{class:"copy",onClick:n[0]||(n[0]=a=>{var V;return e.unref(C)(((V=e.unref(o))==null?void 0:V.no)||"")})},"复制")]),e.createElementVNode("div",null,"下单时间："+e.toDisplayString((M=e.unref(o))==null?void 0:M.createTime),1),e.createElementVNode("div",null,"支付时间："+e.toDisplayString((j=(L=e.unref(o))==null?void 0:L.timeNodes)==null?void 0:j.payTime),1),e.createElementVNode("div",null,[e.createElementVNode("span",null,"支付方式："+e.toDisplayString(e.unref(i)[(U=(z=(q=e.unref(o))==null?void 0:q.extra)==null?void 0:z.pay)==null?void 0:U.payType]),1),((H=(G=(W=e.unref(o))==null?void 0:W.extra)==null?void 0:G.pay)==null?void 0:H.payType)==="OFFLINE"?(e.openBlock(),e.createElementBlock("span",{key:0,class:"copy",onClick:n[1]||(n[1]=a=>{var V,se,ie;return e.unref(f)({extra:{pay:{proof:((ie=(se=(V=e.unref(o))==null?void 0:V.extra)==null?void 0:se.pay)==null?void 0:ie.proof)||""}}})})},"付款凭证")):e.createCommentVNode("",!0)]),n[8]||(n[8]=e.createElementVNode("div",null,"配送方式：快递配送",-1))]),e.createElementVNode("div",et,[e.createElementVNode("div",tt,[n[9]||(n[9]=e.createElementVNode("span",null,"收货人信息",-1)),e.createElementVNode("span",{class:"copy",onClick:n[2]||(n[2]=(...a)=>e.unref(m)&&e.unref(m)(...a))},"复制")]),e.createElementVNode("div",null,"收货人姓名："+e.toDisplayString((K=(J=(Y=e.unref(o))==null?void 0:Y.extra)==null?void 0:J.receiver)==null?void 0:K.name),1),e.createElementVNode("div",null,"联系人电话："+e.toDisplayString((Z=(X=(Q=e.unref(o))==null?void 0:Q.extra)==null?void 0:X.receiver)==null?void 0:Z.mobile),1),e.createElementVNode("div",null," 收货地址： "+e.toDisplayString((B=(ee=(v=e.unref(o))==null?void 0:v.extra)==null?void 0:ee.receiver.area)==null?void 0:B.join(""))+" "+e.toDisplayString((oe=(te=(R=e.unref(o))==null?void 0:R.extra)==null?void 0:te.receiver)==null?void 0:oe.address),1),e.createElementVNode("div",null,"采购备注："+e.toDisplayString((ae=(ne=e.unref(o))==null?void 0:ne.extra)==null?void 0:ae.remark),1)]),e.createElementVNode("div",ot,[n[10]||(n[10]=e.createElementVNode("div",{class:"details__userInfo--title"},"供应商信息",-1)),e.createElementVNode("div",null,"供应商名称："+e.toDisplayString((re=(le=e.unref(o))==null?void 0:le.extraInfo)==null?void 0:re.supplierName),1),e.createElementVNode("div",null,"联系人电话："+e.toDisplayString(($=(_=e.unref(o))==null?void 0:_.extraInfo)==null?void 0:$.supplierPhone),1)])]),e.createElementVNode("div",nt,[e.createVNode(D,{data:(fe=e.unref(o))==null?void 0:fe.orderItems,border:"",class:"details__table--main"},{default:e.withCtx(()=>[e.createVNode(b,{align:"center",label:"商品",width:"460"},{default:e.withCtx(({row:a})=>{var V;return[e.createElementVNode("div",at,[a!=null&&a.image?(e.openBlock(),e.createBlock(w,{key:0,src:a==null?void 0:a.image,fit:"cover",style:{width:"70px",height:"70px"}},null,8,["src"])):e.createCommentVNode("",!0),e.createElementVNode("div",lt,[e.createElementVNode("span",rt,e.toDisplayString(a==null?void 0:a.productName),1),e.createElementVNode("span",st,e.toDisplayString((V=a==null?void 0:a.specs)==null?void 0:V.join(";")),1)])])]}),_:1}),e.createVNode(b,{align:"center",label:"采购单价"},{default:e.withCtx(({row:a})=>[e.createTextVNode(e.toDisplayString(e.unref(d)(a==null?void 0:a.salePrice)),1)]),_:1}),e.createVNode(b,{align:"center",label:"采购数量",prop:"num"}),e.createVNode(b,{align:"center",label:"采购金额"},{default:e.withCtx(({row:a})=>[e.createTextVNode(e.toDisplayString(e.unref(d)(a==null?void 0:a.salePrice).mul(new(e.unref(P))(a.num))),1)]),_:1}),e.createVNode(b,{label:"实际入库量",prop:"used",align:"center"})]),_:1},8,["data"])]),e.createElementVNode("div",it,[n[13]||(n[13]=e.createElementVNode("div",{class:"details__subtotal--title"},"订单总计",-1)),e.createElementVNode("div",dt,"采购总数："+e.toDisplayString((ge=(ye=e.unref(o))==null?void 0:ye.orderItems)==null?void 0:ge.reduce((a,V)=>a+V.num,0)),1),e.createElementVNode("div",ct,[n[11]||(n[11]=e.createTextVNode(" 商品总价：")),e.createElementVNode("span",pt,e.toDisplayString(e.unref(g)((xe=e.unref(o))==null?void 0:xe.orderItems)),1)]),e.createElementVNode("div",mt,[n[12]||(n[12]=e.createTextVNode(" 运费：")),e.createElementVNode("span",_t,e.toDisplayString(e.unref(y)((he=e.unref(o))==null?void 0:he.orderItems)),1)]),e.createElementVNode("div",ft,[e.createTextVNode(" 采购金额("+e.toDisplayString(((Ne=e.unref(o))==null?void 0:Ne.status)==="PAID"?"已付款":"应付款")+")：",1),e.createElementVNode("span",yt,e.toDisplayString(e.unref(d)((Ve=e.unref(o))==null?void 0:Ve.payAmount))+"元",1)])])]),e.createVNode(T,{modelValue:e.unref(c),"onUpdate:modelValue":n[4]||(n[4]=a=>e.isRef(c)?c.value=a:null),title:"支付订单",width:"500px"},{footer:e.withCtx(()=>[e.createElementVNode("span",gt,[e.createVNode(x,{onClick:n[3]||(n[3]=a=>c.value=!1)},{default:e.withCtx(()=>n[14]||(n[14]=[e.createTextVNode("取消")])),_:1}),e.createVNode(x,{type:"primary",onClick:e.unref(u)},{default:e.withCtx(()=>n[15]||(n[15]=[e.createTextVNode(" 确认 ")])),_:1},8,["onClick"])])]),default:e.withCtx(()=>{var a;return[e.createVNode(Ge,{ref_key:"payOrderRef",ref:h,price:e.unref(d)((a=e.unref(o))==null?void 0:a.payAmount)},null,8,["price"])]}),_:1},8,["modelValue"]),e.createVNode(T,{modelValue:e.unref(l),"onUpdate:modelValue":n[5]||(n[5]=a=>e.isRef(l)?l.value=a:null),title:"付款凭证",width:"500px"},{default:e.withCtx(()=>[e.createElementVNode("img",{src:e.unref(E),class:"proof-img"},null,8,xt)]),_:1},8,["modelValue"])],64)}}}),Lt="",Nt=Object.freeze(Object.defineProperty({__proto__:null,default:ce(ht,[["__scopeId","data-v-1d02d6c0"]])},Symbol.toStringTag,{value:"Module"})),Vt={style:{padding:"16px","overflow-y":"scroll"}},ut={style:{"margin-bottom":"30px","margin-left":"20px"}},Et={key:0},Ct={key:1},bt={class:"logisticsInfo"},It={class:"logisticsInfo__left"},kt={style:{display:"flex","align-items":"center"}},St={key:0,style:{"margin-top":"20px"}},Tt={class:"logisticsInfo__right"},Ot={key:0},Bt={class:"logisticsInfo__text"},Pt={class:"logisticsInfo__text"},wt={class:"logisticsInfo__text"},Dt={key:1,style:{"text-align":"center",height:"100px","line-height":"100px"}},$t=e.defineComponent({__name:"delivery",props:{order:{type:Object,default(){return{}}}},setup(r){const p=F.useRoute(),o=r,t=e.ref([]),i=e.ref([]),d=e.ref(0);y();async function y(){const{code:c,data:s}=await Se(p.query.orderNo);if(c!==200)return S.ElMessage.error("包裹详情获取失败");s.length&&(i.value=s,g())}const g=async()=>{const c=i.value[d.value];if(c.type!=="WITHOUT")try{const{data:s,code:h,msg:C}=await Oe(c.express.expressCompanyCode,c.express.expressNo);if(h!==200)return S.ElMessage.error("包裹详情获取失败");if(!s.data){u(s,c);return}t.value=s.data.reverse()}catch(s){t.value=[{status:"包裹异常",time:c==null?void 0:c.createTime,context:s.msg}]}};function u(c,s){switch(c.returnCode){case"401":t.value=[{status:"包裹异常",time:s.createTime,context:c.message}];break;case"400":t.value=[{status:"包裹异常",time:s.createTime,context:c.message}];break;default:t.value=[{status:"包裹异常",time:s.createTime,context:c.message}];break}}return(c,s)=>{var N,k,w,b,D,T,O,M,L,j,q,z,U,W,G,H,Y,J,K,Q,X,Z,v,ee;const h=e.resolveComponent("el-image"),C=e.resolveComponent("el-table-column"),m=e.resolveComponent("el-table"),l=e.resolveComponent("el-row"),f=e.resolveComponent("el-timeline-item"),E=e.resolveComponent("el-timeline"),I=e.resolveComponent("el-scrollbar"),n=e.resolveComponent("el-tab-pane"),x=e.resolveComponent("el-tabs");return e.openBlock(),e.createElementBlock("div",Vt,[e.createElementVNode("div",ut,[s[2]||(s[2]=e.createElementVNode("div",{style:{color:"#000","font-size":"16px","margin-left":"-10px","font-weight":"700","margin-bottom":"10px"}},"收货人信息",-1)),e.createElementVNode("div",null,"收货人姓名："+e.toDisplayString(((w=(k=(N=i.value)==null?void 0:N[0])==null?void 0:k.receiver)==null?void 0:w.name)||((T=(D=(b=o.order)==null?void 0:b.extra)==null?void 0:D.receiver)==null?void 0:T.name)),1),e.createElementVNode("div",null,"联系人电话："+e.toDisplayString(((L=(M=(O=i.value)==null?void 0:O[0])==null?void 0:M.receiver)==null?void 0:L.mobile)||((z=(q=(j=o.order)==null?void 0:j.extra)==null?void 0:q.receiver)==null?void 0:z.mobile)),1),e.createElementVNode("div",null,[s[1]||(s[1]=e.createElementVNode("span",null,"收货地址：",-1)),(G=(W=(U=i.value)==null?void 0:U[0])==null?void 0:W.receiver)!=null&&G.address?(e.openBlock(),e.createElementBlock("span",Et,e.toDisplayString((J=(Y=(H=i.value)==null?void 0:H[0])==null?void 0:Y.receiver)==null?void 0:J.address),1)):(e.openBlock(),e.createElementBlock("span",Ct,[e.createElementVNode("span",null,e.toDisplayString((X=(Q=(K=o.order)==null?void 0:K.extra)==null?void 0:Q.receiver.area)==null?void 0:X.join("")),1),e.createElementVNode("span",null,e.toDisplayString((ee=(v=(Z=o.order)==null?void 0:Z.extra)==null?void 0:v.receiver)==null?void 0:ee.address),1)]))])]),e.createVNode(x,{modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=B=>d.value=B),type:"card",onTabChange:g},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,(B,R)=>(e.openBlock(),e.createBlock(n,{key:R,label:"包裹"+(R+1),name:R},{default:e.withCtx(()=>{var te,oe,ne,ae,le,re;return[e.createElementVNode("div",bt,[e.createElementVNode("div",It,[e.createVNode(m,{data:B.orderItems,border:"",style:{width:"500px"}},{default:e.withCtx(()=>[e.createVNode(C,{label:"商品 ",width:"400px"},{default:e.withCtx(({row:_})=>[e.createElementVNode("div",kt,[e.createVNode(h,{src:_==null?void 0:_.image,title:_==null?void 0:_.productName,fits:"cover",shape:"square",size:"large",style:{width:"70px",height:"70px","margin-right":"10px"}},null,8,["src","title"]),e.createElementVNode("div",null,[e.createElementVNode("div",null,e.toDisplayString(_==null?void 0:_.productName),1),e.createElementVNode("div",null,e.toDisplayString(_==null?void 0:_.specs),1)])])]),_:1}),e.createVNode(C,{align:"center",label:"发货数"},{default:e.withCtx(({row:_})=>[e.createTextVNode(e.toDisplayString(_==null?void 0:_.num),1)]),_:1})]),_:2},1032,["data"]),B.type!=="WITHOUT"?(e.openBlock(),e.createElementBlock("div",St,[s[3]||(s[3]=e.createElementVNode("div",{class:"logisticsInfo__title"},"物流详情",-1)),e.createVNode(I,{ref_for:!0,ref:"scrollbarRef",style:{"margin-left":"10px"}},{default:e.withCtx(()=>[e.createVNode(E,{class:"logisticsInfo__timeline"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.value,(_,$)=>(e.openBlock(),e.createBlock(f,{key:_.time+$,color:$===0?"#409eff":" ",timestamp:`${_.context}`,class:"logisticsInfo__timeline--item",style:{"padding-bottom":"42px"}},{default:e.withCtx(()=>[e.createVNode(l,null,{default:e.withCtx(()=>[e.createElementVNode("div",{style:e.normalizeStyle({color:$===0?"#409eff":" "}),class:"logisticsInfo__timeline--status"},e.toDisplayString(_.status),5),e.createElementVNode("div",{style:e.normalizeStyle({color:$===0?"#409eff":" "}),class:"logisticsInfo__timeline--time"},e.toDisplayString(_.time),5)]),_:2},1024)]),_:2},1032,["color","timestamp"]))),128))]),_:2},1024)]),_:2},1536)])):e.createCommentVNode("",!0)]),e.createElementVNode("div",Tt,[s[4]||(s[4]=e.createElementVNode("div",{class:"logisticsInfo__title"},"物流信息",-1)),B.type!=="WITHOUT"?(e.openBlock(),e.createElementBlock("div",Ot,[e.createElementVNode("div",Bt,"收货地址："+e.toDisplayString((oe=(te=i.value[d.value])==null?void 0:te.receiver)==null?void 0:oe.address),1),e.createElementVNode("div",Pt,"物流公司："+e.toDisplayString((ae=(ne=i.value[d.value])==null?void 0:ne.express)==null?void 0:ae.expressCompanyName),1),e.createElementVNode("div",wt,"物流单号："+e.toDisplayString((re=(le=i.value[d.value])==null?void 0:le.express)==null?void 0:re.expressNo),1)])):(e.openBlock(),e.createElementBlock("div",Dt,"无需物流"))])])]}),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}}}),qt="",Ft=Object.freeze(Object.defineProperty({__proto__:null,default:ce($t,[["__scopeId","data-v-84c76846"]])},Symbol.toStringTag,{value:"Module"}));return De});

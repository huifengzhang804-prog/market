(function(e,U){typeof exports=="object"&&typeof module<"u"?module.exports=U(require("vue"),require("@/components/ChromeTab.vue"),require("@/components/PageManage.vue"),require("@/components/qszr-core/packages/q-table/QTable"),require("@/components/qszr-core/packages/q-table/q-table-column.vue"),require("lodash-es"),require("@/components/SchemaForm.vue"),require("@/composables/useConvert"),require("element-plus"),require("vue-router"),require("@/store/modules/shopInfo"),require("@/components/q-icon/q-icon.vue"),require("@/apis/http")):typeof define=="function"&&define.amd?define(["vue","@/components/ChromeTab.vue","@/components/PageManage.vue","@/components/qszr-core/packages/q-table/QTable","@/components/qszr-core/packages/q-table/q-table-column.vue","lodash-es","@/components/SchemaForm.vue","@/composables/useConvert","element-plus","vue-router","@/store/modules/shopInfo","@/components/q-icon/q-icon.vue","@/apis/http"],U):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopConsignment=U(e.ShopConsignmentContext.Vue,e.ShopConsignmentContext.ChromeTabs,e.ShopConsignmentContext.PageManageTwo,e.ShopConsignmentContext.QTable,e.ShopConsignmentContext.QTableColumn,e.ShopConsignmentContext.Lodash,e.ShopConsignmentContext.SchemaForm,e.ShopConsignmentContext.UseConvert,e.ShopConsignmentContext.ElementPlus,e.ShopConsignmentContext.VueRouter,e.ShopConsignmentContext.ShopInfoStore,e.ShopConsignmentContext.QIcon,e.ShopConsignmentContext.Request))})(this,function(e,U,W,X,P,O,J,F,w,G,Z,A,D){"use strict";var Q=document.createElement("style");Q.textContent=`@charset "UTF-8";.preview[data-v-ca592fc9]{line-height:1.5rem}.preview__image span[data-v-ca592fc9]{vertical-align:top}.commodity-info[data-v-0313ec05]{display:flex;align-items:center}.commodity-info img[data-v-0313ec05]{width:60px;height:60px}.commodity-info span[data-v-0313ec05]{overflow:hidden;text-overflow:ellipsis;display:box;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin-left:10px}[data-v-0313ec05] .el-form-item .el-form-item{margin-top:8px}[data-v-e3b822c0]{font-size:14px}.table[data-v-e3b822c0]{overflow-y:auto}.commodity-info[data-v-e3b822c0]{display:flex;align-items:center}.commodity-info img[data-v-e3b822c0]{width:68px;height:68px}.commodity-info .productName[data-v-e3b822c0]{width:217px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin-left:10px}.customer[data-v-e3b822c0]{width:100%;display:flex;flex-direction:column;justify-content:space-around;font-size:14px;color:#333}.customer div[data-v-e3b822c0]{display:flex;align-items:center}.customer__name[data-v-e3b822c0]{display:inline-block;max-width:156px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-right:3px}.customer img[data-v-e3b822c0]{width:16.25px;height:15.32px;margin-left:5px;cursor:pointer}.explainData>div[data-v-31d9ae8e]{display:flex;margin-top:8px}.explainData>div img[data-v-31d9ae8e]{margin-top:6px}.explainData .explainData_label[data-v-31d9ae8e]{width:80px;text-align:right;margin-right:8px}.violation-evidence[data-v-31d9ae8e]{width:100px;height:100px;vertical-align:top}.violation-evidence+.violation-evidence[data-v-31d9ae8e]{margin-left:5px}.good[data-v-64385005]{padding:0 30px 0 45px;box-sizing:border-box;font-size:12px;font-family:Microsoft YaHei,Microsoft YaHei-Normal;font-weight:400;color:#000}.good__info[data-v-64385005]{margin-bottom:24px}.good__img[data-v-64385005]{display:flex;justify-content:flex-start;align-items:flex-start}.good__spec[data-v-64385005]{width:758px}.b[data-v-64385005]{font-size:12px;color:#000}[data-v-3e1c77b2]{font-size:14px}.commodity-info[data-v-3e1c77b2]{display:flex;align-items:center}.commodity-info img[data-v-3e1c77b2]{width:68px;height:68px}.commodity-info span[data-v-3e1c77b2]{display:inline-block;width:217px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin-left:10px}.customer[data-v-3e1c77b2]{width:100%;display:flex;flex-direction:column;justify-content:space-around;font-size:14px;color:#333}.customer div[data-v-3e1c77b2]{display:flex;align-content:center}.customer__name[data-v-3e1c77b2]{display:inline-block;max-width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-right:3px}.customer img[data-v-3e1c77b2]{width:16.25px;height:15.32px;margin-left:5px;cursor:pointer}.settings[data-v-a1d51d40]{padding:16px}.settings__explain[data-v-a1d51d40]{padding:25px 20px;background-color:#555cfd0f;color:#333}.settings__title[data-v-a1d51d40]{padding:0 15px;line-height:1.3}.settings__container[data-v-a1d51d40]{padding:0 15px}.settings__container--line[data-v-a1d51d40]{line-height:1.3}.settings__container .text-red[data-v-a1d51d40]{color:red}.settings__form[data-v-a1d51d40]{margin-top:30px;display:flex}.settings__form>span[data-v-a1d51d40]{margin-right:15px;margin-top:8px}.settings__footer[data-v-a1d51d40]{margin-top:auto;width:100%;padding:17px 0;display:flex;align-items:center;justify-content:center;box-shadow:0 0 10px #2e2c2c4d}
`,document.head.appendChild(Q);const se={class:"q_plugin_container"},de=e.defineComponent({__name:"ShopConsignment",setup(o){const i=e.ref("goodSource"),n={goodSource:e.defineAsyncComponent(()=>Promise.resolve().then(()=>Ye)),shipped:e.defineAsyncComponent(()=>Promise.resolve().then(()=>yt)),settings:e.defineAsyncComponent(()=>Promise.resolve().then(()=>St))},r=[{name:"goodSource",label:"货源"},{name:"shipped",label:"已铺货"},{name:"settings",label:"代销设置"}],a=c=>{c&&(i.value=c)};return(c,g)=>(e.openBlock(),e.createElementBlock("div",se,[e.createVNode(U,{tabList:r,value:i.value,onHandleTabs:a},null,8,["value"]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n[i.value])))]))}}),ce=o=>D.get({url:"addon-supplier/supplier/manager/product/getSupplyList",params:{...o}}),v=(o,i)=>D.post({url:`gruul-mall-carrier-pigeon/pigeon/group-chat-rooms/${o}/${i}`}),ee=(o={})=>D.get({url:"gruul-mall-shop/shop/info/getSupplierInfo",params:o}),te=()=>D.get({url:"gruul-mall-addon-platform/platform/shop/signing/category/choosable/list"}),pe=o=>D.get({url:"gruul-mall-goods/goods/product/category",params:o}),ne=()=>D.get({url:"gruul-mall-goods/consignment/config"}),me=o=>D.post({url:"gruul-mall-goods/consignment/config",data:o}),fe=o=>D.get({url:"gruul-mall-goods/consignment/pave/goods",params:o}),ge=o=>D.post({url:"gruul-mall-goods/consignment/pave/goods",data:o}),ue=(o,i)=>D.put({url:`gruul-mall-goods/manager/product/updateStatus/${i}`,data:{keys:o}}),_e=e.defineComponent({__name:"search",emits:["search"],setup(o,{emit:i}){const n=e.ref([]),r=e.ref([]),a=e.reactive({supplierId:"",platformCategoryParentId:"",supplierGoodsName:""}),c=e.computed(()=>[{label:"商品名称",prop:"supplierGoodsName",valueType:"copy",fieldProps:{placeholder:"请输入商品名称"}},{label:"供应商名称",labelWidth:85,prop:"supplierId",valueType:"select",options:n,fieldProps:{placeholder:"请输入店铺名称",props:{expandTrigger:"hover"},filterable:!0,remote:!0,reserveKeyword:!0,remoteMethod:t=>{_(t)}}},{label:"平台类目",valueType:"cascader",options:r,fieldProps:{placeholder:"请选择平台类目",props:{expandTrigger:"hover",label:"name",value:"id",children:"secondCategoryVos"},onChange:t=>{t.length>1&&(a.platformCategoryParentId=t[t.length-1])}}}]),g=i,l=async()=>{const{data:t,code:y}=await te();r.value=t};e.onMounted(()=>l());const V=()=>{const t=O.cloneDeep(a);delete t.undefined,g("search",t)},_=async(t="")=>{var s;const y=await ee({supplierName:t});y.data&&((s=y.data)!=null&&s.length)&&(n.value=y.data.map(x=>({value:x.id,label:x.name})))},p=()=>{Object.keys(a).forEach(t=>a[t]=""),V()};return(t,y)=>(e.openBlock(),e.createBlock(J,{modelValue:a,"onUpdate:modelValue":y[0]||(y[0]=s=>a=s),columns:c.value,"show-number":3,onSearchHandle:V,onHandleReset:p},null,8,["modelValue","columns"]))}}),he={class:"preview"},ye={class:"preview__name"},Ve={class:"preview__image"},xe=e.defineComponent({__name:"preview",props:{commodityItem:{type:Object,default:()=>({}),required:!0}},setup(o){const{divTenThousand:i}=F();return(n,r)=>{var l,V;const a=e.resolveComponent("el-image"),c=e.resolveComponent("el-table-column"),g=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock("div",he,[e.createElementVNode("div",ye,"商品名称："+e.toDisplayString(o.commodityItem.productName),1),e.createElementVNode("div",Ve,[r[0]||(r[0]=e.createElementVNode("span",null,"商品图片：",-1)),e.createVNode(a,{src:(V=(l=o.commodityItem.albumPics)==null?void 0:l.split(","))==null?void 0:V.shift(),style:{width:"80px",height:"80px"}},null,8,["src"])]),e.createVNode(g,{data:o.commodityItem.storageSkus},{default:e.withCtx(()=>[e.createVNode(c,{label:"商品规格"},{default:e.withCtx(({row:_})=>{var p,t;return[e.createTextVNode(e.toDisplayString(((p=o.commodityItem.storageSkus)==null?void 0:p.length)===1?"单规格":(t=_==null?void 0:_.specs)==null?void 0:t.join(";")),1)]}),_:1}),e.createVNode(c,{label:"供货价"},{default:e.withCtx(({row:_})=>[e.createTextVNode(e.toDisplayString(e.unref(i)(_==null?void 0:_.salePrice)),1)]),_:1}),e.createVNode(c,{label:"库存"},{default:e.withCtx(({row:_})=>[e.createTextVNode(e.toDisplayString((_==null?void 0:_.stockType)==="UNLIMITED"?"无限库存":_==null?void 0:_.stock),1)]),_:1})]),_:1},8,["data"])])}}}),Pt="",R=(o,i)=>{const n=o.__vccOpts||o;for(const[r,a]of i)n[r]=a;return n},Ne=R(xe,[["__scopeId","data-v-ca592fc9"]]),{divTenThousand:oe,mulTenThousand:H}=F(),be={expandTrigger:"hover",label:"name",value:"id"};function ae(o,i){const n=o===3;for(let r=0;r<i.length;){const a=i[r];if(n){a.disabled=!1,r++;continue}const c=a.children||a.secondCategoryVos||a.categoryThirdlyVos;delete a.secondCategoryVos,delete a.categoryThirdlyVos;const g=!c||c.length===0;if(a.disabled=g,g){i.splice(r,1);continue}if(ae(o+1,c),c.length===0){i.splice(r,1);continue}a.children=c,r++}return i}const Ce=o=>{const i=e.ref(),n=e.reactive({shopCategory:"",consignmentPriceSetting:{type:"UNIFY",sale:0,scribe:0},unifyPriceSetting:{type:"",sale:0,scribe:0}}),r={shopCategory:{required:!0,message:"请选择商家分类",type:"array",trigger:"change"},"consignmentPriceSetting.scribe":{validator:(p,t,y)=>{n.consignmentPriceSetting.type==="RATE"&&(t>100&&y(new Error("划线价比率不能大于100%")),y())},trigger:"blur"},"consignmentPriceSetting.sale":{validator:(p,t,y)=>{n.consignmentPriceSetting.type==="RATE"&&(t>100&&y(new Error("销售价比率不能大于100%")),y())},trigger:"blur"}},a=e.computed(()=>p=>{const t=((p==null?void 0:p.salePrices)||[]).map(x=>Number(x)),y=Math.min(...t),s=Math.max(...t);return y===s?s/1e4:`${y/1e4}~${s/1e4}`}),c=e.computed(()=>p=>{let t=0,y=!1;return p==null||p.forEach(s=>{t+=Number(s.stock),s.stockType==="LIMITED"&&(y=!0)}),y?t:"无限库存"}),g=e.ref([]);async function l(){const{code:p,data:t}=await pe({current:1,size:500});if(p!==200){w.ElMessage.error("获取店铺分类失败");return}g.value=ae(1,t.records)}const V=async()=>{const{data:p,code:t}=await ne();t===200&&p&&(n.unifyPriceSetting.sale=oe(p==null?void 0:p.sale).toNumber(),n.unifyPriceSetting.scribe=oe(p==null?void 0:p.scribe).toNumber(),n.unifyPriceSetting.type=p==null?void 0:p.type)},_=()=>new Promise((p,t)=>{var s,x,h;if(i.value){const S={shopCategory:{one:(s=n.shopCategory)==null?void 0:s[0],two:(x=n.shopCategory)==null?void 0:x[1],three:(h=n.shopCategory)==null?void 0:h[2]},shopProductKeys:o.value.map(E=>({shopId:E.shopId,productId:E.id}))},C={};n.consignmentPriceSetting.type==="UNIFY"?(C.type=n.unifyPriceSetting.type,C.sale=H(n.unifyPriceSetting.sale).toString(),C.scribe=H(n.unifyPriceSetting.scribe).toString()):(C.type=n.consignmentPriceSetting.type,C.sale=H(n.consignmentPriceSetting.sale).toString(),C.scribe=H(n.consignmentPriceSetting.scribe).toString()),S.consignmentPriceSetting=C,p(S)}else t("valid error")});return V(),l(),{formRefs:i,formModel:n,formRules:r,shopCategoryList:g,shopCascaderProps:be,computedSalePrice:a,computedSuplier:c,buildData:_}},Se=e.defineComponent({__name:"batch-unify-settings",props:{type:{default:""},sale:{default:0},scribe:{default:0}},setup(o){return(i,n)=>{const r=e.resolveComponent("el-input-number"),a=e.resolveComponent("el-form-item");return i.type==="RATE"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(a,{prop:"sale"},{default:e.withCtx(()=>[n[0]||(n[0]=e.createElementVNode("span",null,"销售价 = 供货价 + （供货价 *  ",-1)),e.createVNode(r,{"model-value":i.sale,controls:!1,precision:2,disabled:""},null,8,["model-value"]),n[1]||(n[1]=e.createElementVNode("span",null," % ）",-1))]),_:1}),e.createVNode(a,{prop:"scribe"},{default:e.withCtx(()=>[n[2]||(n[2]=e.createElementVNode("span",null,"划线价 = 销售价 + （销售价 *  ",-1)),e.createVNode(r,{"model-value":i.scribe,controls:!1,precision:2,disabled:""},null,8,["model-value"]),n[3]||(n[3]=e.createElementVNode("span",null," % ）",-1))]),_:1})],64)):i.type==="REGULAR"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createVNode(a,{prop:"sale"},{default:e.withCtx(()=>[n[4]||(n[4]=e.createElementVNode("span",null,"销售价 = 供货价 +  ",-1)),e.createVNode(r,{"model-value":i.sale,controls:!1,precision:2,disabled:""},null,8,["model-value"]),n[5]||(n[5]=e.createElementVNode("span",null," 元",-1))]),_:1}),e.createVNode(a,{prop:"scribe"},{default:e.withCtx(()=>[n[6]||(n[6]=e.createElementVNode("span",null,"划线价 = 销售价 +  ",-1)),e.createVNode(r,{"model-value":i.scribe,controls:!1,precision:2,disabled:""},null,8,["model-value"]),n[7]||(n[7]=e.createElementVNode("span",null," 元",-1))]),_:1})],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[],64))}}}),Ee={class:"price-settings"},ke={class:"commodity-info"},Te=["src"],Pe=e.defineComponent({__name:"batch-distrubution",props:{batchItems:{type:Object,required:!0}},setup(o,{expose:i}){const n=o,r=e.computed({get(){return n.batchItems},set(y){}}),{formModel:a,formRefs:c,formRules:g,shopCategoryList:l,shopCascaderProps:V,computedSalePrice:_,computedSuplier:p,buildData:t}=Ce(r);return i({buildData:t}),(y,s)=>{const x=e.resolveComponent("el-cascader"),h=e.resolveComponent("el-form-item"),S=e.resolveComponent("el-radio"),C=e.resolveComponent("el-radio-group"),E=e.resolveComponent("el-input-number"),I=e.resolveComponent("el-form"),u=e.resolveComponent("el-table-column"),N=e.resolveComponent("el-link"),b=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(I,{ref_key:"formRefs",ref:c,model:e.unref(a),rules:e.unref(g)},{default:e.withCtx(()=>[e.createVNode(h,{label:"店铺类目",prop:"shopCategory"},{default:e.withCtx(()=>[e.createVNode(x,{ref:"shopCategoryRef",modelValue:e.unref(a).shopCategory,"onUpdate:modelValue":s[0]||(s[0]=d=>e.unref(a).shopCategory=d),clearable:"",style:{width:"62.5%"},class:"inputWidth",options:e.unref(l),props:e.unref(V),placeholder:"请选择店铺分类","show-all-levels":""},null,8,["modelValue","options","props"])]),_:1}),e.createVNode(h,{label:"价格设置"},{default:e.withCtx(()=>[e.createElementVNode("div",Ee,[e.createVNode(C,{modelValue:e.unref(a).consignmentPriceSetting.type,"onUpdate:modelValue":s[1]||(s[1]=d=>e.unref(a).consignmentPriceSetting.type=d)},{default:e.withCtx(()=>[e.createVNode(S,{value:"UNIFY"},{default:e.withCtx(()=>s[6]||(s[6]=[e.createTextVNode("统一设价")])),_:1}),e.createVNode(S,{value:"RATE"},{default:e.withCtx(()=>s[7]||(s[7]=[e.createTextVNode("按比例设价")])),_:1}),e.createVNode(S,{value:"REGULAR"},{default:e.withCtx(()=>s[8]||(s[8]=[e.createTextVNode("固定金额设价")])),_:1})]),_:1},8,["modelValue"]),e.unref(a).consignmentPriceSetting.type==="UNIFY"?(e.openBlock(),e.createBlock(Se,{key:0,sale:e.unref(a).unifyPriceSetting.sale,scribe:e.unref(a).unifyPriceSetting.scribe,type:e.unref(a).unifyPriceSetting.type},null,8,["sale","scribe","type"])):e.unref(a).consignmentPriceSetting.type==="RATE"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createVNode(h,{prop:"consignmentPriceSetting.sale"},{default:e.withCtx(()=>[s[9]||(s[9]=e.createElementVNode("span",null,"销售价 = 供货价 + （供货价 *  ",-1)),e.createVNode(E,{modelValue:e.unref(a).consignmentPriceSetting.sale,"onUpdate:modelValue":s[2]||(s[2]=d=>e.unref(a).consignmentPriceSetting.sale=d),controls:!1,precision:2},null,8,["modelValue"]),s[10]||(s[10]=e.createElementVNode("span",null," % ）",-1))]),_:1}),e.createVNode(h,{prop:"consignmentPriceSetting.scribe"},{default:e.withCtx(()=>[s[11]||(s[11]=e.createElementVNode("span",null,"划线价 = 销售价 + （销售价 *  ",-1)),e.createVNode(E,{modelValue:e.unref(a).consignmentPriceSetting.scribe,"onUpdate:modelValue":s[3]||(s[3]=d=>e.unref(a).consignmentPriceSetting.scribe=d),controls:!1,precision:2},null,8,["modelValue"]),s[12]||(s[12]=e.createElementVNode("span",null," % ）",-1))]),_:1})],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[e.createVNode(h,{prop:"consignmentPriceSetting.sale"},{default:e.withCtx(()=>[s[13]||(s[13]=e.createElementVNode("span",null,"销售价 = 供货价 +  ",-1)),e.createVNode(E,{modelValue:e.unref(a).consignmentPriceSetting.sale,"onUpdate:modelValue":s[4]||(s[4]=d=>e.unref(a).consignmentPriceSetting.sale=d),controls:!1,precision:2},null,8,["modelValue"]),s[14]||(s[14]=e.createElementVNode("span",null," 元",-1))]),_:1}),e.createVNode(h,{prop:"consignmentPriceSetting.scribe"},{default:e.withCtx(()=>[s[15]||(s[15]=e.createElementVNode("span",null,"划线价 = 销售价 +  ",-1)),e.createVNode(E,{modelValue:e.unref(a).consignmentPriceSetting.scribe,"onUpdate:modelValue":s[5]||(s[5]=d=>e.unref(a).consignmentPriceSetting.scribe=d),controls:!1,precision:2},null,8,["modelValue"]),s[16]||(s[16]=e.createElementVNode("span",null," 元",-1))]),_:1})],64))])]),_:1})]),_:1},8,["model","rules"]),e.createVNode(b,{data:r.value,"max-height":350},{default:e.withCtx(()=>[e.createVNode(u,{label:"商品名称",align:"left"},{default:e.withCtx(({row:d})=>{var k,T;return[e.createElementVNode("div",ke,[e.createElementVNode("img",{src:(T=(k=d.albumPics)==null?void 0:k.split(","))==null?void 0:T.shift()},null,8,Te),e.createElementVNode("span",null,e.toDisplayString(d.productName),1)])]}),_:1}),e.createVNode(u,{label:"供货价",align:"center"},{default:e.withCtx(({row:d})=>[e.createTextVNode(" ￥"+e.toDisplayString(e.unref(_)(d)),1)]),_:1}),e.createVNode(u,{label:"库存",align:"center",width:"100"},{default:e.withCtx(({row:d})=>[e.createTextVNode(e.toDisplayString(e.unref(p)(d==null?void 0:d.storageSkus)),1)]),_:1}),e.createVNode(u,{label:"操作",width:"80"},{default:e.withCtx(({$index:d})=>[e.createVNode(N,{type:"danger",onClick:()=>r.value.splice(d,1)},{default:e.withCtx(()=>s[17]||(s[17]=[e.createTextVNode("移除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])],64)}}}),Lt="",De=R(Pe,[["__scopeId","data-v-0313ec05"]]),Le=()=>{const o=e.ref(),i=e.ref(!1);return{previewData:o,handlePreviewData:r=>{o.value=r,i.value=!0},showPreviewDialog:i}},we=()=>{const o=G.useRouter(),i=G.useRoute(),n=e.ref({}),r=e.reactive({page:{current:1,size:10},total:0});i.query.supplierGoodsName&&(n.value.supplierGoodsName=i.query.supplierGoodsName);const a=e.ref([]),c=e.ref([]),g=e.computed(()=>h=>{const S=((h==null?void 0:h.storageSkus)||[]).map(I=>Number(I.salePrice)),C=Math.min(...S),E=Math.max(...S);return C===E?E/1e4:`${C/1e4}~￥${E/1e4}`}),l=e.computed(()=>h=>h==null?void 0:h.reduce((S,C)=>S+Number(C.stock),0)),V=(h={})=>{n.value=h,r.page.current=1,p()},_=h=>h.storageSkus.find(E=>E.stockType==="UNLIMITED")?"UNLIMITED":h.storageSkus.some(E=>Number(E.stock)>0)?"STOCK":!1,p=async()=>{const h=await ce({...r.page,sellType:"CONSIGNMENT",...n.value});h.data&&(r.total=Number(h.data.total)),a.value=h.data.records.map(S=>({...S,disabled:!_(S)}))};return{pagination:r,tableList:a,multiSelect:c,computedSalePrice:g,computedSuplier:l,handleSearch:V,initList:p,checkLimited:_,handleDistribution:h=>{o.push({path:"/goods/consignment/distribution",query:{shopId:h.shopId,id:h.id}})},handleSizeChange:h=>{r.page.size=h,p()},handleCurrentChange:h=>{r.page.current=h,p()},handleContact:h=>{v(Z.useShopInfoStore().shopInfo.id,h.shopId).then(({code:S})=>{S===200&&o.push({path:"/message/customer/supplierService",query:{id:h.shopId}})})}}},Ie=()=>{const o=e.ref(null),i=e.ref(!1),n=e.ref([]);return{batchDistrubutionRef:o,showBatchDistributionDialog:i,checkedDistributuion:n,openBatchDistributionDialog:a=>{const c=a.filter(g=>{const l=g==null?void 0:g.storageSkus;let V=0,_=!1;return l==null||l.forEach(t=>{V+=Number(t.stock),t.stockType==="LIMITED"&&(_=!0)}),(_?V:"无限库存")!==0});if(c.length===0)return w.ElMessage.error({message:"请选择铺货商品"});n.value=O.cloneDeep(c),i.value=!0}}},$e={class:"handle_container",style:{"padding-top":"16px",display:"flex","align-items":"center","justify-content":"space-between"}},Be={key:0,style:{color:"#999","margin-left":"8px"}},Re={class:"commodity-info"},Fe=["src"],Me={class:"cup productName"},Ue={key:0,class:"virtual_product"},Oe={key:1,class:"productName"},ze={key:0,class:"virtual_product"},qe={style:{color:"#f54319"}},Ae={class:"customer"},He={class:"customer__name"},je={class:"dialog-footer"},Ge=e.defineComponent({__name:"index",setup(o){const{previewData:i,showPreviewDialog:n,handlePreviewData:r}=Le(),a=(b,d)=>{if(!b)return 0;if(b==="UNLIMITED")return"无限库存";if(b==="STOCK")return _.value(d==null?void 0:d.storageSkus)},{pagination:c,tableList:g,multiSelect:l,computedSalePrice:V,computedSuplier:_,handleSearch:p,checkLimited:t,initList:y,handleDistribution:s,handleSizeChange:x,handleCurrentChange:h,handleContact:S}=we();e.onMounted(()=>{y()});const{showBatchDistributionDialog:C,openBatchDistributionDialog:E,batchDistrubutionRef:I,checkedDistributuion:u}=Ie(),N=O.debounce(async()=>{var $;const b=await(($=I.value)==null?void 0:$.buildData()),{code:d,success:k,msg:T}=await ge(b);d===200&&k?(w.ElMessage.success({message:T||"批量铺货成功"}),y(),C.value=!1):w.ElMessage.error({message:T||"批量铺货失败"})},1500,{leading:!0,trailing:!1});return(b,d)=>{const k=e.resolveComponent("el-button"),T=e.resolveComponent("el-tooltip"),$=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(_e,{onSearch:e.unref(p)},null,8,["onSearch"]),e.createElementVNode("div",$e,[e.createElementVNode("div",null,[e.createVNode(k,{type:"primary",onClick:d[0]||(d[0]=m=>e.unref(E)(e.unref(l)))},{default:e.withCtx(()=>d[5]||(d[5]=[e.createTextVNode("一键铺货")])),_:1}),e.unref(l).length>=1?(e.openBlock(),e.createElementBlock("span",Be,"已选"+e.toDisplayString(e.unref(l).length)+"条 ",1)):e.createCommentVNode("",!0)]),e.createVNode(T,{class:"box-item",effect:"dark",placement:"right-start"},{content:e.withCtx(()=>d[6]||(d[6]=[e.createTextVNode(" 1、代销也叫一件代发，无需备货"),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 2、代销商品发货及售后由供应商自行处理 ")])),default:e.withCtx(()=>[e.createVNode(A,{name:"icon-wenhao",size:"18px",style:{cursor:"pointer"}})]),_:1})]),e.createVNode(e.unref(X),{checkedItem:e.unref(l),"onUpdate:checkedItem":d[1]||(d[1]=m=>e.isRef(l)?l.value=m:null),data:e.unref(g),"no-border":"",selection:!0,class:"table"},{default:e.withCtx(()=>[e.createVNode(P,{label:"商品",width:"400"},{default:e.withCtx(({row:m})=>{var L,j;return[e.createElementVNode("div",Re,[e.createElementVNode("img",{src:(j=(L=m.albumPics)==null?void 0:L.split(","))==null?void 0:j.shift()},null,8,Fe),m.productName.length>30?(e.openBlock(),e.createBlock(T,{key:0,content:m.productName,effect:"dark",placement:"top"},{default:e.withCtx(()=>[e.createElementVNode("div",Me,[(m==null?void 0:m.productType)==="VIRTUAL_PRODUCT"?(e.openBlock(),e.createElementBlock("span",Ue,"虚拟")):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(m.productName),1)])]),_:2},1032,["content"])):(e.openBlock(),e.createElementBlock("div",Oe,[(m==null?void 0:m.productType)==="VIRTUAL_PRODUCT"?(e.openBlock(),e.createElementBlock("span",ze,"虚拟")):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(m.productName),1)]))])]}),_:1}),e.createVNode(P,{label:"供货价",width:"210"},{default:e.withCtx(({row:m})=>[e.createElementVNode("span",qe,"￥"+e.toDisplayString(e.unref(V)(m)),1)]),_:1}),e.createVNode(P,{label:"供应商库存",width:"160"},{default:e.withCtx(({row:m})=>[e.createTextVNode(e.toDisplayString(a(e.unref(t)(m),m)),1)]),_:1}),e.createVNode(P,{label:"所属供应商",width:"240",prop:"supplierName"},{default:e.withCtx(({row:m})=>[e.createElementVNode("div",Ae,[e.createElementVNode("div",null,[e.createElementVNode("span",He,e.toDisplayString(m.supplierName),1),e.createVNode(A,{name:"icon-xiaoxi-copy",size:"18px",style:{cursor:"pointer"},svg:"",onClick:L=>e.unref(S)(m)},null,8,["onClick"])]),e.createElementVNode("span",null,e.toDisplayString(m.supplierContractNumber),1)])]),_:1}),e.createVNode(P,{label:"操作",align:"right",fixed:"right",width:"150"},{default:e.withCtx(({row:m})=>[e.createElementVNode("div",null,[e.createVNode(k,{link:"",type:"primary",size:"small",onClick:L=>e.unref(r)(m)},{default:e.withCtx(()=>d[7]||(d[7]=[e.createTextVNode("查看")])),_:2},1032,["onClick"]),e.createVNode(k,{link:"",type:"primary",size:"small",disabled:!e.unref(t)(m),onClick:L=>e.unref(s)(m)},{default:e.withCtx(()=>d[8]||(d[8]=[e.createTextVNode("一键铺货 ")])),_:2},1032,["disabled","onClick"])])]),_:1})]),_:1},8,["checkedItem","data"]),e.createVNode(W,{"page-size":e.unref(c).page.size,"page-num":e.unref(c).page.current,total:e.unref(c).total,onHandleSizeChange:e.unref(x),onHandleCurrentChange:e.unref(h)},null,8,["page-size","page-num","total","onHandleSizeChange","onHandleCurrentChange"]),e.createVNode($,{modelValue:e.unref(n),"onUpdate:modelValue":d[2]||(d[2]=m=>e.isRef(n)?n.value=m:null),title:"商品详情",width:"650px",top:"6vh"},{default:e.withCtx(()=>[e.createVNode(Ne,{"commodity-item":e.unref(i)},null,8,["commodity-item"])]),_:1},8,["modelValue"]),e.createVNode($,{modelValue:e.unref(C),"onUpdate:modelValue":d[4]||(d[4]=m=>e.isRef(C)?C.value=m:null),title:"一键铺货",width:"750px","destroy-on-close":"","close-on-click-modal":!1},{footer:e.withCtx(()=>[e.createElementVNode("span",je,[e.createVNode(k,{onClick:d[3]||(d[3]=m=>C.value=!1)},{default:e.withCtx(()=>d[9]||(d[9]=[e.createTextVNode("取消")])),_:1}),e.createVNode(k,{type:"primary",onClick:e.unref(N)},{default:e.withCtx(()=>d[10]||(d[10]=[e.createTextVNode("确认")])),_:1},8,["onClick"])])]),default:e.withCtx(()=>[e.createVNode(De,{ref_key:"batchDistrubutionRef",ref:I,"batch-items":e.unref(u)},null,8,["batch-items"])]),_:1},8,["modelValue"])],64)}}}),Bt="",Ye=Object.freeze(Object.defineProperty({__proto__:null,default:R(Ge,[["__scopeId","data-v-e3b822c0"]])},Symbol.toStringTag,{value:"Module"})),Ke=e.defineComponent({__name:"search",emits:["search"],setup(o,{emit:i}){const n=e.ref([]),r=e.ref([]),a=e.reactive({supplierId:"",platformCategoryParentId:"",supplierGoodsName:"",deliveryStartTime:void 0,deliveryEndTime:void 0}),c=[{label:"商品名称",prop:"supplierGoodsName",valueType:"copy",fieldProps:{placeholder:"请输入商品名称"}},{label:"供应商",labelWidth:85,prop:"supplierId",valueType:"select",options:n,fieldProps:{placeholder:"请输入供应商名称",props:{expandTrigger:"hover"},filterable:!0,remote:!0,reserveKeyword:!0,remoteMethod:t=>{_(t)}}},{label:"铺货员手机",labelWidth:85,prop:"deliveryUserPhone",valueType:"input",fieldProps:{placeholder:"请填写申请人手机",maxlength:11,type:"text","v-model.number":"",oninput:"value=value.replace(/[^\\d]/g,'')",pattern:"^1[3-9]\\d{9}$"}},{label:"平台类目",valueType:"cascader",options:r,fieldProps:{placeholder:"请选择平台类目",props:{expandTrigger:"hover",label:"name",value:"id",children:"secondCategoryVos"},onChange:t=>{(t==null?void 0:t.length)>1?a.platformCategoryParentId=t[t.length-1]:a.platformCategoryParentId=""}}},{label:"铺货时间",prop:"data",valueType:"date-picker",fieldProps:{type:"daterange",startPlaceholder:"开始时间",endPlaceholder:"结束时间",format:"YYYY/MM/DD",valueFormat:"YYYY-MM-DD",onChange:t=>{a.deliveryStartTime=t?t[0]:void 0,a.deliveryEndTime=t?t[1]:void 0}}}],g=i,l=async()=>{const{data:t,code:y}=await te();r.value=t};e.onMounted(()=>l());const V=()=>{const t=O.cloneDeep(a);delete t.undefined,delete t.data,g("search",t)},_=async(t="")=>{var s;const y=await ee({supplierName:t});y.data&&((s=y.data)!=null&&s.length)&&(n.value=y.data.map(x=>({value:x.id,label:x.name})))},p=()=>{Object.keys(a).forEach(t=>a[t]=""),V()};return(t,y)=>(e.openBlock(),e.createBlock(J,{modelValue:a,"onUpdate:modelValue":y[0]||(y[0]=s=>a=s),columns:c,"show-number":3,onSearchHandle:V,onHandleReset:p},null,8,["modelValue"]))}});var le=(o=>(o.REFUSE="已拒绝",o.UNDER_REVIEW="审核中",o.SELL_OFF="下架",o.SELL_ON="上架",o.SELL_OUT="已售完",o.PLATFORM_SELL_OFF="违规下架",o.UNUSABLE="店铺不可用",o.SUPPLIER_SELL_OFF="供应商下架",o.SUPPLIER_DISABLE="供应商禁用",o))(le||{});const{divTenThousand:M}=F(),We=()=>{const o=G.useRouter(),i=e.ref([]),n=e.ref([]),r=e.ref(),a=e.ref([{supplier:"上架",shop:"上架",address:"1、处于【上架,库存>=1】的代销商品，店铺才能【铺货/上架】"},{supplier:"下架",shop:"供应商下架",address:`1、店铺端下架代销商品不会影响供应商端代销商品的状态</br>
                      2、供应商下架商品时，店铺端自动下架状态变更为【供应商下架】。供应商重新上架后，店铺端才能再次上架代销商品。`},{supplier:"违规下架",shop:"违规下架",address:"1、平台端可【恢复销售】，供应商再重新【上架】后，店铺才能重新【上架】该代销商品"},{supplier:"删除",shop:"同步删除",address:"1、已删除商品无法恢复，但不影响已生成的订单;店铺端无法删除代销商品"},{supplier:"供应商被【禁用】",shop:"自动剔除",address:`1、供应商被禁用后，它的所有代销商品将从店铺端全部剔除，但不影响已生成的订单</br>
                      2、供应商再次【启用】后，店铺需重新铺货代销商品`}]),c=e.reactive({page:{current:1,size:10},total:0}),g=e.ref(!1),l=e.ref({status:""}),V=(u={})=>{l.value={...u,status:l.value.status},c.page.current=1,p()},_=e.computed(()=>u=>{let N=0,b=!1;return u==null||u.forEach(d=>{N+=Number(d.stock),d.stockType==="LIMITED"&&(b=!0)}),b?N:"无限库存"}),p=async()=>{const u=await fe({...c.page,...l.value});u.data&&(c.total=Number(u.data.total),i.value=u.data.records)},t=e.computed(()=>u=>{var k;const N=(k=(u==null?void 0:u.salePrices)||[])==null?void 0:k.map(T=>parseInt(T)),b=Math.min(...N),d=Math.max(...N);return b===d?M(b):`${M(b)}~￥${M(d)}`}),y=e.computed(()=>u=>{var k;const N=(k=(u==null?void 0:u.storageSkus)||[])==null?void 0:k.map(T=>parseInt(T.salePrice)),b=Math.min(...N),d=Math.max(...N);return b===d?M(b):`${M(b)}~￥${M(d)}`}),s=u=>{l.value.status=u,c.page.current=1,p()},x=u=>{c.page.size=u,p()},h=u=>{c.page.current=u,p()},S=(u,N="shopId")=>{v(Z.useShopInfoStore().shopInfo.id,u[N]).then(({code:b})=>{b===200&&o.push({path:"/message/customer/supplierService",query:{id:u[N]}})})},C=(u,N)=>{if(n.value.length===0&&u){w.ElMessage.error("请选择商品");return}E(u,N)},E=async(u,N,b)=>{if(b&&(r.value=b),!r.value&&!u){w.ElMessage.warning("请选择商品");return}let d=u?n.value.map($=>({shopId:$.shopId,productId:$.id})):[{shopId:r.value.shopId,productId:r.value.id}];const{code:k,success:T}=await ue(d,N);k===200&&T&&(n.value=[],w.ElMessage.success(`${N.includes("OFF")?"下":"上"}架成功`),p())};return{searchCondition:l,tableList:i,multiSelect:n,dialogTableVisible:g,gridData:a,handleSearch:V,initList:p,pagination:c,computedSalePrice:t,computedSalePriceRange:y,computedSuplierStock:_,changeStatus:s,StatusMap:le,handleSizeChange:x,handleCurrentChange:h,handleContact:S,removeFromShelves:E,changeCommodityStatus:C,editHandle:u=>{let N="";(u==null?void 0:u.sellType)==="CONSIGNMENT"?N="/goods/list/edit-consignment":N="/goods/list/edit",o.push({path:N,query:{id:u.id,current:(u==null?void 0:u.sellType)!=="CONSIGNMENT"&&c.page.current}})}}},Xe=()=>{const o=e.ref(),i=e.ref(!1);return{currentRow:o,showPreviewDialog:i,openPreviewDialog:r=>{o.value=r,i.value=!0}}},Je=()=>{const o=e.ref(!1),i=e.ref();return{violationReason:i,showViolationReason:o,openViolationReasonDialog:r=>{i.value=r,o.value=!0}}},Ze={style:{"line-height":"30px"},class:"explainData"},Qe=["src"],ve=e.defineComponent({__name:"violation-reason",props:{productViolation:{type:Object,default:()=>({})}},setup(o){const i={PROHIBITED:"违禁品",COUNTERFEIT:"假冒伪劣",EXCESSIVE_PLATFORM_INTERVENTION:"平台介入率太高",TITLE_IRREGULARITY:"标题有问题",OTHER:"其他"},n=o,r=e.computed(()=>{var a,c,g;return{...n.productViolation,violationType:i[(a=n.productViolation)==null?void 0:a.violationType],violationEvidence:(g=(c=n.productViolation)==null?void 0:c.violationEvidence)==null?void 0:g.split(",")}});return(a,c)=>(e.openBlock(),e.createElementBlock("div",Ze,[e.createElementVNode("div",null,[c[0]||(c[0]=e.createElementVNode("p",{class:"explainData_label"},"检查员：",-1)),e.createTextVNode(" "+e.toDisplayString(r.value.rummager),1)]),e.createElementVNode("div",null,[c[1]||(c[1]=e.createElementVNode("p",{class:"explainData_label"},"检查时间：",-1)),e.createTextVNode(" "+e.toDisplayString(r.value.examineDateTime),1)]),e.createElementVNode("div",null,[c[2]||(c[2]=e.createElementVNode("p",{class:"explainData_label"},"类型：",-1)),e.createTextVNode(" "+e.toDisplayString(r.value.violationType),1)]),e.createElementVNode("div",null,[c[3]||(c[3]=e.createElementVNode("p",{class:"explainData_label"},"原因：",-1)),e.createTextVNode(" "+e.toDisplayString(r.value.violationExplain),1)]),e.createElementVNode("div",null,[c[4]||(c[4]=e.createElementVNode("p",{class:"explainData_label"},"相关证据：",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value.violationEvidence,(g,l)=>(e.openBlock(),e.createElementBlock("img",{key:l,src:g,class:"violation-evidence"},null,8,Qe))),128))])]))}}),Ot="",et=R(ve,[["__scopeId","data-v-31d9ae8e"]]),tt={class:"good"},nt={class:"good__info"},ot={class:"good__info"},at={class:"good__img"},lt=e.defineComponent({__name:"preview",props:{currentProduct:{type:Object,default:()=>({})}},setup(o){const i=o,{divTenThousand:n}=F();return(r,a)=>{var V,_;const c=e.resolveComponent("el-image"),g=e.resolveComponent("el-table-column"),l=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock("div",tt,[e.createElementVNode("div",nt,"店铺名称："+e.toDisplayString((V=i.currentProduct)==null?void 0:V.supplierName),1),e.createElementVNode("div",ot,"商品名称："+e.toDisplayString((_=i.currentProduct)==null?void 0:_.name),1),e.createElementVNode("div",at,[a[0]||(a[0]=e.createElementVNode("text",null,"商品图片：",-1)),e.createVNode(c,{style:{width:"100px",height:"100px"},src:i.currentProduct.pic,"preview-src-list":[i.currentProduct.pic]},null,8,["src","preview-src-list"])]),a[1]||(a[1]=e.createElementVNode("div",null,"规格：",-1)),e.createVNode(l,{data:o.currentProduct.storageSkus,height:"350",stripe:"","header-row-style":{"font-size":"12px",color:"#000000"}},{default:e.withCtx(()=>{var p;return[e.createVNode(g,{label:"规格",align:"center"},{default:e.withCtx(({row:t})=>[e.createElementVNode("span",null,e.toDisplayString(t!=null&&t.specs?t==null?void 0:t.specs.join("-"):""),1)]),_:1}),(p=o.currentProduct.storageSkus[0])!=null&&p.image?(e.openBlock(),e.createBlock(g,{key:0,label:"sku图",align:"center"},{default:e.withCtx(({row:t})=>[e.createVNode(c,{src:t==null?void 0:t.image,style:{width:"50px",height:"50px"}},null,8,["src"])]),_:1})):e.createCommentVNode("",!0),e.createVNode(g,{label:"销售价(元)",align:"center"},{default:e.withCtx(({row:t})=>[e.createElementVNode("span",null,e.toDisplayString(t.salePrice&&e.unref(n)(t.salePrice)),1)]),_:1}),e.createVNode(g,{prop:"originalPrice",label:"划线价(元)",align:"center"},{default:e.withCtx(({row:t})=>[e.createElementVNode("span",null,e.toDisplayString(t.price&&e.unref(n)(t.price)),1)]),_:1}),e.createVNode(g,{prop:"weight",label:"重量(kg)",align:"center"},{default:e.withCtx(({row:t})=>[e.createElementVNode("span",null,e.toDisplayString(t.weight),1)]),_:1})]}),_:1},8,["data"])])}}}),zt="",it=R(lt,[["__scopeId","data-v-64385005"]]),rt={class:"tab_container",style:{position:"relative"}},st={class:"handle_container"},dt={class:"commodity-info"},ct=["src"],pt={class:"commodity-info__main"},mt={key:1},ft={style:{color:"#f54319"}},gt={class:"customer"},ut={class:"customer__name"},_t=["innerHTML"],ht=e.defineComponent({__name:"index",setup(o){const{tableList:i,multiSelect:n,searchCondition:r,computedSalePrice:a,computedSalePriceRange:c,dialogTableVisible:g,gridData:l,handleSearch:V,pagination:_,initList:p,computedSuplierStock:t,changeStatus:y,StatusMap:s,handleSizeChange:x,handleCurrentChange:h,handleContact:S,removeFromShelves:C,changeCommodityStatus:E,editHandle:I}=We();e.onMounted(()=>{p()}),F();const{violationReason:u,showViolationReason:N,openViolationReasonDialog:b}=Je(),{currentRow:d,showPreviewDialog:k,openPreviewDialog:T}=Xe();return($,m)=>{const L=e.resolveComponent("el-tab-pane"),j=e.resolveComponent("el-tabs"),z=e.resolveComponent("el-button"),Et=e.resolveComponent("el-tooltip"),kt=e.resolveComponent("el-switch"),Y=e.resolveComponent("el-dialog"),K=e.resolveComponent("el-table-column"),Tt=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(Ke,{onSearch:e.unref(V)},null,8,["onSearch"]),e.createElementVNode("div",rt,[e.createVNode(j,{"model-value":e.unref(r).status,"onUpdate:modelValue":e.unref(y)},{default:e.withCtx(()=>[e.createVNode(L,{name:"",label:"全部"}),e.createVNode(L,{name:"SELL_ON",label:"已上架"}),e.createVNode(L,{name:"SELL_OFF",label:"已下架"}),e.createVNode(L,{name:"PLATFORM_SELL_OFF",label:"违规下架"})]),_:1},8,["model-value","onUpdate:modelValue"]),e.createVNode(A,{name:"icon-wenhao",size:"18px",color:"#333",style:{cursor:"pointer",position:"absolute",right:"20px",top:"25%"},onClick:m[0]||(m[0]=f=>g.value=!0)})]),e.createElementVNode("div",st,[e.withDirectives(e.createVNode(z,{disabled:e.unref(n).length===0,style:{"margin-right":"10px"},round:"",type:"primary",onClick:m[1]||(m[1]=f=>e.unref(E)(!0,"SELL_ON"))},{default:e.withCtx(()=>m[7]||(m[7]=[e.createTextVNode("批量上架")])),_:1},8,["disabled"]),[[e.vShow,["","SELL_OFF"].includes(e.unref(r).status)]]),e.withDirectives(e.createVNode(z,{disabled:e.unref(n).length===0,style:{"margin-right":"10px"},round:"",type:"primary",onClick:m[2]||(m[2]=f=>e.unref(E)(!0,"SELL_OFF"))},{default:e.withCtx(()=>m[8]||(m[8]=[e.createTextVNode("批量下架")])),_:1},8,["disabled"]),[[e.vShow,["","SELL_ON"].includes(e.unref(r).status)]])]),e.createVNode(e.unref(X),{checkedItem:e.unref(n),"onUpdate:checkedItem":m[3]||(m[3]=f=>e.isRef(n)?n.value=f:null),data:e.unref(i),selection:"","no-border":"",style:{overflowY:"auto"},class:"table"},{default:e.withCtx(()=>[e.createVNode(P,{label:"商品",width:"350"},{default:e.withCtx(({row:f})=>{var B,q;return[e.createElementVNode("div",dt,[e.createElementVNode("img",{src:(q=(B=f.pic)==null?void 0:B.split(","))==null?void 0:q.shift()},null,8,ct),e.createElementVNode("div",pt,[f.name.length>30?(e.openBlock(),e.createBlock(Et,{key:0,effect:"dark",content:f.name,placement:"top"},{default:e.withCtx(()=>[e.createElementVNode("span",null,e.toDisplayString(f.name),1)]),_:2},1032,["content"])):(e.openBlock(),e.createElementBlock("span",mt,e.toDisplayString(f.name),1))])])]}),_:1}),e.createVNode(P,{label:"供货价",width:"170"},{default:e.withCtx(({row:f})=>[e.createElementVNode("span",null,"￥"+e.toDisplayString(e.unref(a)(f)),1)]),_:1}),e.createVNode(P,{label:"供应商库存",width:"100"},{default:e.withCtx(({row:f})=>[e.createTextVNode(e.toDisplayString(e.unref(t)(f==null?void 0:f.storageSkus)),1)]),_:1}),e.createVNode(P,{label:"销售价",width:"170"},{default:e.withCtx(({row:f})=>[e.createElementVNode("span",ft,"￥"+e.toDisplayString(e.unref(c)(f)),1)]),_:1}),e.createVNode(P,{label:"状态",width:"120"},{default:e.withCtx(({row:f})=>[["PLATFORM_SELL_OFF"].includes(f.status)?(e.openBlock(),e.createElementBlock("span",{key:0,style:e.normalizeStyle({color:["PLATFORM_SELL_OFF"].includes(f.status)?"#F54319":"#333"})},e.toDisplayString(e.unref(s)[f==null?void 0:f.status]),5)):(e.openBlock(),e.createBlock(kt,{key:1,modelValue:f.status,"onUpdate:modelValue":B=>f.status=B,"inline-prompt":"","active-text":"上架","inactive-text":f.status==="SUPPLIER_SELL_OFF"?"供应商下架":"下架","active-value":"SELL_ON","inactive-value":"SELL_OFF",onClick:B=>e.unref(C)(!1,f.status,f)},null,8,["modelValue","onUpdate:modelValue","inactive-text","onClick"]))]),_:1}),e.createVNode(P,{label:"供应商",width:"140",prop:"supplierName"},{default:e.withCtx(({row:f})=>[e.createElementVNode("div",gt,[e.createElementVNode("div",null,[e.createElementVNode("span",ut,e.toDisplayString(f.supplierName),1),e.createVNode(A,{name:"icon-xiaoxi-copy",size:"18px",style:{cursor:"pointer"},svg:"",onClick:B=>e.unref(S)(f,"supplierId")},null,8,["onClick"])]),e.createElementVNode("span",null,e.toDisplayString(f.supplierContractNumber),1)])]),_:1}),e.createVNode(P,{label:"铺货员",width:"140"},{default:e.withCtx(({row:f})=>[e.createElementVNode("div",null,[e.createElementVNode("p",null,e.toDisplayString(f.extra.deliveryUserName),1),e.createElementVNode("p",null,e.toDisplayString(f.extra.deliveryUserPhone),1)])]),_:1}),e.createVNode(P,{label:"铺货时间",width:"180",prop:"createTime"}),e.createVNode(P,{label:"操作",fixed:"right",align:"right",width:"160"},{default:e.withCtx(({row:f})=>[e.createElementVNode("div",null,[(f==null?void 0:f.status)!=="PLATFORM_SELL_OFF"?(e.openBlock(),e.createBlock(z,{key:0,link:"",type:"primary",onClick:B=>e.unref(I)(f)},{default:e.withCtx(()=>m[9]||(m[9]=[e.createTextVNode("编辑")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0),(f==null?void 0:f.status)==="PLATFORM_SELL_OFF"?(e.openBlock(),e.createBlock(z,{key:1,link:"",type:"primary",size:"small",onClick:B=>{var q;return e.unref(b)((q=f==null?void 0:f.extra)==null?void 0:q.productViolation)}},{default:e.withCtx(()=>m[10]||(m[10]=[e.createTextVNode("违规原因")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0),e.createVNode(z,{link:"",type:"primary",size:"small",onClick:B=>e.unref(T)(f)},{default:e.withCtx(()=>m[11]||(m[11]=[e.createTextVNode("查看 ")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["checkedItem","data"]),e.createVNode(W,{"page-size":e.unref(_).page.size,"page-num":e.unref(_).page.current,total:e.unref(_).total,onHandleSizeChange:e.unref(x),onHandleCurrentChange:e.unref(h)},null,8,["page-size","page-num","total","onHandleSizeChange","onHandleCurrentChange"]),e.createVNode(Y,{modelValue:e.unref(k),"onUpdate:modelValue":m[4]||(m[4]=f=>e.isRef(k)?k.value=f:null),title:"查看",width:"1000px","destroy-on-close":"","close-on-click-modal":!1},{default:e.withCtx(()=>[e.createVNode(it,{currentProduct:e.unref(d)},null,8,["currentProduct"])]),_:1},8,["modelValue"]),e.createVNode(Y,{modelValue:e.unref(N),"onUpdate:modelValue":m[5]||(m[5]=f=>e.isRef(N)?N.value=f:null),title:"违规原因",width:"600px","destroy-on-close":"","close-on-click-modal":!1},{default:e.withCtx(()=>[e.createVNode(et,{"product-violation":e.unref(u)},null,8,["product-violation"])]),_:1},8,["modelValue"]),e.createVNode(Y,{modelValue:e.unref(g),"onUpdate:modelValue":m[6]||(m[6]=f=>e.isRef(g)?g.value=f:null),title:"代销商品各状态说明",center:"",width:"960px"},{default:e.withCtx(()=>[e.createVNode(Tt,{data:e.unref(l),border:"","header-cell-style":{background:"#F5F7FA",fontSize:"16px"}},{default:e.withCtx(()=>[e.createVNode(K,{prop:"supplier",label:"供应商端",width:"200"}),e.createVNode(K,{prop:"shop",label:"店铺端",width:"140"}),e.createVNode(K,{prop:"address",label:"说明"},{default:e.withCtx(({row:f})=>[e.createElementVNode("div",{innerHTML:f.address},null,8,_t)]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])],64)}}}),qt="",yt=Object.freeze(Object.defineProperty({__proto__:null,default:R(ht,[["__scopeId","data-v-3e1c77b2"]])},Symbol.toStringTag,{value:"Module"})),{divTenThousand:ie,mulTenThousand:re}=F(),Vt=()=>{const o=e.ref({type:"RATE",sale:0,scribe:0}),i=()=>{o.value.sale=0,o.value.scribe=0},n=e.ref(),r={type:{required:!0,message:"请选择代销类型",trigger:"change"}},a=()=>{var g;(g=n.value)==null||g.validate(async l=>{if(l){const V=O.cloneDeep(o.value);V.sale=re(o.value.sale).toNumber(),V.scribe=re(o.value.scribe).toNumber();const{code:_,success:p,msg:t}=await me(V);_===200&&p?w.ElMessage.success({message:t||"更新代销设置信息成功"}):w.ElMessage.error({message:t||"更新代销设置信息失败"})}})};return(async()=>{const{data:g,code:l}=await ne();l===200&&g&&(o.value.sale=ie(g==null?void 0:g.sale).toNumber(),o.value.scribe=ie(g==null?void 0:g.scribe).toNumber(),o.value.type=g==null?void 0:g.type)})(),{formRef:n,rules:r,formModel:o,handleChangeType:i,handleSubmitSettingData:a}},xt={class:"settings"},Nt={class:"settings__form"},bt={class:"settings__footer"},Ct=e.defineComponent({__name:"index",setup(o){const{rules:i,formModel:n,formRef:r,handleChangeType:a,handleSubmitSettingData:c}=Vt();return(g,l)=>{const V=e.resolveComponent("el-radio"),_=e.resolveComponent("el-radio-group"),p=e.resolveComponent("el-form-item"),t=e.resolveComponent("el-input-number"),y=e.resolveComponent("el-form"),s=e.resolveComponent("el-button");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xt,[l[16]||(l[16]=e.createStaticVNode('<div class="settings__explain" data-v-a1d51d40><div class="settings__title" data-v-a1d51d40>代销设置说明</div><div class="settings__container" data-v-a1d51d40><p class="settings__container--line" data-v-a1d51d40> 1、设价方式： 统一设价 、自定义设价 ； 价格优先级：<span class="text-red" data-v-a1d51d40>自定义设价 &gt; 统一设价</span></p><p class="settings__container--line" data-v-a1d51d40>2、自定义设价：在上架(铺货) 或 编辑 时可对具体的某个商品进行自定义价格设定</p><p class="settings__container--line" data-v-a1d51d40>3、统一设价：统一设价为默认方案，其优先级低于自定义设价；即有自定义价格则以自定义价格为准</p><p class="settings__container--line" data-v-a1d51d40> 4、无论何种设价方式，系统均可实现随供货价的调整而<span class="text-red" data-v-a1d51d40>自动调整</span>代销商品的划线价、销售价 (划线价 &gt;= 销售价) ，避免亏损 </p></div></div>',1)),e.createElementVNode("div",Nt,[l[15]||(l[15]=e.createElementVNode("span",{class:"setting_form--title"},"统一设价",-1)),e.createVNode(y,{ref_key:"formRef",ref:r,model:e.unref(n),rules:e.unref(i)},{default:e.withCtx(()=>[e.createVNode(p,null,{default:e.withCtx(()=>[e.createVNode(_,{modelValue:e.unref(n).type,"onUpdate:modelValue":l[0]||(l[0]=x=>e.unref(n).type=x),onChange:e.unref(a)},{default:e.withCtx(()=>[e.createVNode(V,{value:"RATE"},{default:e.withCtx(()=>l[5]||(l[5]=[e.createTextVNode("按比例设价")])),_:1}),e.createVNode(V,{value:"REGULAR"},{default:e.withCtx(()=>l[6]||(l[6]=[e.createTextVNode("固定金额设价")])),_:1})]),_:1},8,["modelValue","onChange"])]),_:1}),e.unref(n).type==="RATE"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(p,{prop:"sale"},{default:e.withCtx(()=>[l[7]||(l[7]=e.createElementVNode("span",null,"销售价 = 供货价 + （供货价 *  ",-1)),e.createVNode(t,{modelValue:e.unref(n).sale,"onUpdate:modelValue":l[1]||(l[1]=x=>e.unref(n).sale=x),controls:!1,precision:2,min:0,max:100},null,8,["modelValue"]),l[8]||(l[8]=e.createElementVNode("span",null," % ）",-1))]),_:1}),e.createVNode(p,{prop:"scribe"},{default:e.withCtx(()=>[l[9]||(l[9]=e.createElementVNode("span",null,"划线价 = 销售价 + （销售价 *  ",-1)),e.createVNode(t,{modelValue:e.unref(n).scribe,"onUpdate:modelValue":l[2]||(l[2]=x=>e.unref(n).scribe=x),controls:!1,precision:2,min:0,max:100},null,8,["modelValue"]),l[10]||(l[10]=e.createElementVNode("span",null," % ）",-1))]),_:1})],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createVNode(p,{prop:"sale"},{default:e.withCtx(()=>[l[11]||(l[11]=e.createElementVNode("span",null,"销售价 = 供货价 +  ",-1)),e.createVNode(t,{modelValue:e.unref(n).sale,"onUpdate:modelValue":l[3]||(l[3]=x=>e.unref(n).sale=x),controls:!1,precision:2,min:0},null,8,["modelValue"]),l[12]||(l[12]=e.createElementVNode("span",null," 元",-1))]),_:1}),e.createVNode(p,{prop:"scribe"},{default:e.withCtx(()=>[l[13]||(l[13]=e.createElementVNode("span",null,"划线价 = 销售价 +  ",-1)),e.createVNode(t,{modelValue:e.unref(n).scribe,"onUpdate:modelValue":l[4]||(l[4]=x=>e.unref(n).scribe=x),controls:!1,precision:2,min:0},null,8,["modelValue"]),l[14]||(l[14]=e.createElementVNode("span",null," 元",-1))]),_:1})],64))]),_:1},8,["model","rules"])])]),e.createElementVNode("div",bt,[e.createVNode(s,{type:"primary",onClick:e.unref(c)},{default:e.withCtx(()=>l[17]||(l[17]=[e.createTextVNode("保存")])),_:1},8,["onClick"])])],64)}}}),jt="",St=Object.freeze(Object.defineProperty({__proto__:null,default:R(Ct,[["__scopeId","data-v-a1d51d40"]])},Symbol.toStringTag,{value:"Module"}));return de});

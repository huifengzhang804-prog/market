(function(e,d){typeof exports=="object"&&typeof module<"u"?module.exports=d(require("vue"),require("element-plus"),require("@/apis/http"),require("@/store/modules/shopInfo"),require("@/constant"),require("@/components/element-plus/el-table/ElTableEmpty/index.vue"),require("@/components/PageManage.vue")):typeof define=="function"&&define.amd?define(["vue","element-plus","@/apis/http","@/store/modules/shopInfo","@/constant","@/components/element-plus/el-table/ElTableEmpty/index.vue","@/components/PageManage.vue"],d):(e=typeof globalThis<"u"?globalThis:e||self,e.ShopInvoiceHeader=d(e.ShopInvoiceHeaderContext.Vue,e.ShopInvoiceHeaderContext.ElementPlus,e.ShopInvoiceHeaderContext.Request,e.ShopInvoiceHeaderContext.ShopInfoStore,e.ShopInvoiceHeaderContext.Constant,e.ShopInvoiceHeaderContext.ElTableEmpty,e.ShopInvoiceHeaderContext.PageManageTwo))})(this,function(e,d,f,y,h,E,I){"use strict";var N=document.createElement("style");N.textContent=`@charset "UTF-8";.head[data-v-2e7bd818]{padding:0 30px 20px;display:flex;align-items:center;justify-content:space-between}.head__title[data-v-2e7bd818]{color:#bebebe;font-size:14px}.flex[data-v-2e7bd818]{display:flex}
`,document.head.appendChild(N);const b=l=>f.get({url:"addon-invoice/invoice/invoice-headers/pageInvoiceHeader",params:{...l,ownerType:"SHOP"}}),H=l=>f.put({url:"addon-invoice/invoice/invoice-headers/default-invoice-header",data:l}),w=l=>f.post({url:"addon-invoice/invoice/invoice-headers/invoice-header",data:l}),k=l=>f.del({url:`addon-invoice/invoice/invoice-headers/${l}`}),T=l=>f.get({url:"addon-invoice/invoice/invoice-headers",params:l}),S={class:"q_plugin_container"},v={class:"head handle_container"},A={class:"table_container"},B={class:"flex"},P={key:0,style:{color:"rgba(24, 144, 255, 1)"}},R={class:"right_btn"},q={class:"dialog-footer"},M=e.defineComponent({__name:"ShopInvoiceHeader",setup(l){const V=y.useShopInfoStore(),g=e.ref([]),i=e.ref(!1),x=e.ref(),n=e.ref({id:"",ownerType:"SHOP",ownerId:V.getterShopInfo.id,invoiceHeaderType:"ENTERPRISE",header:"",taxIdentNo:"",openingBank:"",bankAccountNo:"",enterprisePhone:"",enterpriseAddress:"",email:""}),z=e.reactive({invoiceHeaderType:[{required:!0,message:"请选择抬头类型",trigger:"blur"}],header:[{required:!0,message:"请输入抬头",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:h.REGEX.EMAIL,message:"请输入正确的邮箱",trigger:"blur"}],taxIdentNo:[{required:!0,message:"请输入税号",trigger:"blur"}],enterprisePhone:[{pattern:h.REGEX.MOBILE,message:"请输入正确的手机号",trigger:"blur"}]}),s=e.reactive({size:10,current:1,total:0}),D=a=>{s.current=1,s.size=a,u()},O=a=>{s.current=a,u()};async function u(){const{code:a,data:t,msg:r}=await b(s);if(a!==200)return d.ElMessage.error(r||"获取发票抬头列表失败");g.value=t.records,s.current=t.current,s.total=t.total}u();async function U(a){const{code:t,data:r,msg:c}=await H({id:a,ownerType:"SHOP",ownerId:V.getterShopInfo.id});if(t!==200)return d.ElMessage.error(c||"设置默认抬头失败");u()}const F=()=>{n.value={...n.value,openingBank:"",bankAccountNo:"",enterprisePhone:"",enterpriseAddress:""}};async function $(){x.value.validate(async a=>{a&&L()})}async function L(){n.value.invoiceHeaderType==="PERSONAL"&&(n.value.taxIdentNo="");const{code:a,data:t,msg:r}=await w(n.value);if(a!==200)return d.ElMessage.error(r||"保存失败");d.ElMessage.success("保存成功"),u(),i.value=!1}const G=()=>{i.value=!1,n.value={...n.value,id:"",invoiceHeaderType:"ENTERPRISE",header:"",email:"",taxIdentNo:"",openingBank:"",bankAccountNo:"",enterprisePhone:"",enterpriseAddress:""},x.value.resetFields()},j=a=>{d.ElMessageBox.confirm("确定要删除该抬头?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{code:t,success:r}=await k(a);t===200&&r?(d.ElMessage.success("删除成功"),u()):d.ElMessage.error("删除失败")})},X=async a=>{const{code:t,msg:r,data:c}=await T({invoiceHeaderId:a,invoiceHeaderOwnerType:"SHOP"});if(t!==200)return d.ElMessage.error(r||"获取详情失败");n.value={...n.value,...c},i.value=!0};return(a,t)=>{const r=e.resolveComponent("el-button"),c=e.resolveComponent("el-table-column"),J=e.resolveComponent("el-table"),_=e.resolveComponent("el-radio"),K=e.resolveComponent("el-radio-group"),p=e.resolveComponent("el-form-item"),m=e.resolveComponent("el-input"),Q=e.resolveComponent("el-form"),W=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock("div",S,[e.createElementVNode("div",v,[t[12]||(t[12]=e.createElementVNode("div",{class:"head__title"},"您向供应商申请开票时需要使用的发票信息",-1)),e.createVNode(r,{type:"primary",round:"",onClick:t[0]||(t[0]=o=>i.value=!0)},{default:e.withCtx(()=>t[11]||(t[11]=[e.createTextVNode("新增")])),_:1})]),e.createElementVNode("div",A,[e.createVNode(J,{stripe:"",data:g.value,"header-row-style":{color:"#333",height:"48px"},"header-cell-style":{background:"#F7F8FA"},"cell-style":{fontSize:"14px",color:"#333333"}},{empty:e.withCtx(()=>[e.createVNode(E)]),default:e.withCtx(()=>[e.createVNode(c,{prop:"contactName",label:"抬头"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",B,[o.isDefault?(e.openBlock(),e.createElementBlock("div",P,"默认")):e.createCommentVNode("",!0),e.createElementVNode("div",null,e.toDisplayString(o.header),1)])]),_:1}),e.createVNode(c,{prop:"taxIdentNo",label:"税号"}),e.createVNode(c,{prop:"email",label:"邮箱"}),e.createVNode(c,{prop:"invoiceHeaderType",label:"抬头类型",width:"100"},{default:e.withCtx(({row:o})=>[e.createTextVNode(e.toDisplayString(o.invoiceHeaderType==="PERSONAL"?"个人":"企业"),1)]),_:1}),e.createVNode(c,{fixed:"right",label:"操作",align:"right",width:"250"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",R,[o.isDefault?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(r,{key:0,type:"primary",size:"small",link:"",onClick:C=>U(o.id)},{default:e.withCtx(()=>t[13]||(t[13]=[e.createTextVNode("设为默认")])),_:2},1032,["onClick"])),e.createVNode(r,{type:"primary",size:"small",link:"",onClick:C=>X(o.id)},{default:e.withCtx(()=>t[14]||(t[14]=[e.createTextVNode("编辑")])),_:2},1032,["onClick"]),e.createVNode(r,{type:"danger",size:"small",link:"",onClick:C=>j(o.id)},{default:e.withCtx(()=>t[15]||(t[15]=[e.createTextVNode("删除")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),e.createVNode(I,{"page-size":s.size,"page-num":s.current,total:s.total,onHandleSizeChange:D,onHandleCurrentChange:O},null,8,["page-size","page-num","total"]),e.createVNode(W,{modelValue:i.value,"onUpdate:modelValue":t[10]||(t[10]=o=>i.value=o),title:"发票抬头",width:"650px",center:"",onClose:G},{footer:e.withCtx(()=>[e.createElementVNode("span",q,[e.createVNode(r,{onClick:t[9]||(t[9]=o=>i.value=!1)},{default:e.withCtx(()=>t[18]||(t[18]=[e.createTextVNode("取消")])),_:1}),e.createVNode(r,{type:"primary",onClick:$},{default:e.withCtx(()=>t[19]||(t[19]=[e.createTextVNode("确定")])),_:1})])]),default:e.withCtx(()=>[e.createVNode(Q,{ref_key:"FormRef",ref:x,"label-position":"right","label-width":"90px",model:n.value,rules:z,style:{"max-width":"100%"}},{default:e.withCtx(()=>[e.createVNode(p,{label:"抬头类型",prop:"invoiceHeaderType"},{default:e.withCtx(()=>[e.createVNode(K,{modelValue:n.value.invoiceHeaderType,"onUpdate:modelValue":t[1]||(t[1]=o=>n.value.invoiceHeaderType=o),onChange:F},{default:e.withCtx(()=>[e.createVNode(_,{value:"ENTERPRISE"},{default:e.withCtx(()=>t[16]||(t[16]=[e.createTextVNode("企业")])),_:1}),e.createVNode(_,{value:"PERSONAL"},{default:e.withCtx(()=>t[17]||(t[17]=[e.createTextVNode("个人 或 事业单位")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createVNode(p,{label:"发票抬头",prop:"header",required:!0},{default:e.withCtx(()=>[e.createVNode(m,{modelValue:n.value.header,"onUpdate:modelValue":t[2]||(t[2]=o=>n.value.header=o),maxlength:"32"},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"邮箱",prop:"email",required:!0},{default:e.withCtx(()=>[e.createVNode(m,{modelValue:n.value.email,"onUpdate:modelValue":t[3]||(t[3]=o=>n.value.email=o),placeholder:"请正确填写邮箱接收电子发票"},null,8,["modelValue"])]),_:1}),n.value.invoiceHeaderType==="ENTERPRISE"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(p,{label:"税号",prop:"taxIdentNo",required:!0},{default:e.withCtx(()=>[e.createVNode(m,{modelValue:n.value.taxIdentNo,"onUpdate:modelValue":t[4]||(t[4]=o=>n.value.taxIdentNo=o),maxlength:"20"},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"开户行",prop:"openingBank"},{default:e.withCtx(()=>[e.createVNode(m,{modelValue:n.value.openingBank,"onUpdate:modelValue":t[5]||(t[5]=o=>n.value.openingBank=o),maxlength:"255"},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"银行账号",prop:"bankAccountNo"},{default:e.withCtx(()=>[e.createVNode(m,{modelValue:n.value.bankAccountNo,"onUpdate:modelValue":t[6]||(t[6]=o=>n.value.bankAccountNo=o),maxlength:"19"},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"企业电话",prop:"enterprisePhone"},{default:e.withCtx(()=>[e.createVNode(m,{modelValue:n.value.enterprisePhone,"onUpdate:modelValue":t[7]||(t[7]=o=>n.value.enterprisePhone=o),maxlength:"11",onkeyup:"value=value.replace(/[^\\d]/g,'')"},null,8,["modelValue"])]),_:1}),e.createVNode(p,{label:"企业地址",prop:"enterpriseAddress"},{default:e.withCtx(()=>[e.createVNode(m,{modelValue:n.value.enterpriseAddress,"onUpdate:modelValue":t[8]||(t[8]=o=>n.value.enterpriseAddress=o),maxlength:"255"},null,8,["modelValue"])]),_:1})],64)):e.createCommentVNode("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Y="";return((l,V)=>{const g=l.__vccOpts||l;for(const[i,x]of V)g[i]=x;return g})(M,[["__scopeId","data-v-2e7bd818"]])});

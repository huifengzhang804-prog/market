(function(e,re){typeof exports=="object"&&typeof module<"u"?module.exports=re(require("vue"),require("@/components/chrome-tab/index.vue"),require("@/components/PageManage.vue"),require("decimal.js"),require("element-plus"),require("@/composables/useConvert"),require("@/components/SchemaForm.vue"),require("@/components/element-plus/el-table/ElTableEmpty/index.vue"),require("vue-clipboard3"),require("vue-router"),require("@/utils/date"),require("@element-plus/icons-vue"),require("@/components/q-icon/q-icon.vue"),require("@/components/qszr-core/packages/q-table/QTable"),require("@/components/qszr-core/packages/q-table/q-table-column.vue"),require("@/apis/http"),require("@/components/q-editor/q-edit.vue")):typeof define=="function"&&define.amd?define(["vue","@/components/chrome-tab/index.vue","@/components/PageManage.vue","decimal.js","element-plus","@/composables/useConvert","@/components/SchemaForm.vue","@/components/element-plus/el-table/ElTableEmpty/index.vue","vue-clipboard3","vue-router","@/utils/date","@element-plus/icons-vue","@/components/q-icon/q-icon.vue","@/components/qszr-core/packages/q-table/QTable","@/components/qszr-core/packages/q-table/q-table-column.vue","@/apis/http","@/components/q-editor/q-edit.vue"],re):(e=typeof globalThis<"u"?globalThis:e||self,e.PlatformDistribute=re(e.PlatformDistributeContext.Vue,e.PlatformDistributeContext.ChromeTab,e.PlatformDistributeContext.PageManageTwo,e.PlatformDistributeContext.Decimal,e.PlatformDistributeContext.ElementPlus,e.PlatformDistributeContext.UseConvert,e.PlatformDistributeContext.SchemaForm,e.PlatformDistributeContext.ElTableEmpty,e.PlatformDistributeContext.VueClipboard3,e.PlatformDistributeContext.VueRouter,e.PlatformDistributeContext.DateUtil,e.PlatformDistributeContext.ElementPlusIconsVue,e.PlatformDistributeContext.QIcon,e.PlatformDistributeContext.QTable,e.PlatformDistributeContext.QTableColumn,e.PlatformDistributeContext.Request,e.PlatformDistributeContext.QEditor))})(this,function(e,re,se,F,T,te,fe,he,we,Ee,ke,Te,de,Se,M,H,be){"use strict";var xe=document.createElement("style");xe.textContent=`@charset "UTF-8";[data-v-2ccd97f4]{font-size:14px}.input-with-select .el-input-group__prepend[data-v-2ccd97f4]{background-color:var(--el-fill-color-blank)}.ellipsis[data-v-2ccd97f4]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.dis__header[data-v-2ccd97f4]{margin-bottom:16px;padding-left:16px}.com[data-v-2ccd97f4]{width:270px;font-size:12px;color:#515151;display:flex}.com__img[data-v-2ccd97f4]{display:inline-block;width:68px;height:68px;margin-right:12px}.com__right[data-v-2ccd97f4]{height:68px;display:flex;flex-direction:column;justify-content:space-between;text-align:left}.com__right--name[data-v-2ccd97f4]{width:174px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden;line-height:1.2em}.colorRed[data-v-2ccd97f4]{color:#f54319}.dialogCom[data-v-2ccd97f4]{display:flex;justify-content:center;align-items:center}.dialogCom__img[data-v-2ccd97f4]{width:60px;height:60px;margin-right:12px;border-radius:10px}.dialogCom__right--name[data-v-2ccd97f4]{width:210px;font-size:14px;color:#333;line-height:20px}.amount[data-v-2ccd97f4]:before{content:"￥";display:inline-block}.percentage[data-v-2ccd97f4]:after{content:"%";display:inline-block}.head[data-v-e2f0bc92]{width:1256px;display:flex;align-items:center;background-color:#e9ecf0;height:52px;padding-left:16px;color:#333}.head div[data-v-e2f0bc92]:after{content:"|";padding:0 8px;position:relative;top:-1px;color:#333!important}.head .last[data-v-e2f0bc92]:after{content:""}.content[data-v-e2f0bc92]{display:flex}.content__right1[data-v-e2f0bc92]{border:1px solid #ebeef5;display:flex;align-items:center;justify-content:space-around;line-height:26px;width:470px;padding-left:10px;flex-shrink:0}.content__right1--item[data-v-e2f0bc92]{display:flex;flex-direction:column}.content__right1--item span[data-v-e2f0bc92]{line-height:18px}.content__right2[data-v-e2f0bc92]{flex-shrink:0;width:157px;font-size:13px;text-align:center;line-height:26px}.content__right2--item[data-v-e2f0bc92]{height:100px;line-height:100px;border:1px solid #ebeef5}.content__right3[data-v-e2f0bc92]{width:196px;flex-shrink:0;font-size:13px;border:1px solid #ebeef5;display:flex;flex-wrap:wrap;justify-content:center;flex-direction:column;padding-left:5px;line-height:26px}.content__right3--item[data-v-e2f0bc92]{padding:0 10px}.goods[data-v-e2f0bc92]{width:410px;height:68px;display:flex}.goods__pic[data-v-e2f0bc92]{margin-right:10px;width:60px;height:50px;position:relative}.goods__pic--state[data-v-e2f0bc92]{background:#7f83f7;position:absolute;width:40px;height:40px;border-radius:50%;top:5px;left:10px;color:#fff;line-height:40px;text-align:center;font-size:10px}.goods__info[data-v-e2f0bc92]{display:flex;flex-direction:column;justify-content:space-between;margin-left:10px}.goods__info-flex[data-v-e2f0bc92]{width:310px;display:flex;align-items:center;justify-content:space-between}.goods__info-flex--name[data-v-e2f0bc92]{max-width:220px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden;margin-right:10px}.goods__info-flex--price[data-v-e2f0bc92]{font-size:12px}.goods__info-flex--specs[data-v-e2f0bc92]{color:#999;max-width:210px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.goods__info-flex--num[data-v-e2f0bc92]{position:relative;top:7px;font-size:12px}[data-v-e2f0bc92] .el-table thead{display:none}.amount[data-v-e2f0bc92]:before{content:"￥";display:inline-block}.percentage[data-v-e2f0bc92]:after{content:"%";display:inline-block}.ellipsis[data-v-e2f0bc92]{max-width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.buyer[data-v-e2f0bc92]{max-width:100px;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.buyer-container[data-v-e2f0bc92]{display:flex;justify-content:flex-start;align-items:center}.name[data-v-e2f0bc92]{width:109px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#555cfd;cursor:pointer}.description__content[data-v-bfb8f6d3]{margin-bottom:15px;line-height:22px;color:#101010}.distribution_order_table_container[data-v-fc671b1b]{overflow:auto;position:relative;border-left:16px solid transparent;border-right:16px solid transparent}.distribution_order_table_container .tbhead[data-v-fc671b1b]{background-color:#f2f2f2;position:sticky;top:0;z-index:100}.count[data-v-fc671b1b]{height:48px;line-height:48px}.count span[data-v-fc671b1b]{margin-right:30px}.count span text[data-v-fc671b1b]{font-weight:700;font-size:12px}.tbhead[data-v-fc671b1b]{width:1256px;display:flex;align-items:center;height:48px;font-weight:700;background-color:#f2f2f280}.tbhead__goods[data-v-fc671b1b]{margin-left:16%}.tbhead__state[data-v-fc671b1b]{margin-left:23%}.tbhead__detail[data-v-fc671b1b]{margin-left:29%}.tbhead__total[data-v-fc671b1b]{margin-left:8%}.ml[data-v-fc671b1b]{margin-left:30px}[data-v-19950ab8]{font-size:14px}.q-table[data-v-19950ab8]{width:100%;overflow:auto}.color51[data-v-19950ab8]{color:#515151;height:52px;display:flex;flex-direction:column;justify-content:space-around}.color58[data-v-19950ab8]{color:#586884}.color33[data-v-19950ab8]{color:#333}.column[data-v-19950ab8]{display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start}.column button[data-v-19950ab8]{margin:0}.ellipsis[data-v-19950ab8]{width:135px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:14px}.ml[data-v-19950ab8]{margin-left:30px}.col[data-v-d60e7af4]{margin:16px 16px 0 0;background:#f6f8fa;height:50px;display:flex;justify-content:flex-start;align-items:center;font-size:13px;color:#515151}.col__icon[data-v-d60e7af4]{width:4px;height:16px;margin:0 17px 0 19px}[data-v-d60e7af4] .el-form-item__label{margin-right:20px;color:#666}.save[data-v-d60e7af4]{width:100%;margin-top:auto;display:flex;justify-content:center;align-items:center;height:52px;background-color:#fff;box-shadow:0 0 16px #00000012;position:sticky;bottom:0}.mb33[data-v-d60e7af4]{margin-bottom:33px}.mb26[data-v-d60e7af4]{margin-bottom:26px}.tip[data-v-d60e7af4]{font-size:13px;color:#d5d5d5}
`,document.head.appendChild(xe);const De={class:"q_plugin_container"},Ie=e.defineComponent({__name:"PlatformDistribute",setup(n){const s={distributionCom:e.defineAsyncComponent(()=>Promise.resolve().then(()=>it)),distributionOrder:e.defineAsyncComponent(()=>Promise.resolve().then(()=>fo)),wholeSaler:e.defineAsyncComponent(()=>Promise.resolve().then(()=>So)),distributionSet:e.defineAsyncComponent(()=>Promise.resolve().then(()=>Uo))},m=e.ref("distributionCom"),a=[{label:"分销商品",name:"distributionCom"},{label:"分销订单",name:"distributionOrder"},{label:"分销商",name:"wholeSaler"},{label:"分销设置",name:"distributionSet"}],r=e.computed(()=>s[m.value]),i=f=>{f&&(m.value=f)};return(f,l)=>(e.openBlock(),e.createElementBlock("div",De,[e.createVNode(re,{tabList:a,value:m.value,onHandleTabs:i},null,8,["value"]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(r.value),{ref:"componentRef"},null,512))]))}}),Be=n=>H.put({url:"addon-distribute/distribute/config",data:n}),$e=n=>H.post({url:"addon-distribute/distribute/product/page",data:n}),Ne=()=>H.get({url:"addon-distribute/distribute/config"}),Pe=n=>H.get({url:"addon-distribute/distribute/order",params:n}),Oe=n=>H.get({url:"addon-distribute/distribute/distributor",params:n}),Ue=n=>H.get({url:"addon-distribute/distribute/distributor/team",params:n}),Ae=n=>H.get({url:"addon-distribute/distribute/distributor/rank",params:n}),ue=n=>H.put({url:`addon-distribute/distribute/product/cancel/${n}`}),Ve=(n,s,m)=>H.post({url:"addon-distribute/distribute/distributor/distributor/apply",data:{pass:n,ids:s,rejectReason:m}}),ze=n=>H.get({url:`addon-distribute/distribute/distributor/rejectReason/${n}`}),Fe=n=>H.post({url:"addon-distribute/distribute/order/export",data:n}),{divTenThousand:Q,divHundred:ge}=te();function Le(n,s,m,a,r,i){if(n==="FIXED_AMOUNT"){a=+Q(a),r=+Q(r),i=+Q(i);const f=(a+r+i).toFixed(2);return`${a} + ${r} + ${i} = ${f}`}else if(s=+Q(s),m=+Q(m),a=+ge(Q(a)),r=+ge(Q(r)),i=+ge(Q(i)),i)if(r){const f=(m*a+m*r+m*i).toFixed(2),l=(s*a+s*r+s*i).toFixed(2);return s===m?`${s} * ${a} + ${s} * ${r} + ${s} * ${i} = ${l}`:`${s} * ${a} + ${s} * ${r} + ${s} * ${i} = ${l} </br> ${m} * ${a} + ${m} * ${r} + ${m} * ${i} = ${f}`}else{const f=(m*a).toFixed(2),l=(s*a).toFixed(2);return s===m?s+" * "+a+"   = "+l:`${s} * ${a} = ${l} </br> ${m} * ${a} = ${f}`}else{const f=(m*a+m*r).toFixed(2),l=(s*a+s*r).toFixed(2);return s===m?`${s} * ${a} + ${s} * ${r} = ${l}`:`${s} * ${a} + ${s} * ${r} = ${l} </br> ${m} * ${a} + ${m} * ${r} = ${f}`}}const Re={key:0,class:"handle_container"},qe={class:"table_container"},Me={class:"ellipsis f12"},je={key:1,class:"ellipsis f12"},He={class:"com"},We={class:"com__right"},Xe={class:"com__right--name"},Ye={key:0,class:"virtual_product"},Ge={key:1,class:"com__right--name"},Je={key:0,class:"virtual_product"},Ke={key:2},Ze={key:3},Qe={class:"f12"},ve={class:"f12 color51"},et={key:0,class:"f12 color51"},tt={key:1,class:"f12 color51"},ot={style:{display:"flex"}},nt={key:0,placement:"bottom",effect:"light",class:"colorRed"},lt={key:1,class:"f12 colorRed"},at={class:"f12"},rt=e.defineComponent({__name:"DistributionComP",setup(n){e.ref(!1);const s=e.ref("ONE"),m=e.ref({}),{divTenThousand:a,divHundred:r}=te(),i=e.reactive({current:1,size:10,total:0,list:[],distributionStatus:"ALL",productName:"",shopName:""});e.ref("");const f=e.ref([]),l=[{label:"店铺名称",labelWidth:75,prop:"shopName",valueType:"copy",fieldProps:{placeholder:"请输入店铺名称",maxlength:20}},{label:"商品名称",prop:"productName",valueType:"copy",fieldProps:{placeholder:"请输入商品名称",maxlength:30}}];W(),b();const O=h=>{i.current=h,b()},_=h=>{i.current=1,i.size=h,b()},d=()=>{i.current=1,b()},C=()=>{i.current=1,i.productName="",i.shopName="",b()},$=async h=>{T.ElMessageBox.confirm("确定取消分销当前商品？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{code:t,success:c}=await ue([h.id]);t===200&&c?(T.ElMessage.success("取消分销成功"),b()):T.ElMessage.error("取消分销失败")})},A=h=>{f.value=h},w=()=>{if(!f.value.length){T.ElMessage.warning("请选择商品");return}T.ElMessageBox.confirm("确定需要取消分销商品？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const h=f.value.map(k=>k.id),{code:t,success:c}=await ue(h);t===200&&c?(T.ElMessage.success("取消分销成功"),b()):T.ElMessage.error("取消分销失败")})};async function b(){const{code:h,data:t}=await $e({current:i.current,size:i.size,productName:i.productName,shopName:i.shopName,distributionStatus:i.distributionStatus==="ALL"?null:i.distributionStatus});h===200&&t?(i.list=t.records.map(c=>({...c,originSalePrices:[...new Set(c.salePrices)].sort()})),i.total=t.total,console.log("distributeInfo.list",i.list)):T.ElMessage.error("获取分销商品失败")}function S(h){return h==="SELL_ON"?"上架":h==="SELL_OFF"?"下架":"违规禁用"}const E=()=>{i.current=1,b()};function R(h,t){return h==="UNIFIED"&&m.value.shareType==="RATE",a(t)}async function W(){const{code:h,data:t}=await Ne();h===200?(s.value=t.level,(t.one||t.two||t.three)&&(t.one=t.shareType==="FIXED_AMOUNT"?String(a(t.one)):String(r(t.one)),t.two=t.shareType==="FIXED_AMOUNT"?String(a(t.two)):String(r(t.two)),t.three=t.shareType==="FIXED_AMOUNT"?String(a(t.three)):String(r(t.three)),m.value=t)):T.ElMessage.error("获取分销配置失败")}const j=(h,t)=>t.shareType!=="UNIFIED"?t.shareType==="RATE"?s.value==="ONE"?h.mul(a(r(t.one))).toFixed(2):s.value==="TWO"?h.mul(a(r(t.one))).add(h.mul(r(r(t.two)))).toFixed(2):h.mul(a(r(t.one))).add(h.mul(a(r(t.two)))).add(h.mul(a(r(t.three)))).toFixed(2):s.value==="ONE"?a(t.one).toFixed(2):s.value==="TWO"?a(t.one).add(a(t.two)).toFixed(2):a(t.one).add(a(t.two)).add(a(t.three)).toFixed(2):m.value.shareType==="RATE"?s.value==="ONE"?h.mul(r(m.value.one)).toFixed(2):s.value==="TWO"?h.mul(r(m.value.one)).add(h.mul(r(m.value.two))).toFixed(2):h.mul(r(m.value.one)).add(h.mul(r(m.value.two))).add(h.mul(r(m.value.three))).toFixed(2):s.value==="ONE"?new F(m.value.one).toFixed(2):s.value==="TWO"?new F(m.value.one).add(m.value.two).toFixed(2):new F(m.value.one).add(m.value.two).add(m.value.three).toFixed(2);return(h,t)=>{const c=e.resolveComponent("el-tab-pane"),k=e.resolveComponent("el-tabs"),u=e.resolveComponent("el-button"),P=e.resolveComponent("el-table-column"),z=e.resolveComponent("el-tooltip"),G=e.resolveComponent("el-image"),y=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(fe,{modelValue:i,"onUpdate:modelValue":t[0]||(t[0]=o=>i=o),columns:l,onSearchHandle:d,onHandleReset:C},null,8,["modelValue"]),e.createVNode(k,{modelValue:i.distributionStatus,"onUpdate:modelValue":t[1]||(t[1]=o=>i.distributionStatus=o),class:"demo-tabs tab_container",onTabChange:E},{default:e.withCtx(()=>[e.createVNode(c,{label:"全部",name:"ALL"}),e.createVNode(c,{label:"分销中",name:"IN_DISTRIBUTION"}),e.createVNode(c,{label:"取消分销",name:"CANCEL_DISTRIBUTION"})]),_:1},8,["modelValue"]),i.distributionStatus!=="CANCEL_DISTRIBUTION"?(e.openBlock(),e.createElementBlock("div",Re,[e.createVNode(u,{round:"",disabled:f.value.length===0,onClick:w},{default:e.withCtx(()=>t[2]||(t[2]=[e.createTextVNode("取消分销")])),_:1},8,["disabled"])])):e.createCommentVNode("",!0),e.createElementVNode("div",qe,[e.createVNode(y,{data:i.list,"header-cell-style":{background:"#F7F8FA",height:"48px",color:"#333"},"cell-style":{height:"100px"},onSelectionChange:A},{empty:e.withCtx(()=>[e.createVNode(he)]),default:e.withCtx(()=>[i.distributionStatus!=="CANCEL_DISTRIBUTION"?(e.openBlock(),e.createBlock(P,{key:0,type:"selection",width:"50",fixed:"left"})):e.createCommentVNode("",!0),e.createVNode(P,{width:"140",label:"店铺信息",align:"left"},{default:e.withCtx(({row:o})=>[o.shopName.length>=14?(e.openBlock(),e.createBlock(z,{key:0,class:"box-item",effect:"dark",content:o.shopName,placement:"top"},{default:e.withCtx(()=>[e.createElementVNode("div",Me,e.toDisplayString(o.shopName),1)]),_:2},1032,["content"])):(e.openBlock(),e.createElementBlock("div",je,e.toDisplayString(o.shopName),1))]),_:1}),e.createVNode(P,{label:"商品信息",width:"290",align:"left"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",He,[e.createVNode(G,{class:"com__img",src:o.pic},null,8,["src"]),e.createElementVNode("div",We,[o.name.length>=30?(e.openBlock(),e.createBlock(z,{key:0,class:"box-item",effect:"dark",content:o.name,placement:"top"},{default:e.withCtx(()=>[e.createElementVNode("div",Xe,[o.productType==="VIRTUAL_PRODUCT"?(e.openBlock(),e.createElementBlock("span",Ye,"虚拟")):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(o.name),1)])]),_:2},1032,["content"])):(e.openBlock(),e.createElementBlock("div",Ge,[o.productType==="VIRTUAL_PRODUCT"?(e.openBlock(),e.createElementBlock("span",Je,"虚拟")):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(o.name),1)])),o.originSalePrices.length>1?(e.openBlock(),e.createElementBlock("div",Ke," ￥"+e.toDisplayString(e.unref(a)(o.originSalePrices[0]))+" ~ ￥"+e.toDisplayString(e.unref(a)(o.originSalePrices[o.originSalePrices.length-1])),1)):(e.openBlock(),e.createElementBlock("div",Ze,"￥"+e.toDisplayString(e.unref(a)(o.originSalePrices[0])),1))])])]),_:1}),e.createVNode(P,{label:"库存",width:"100",align:"left"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",Qe,e.toDisplayString(o.stock),1)]),_:1}),e.createVNode(P,{label:"商品状态",width:"100",align:"left"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",{class:"f12",style:e.normalizeStyle({color:["SELL_ON"].includes(o.status)?"#333":["SELL_OFF"].includes(o.status)?"#999":"#F54319"})},e.toDisplayString(S(o.status)),5)]),_:1}),e.createVNode(P,{label:"分销状态",width:"110",align:"left"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",{class:"f12",style:e.normalizeStyle({color:["IN_DISTRIBUTION"].includes(o.distributionStatus)?"#333":"#999"})},e.toDisplayString(o.distributionStatus==="IN_DISTRIBUTION"?"分销中":"取消分销"),5)]),_:1}),e.createVNode(P,{label:"分佣参数",width:"110",align:"left"},{default:e.withCtx(({row:o})=>[e.createElementVNode("div",ve,[t[3]||(t[3]=e.createTextVNode(" 一级:")),e.createElementVNode("span",{class:e.normalizeClass([o.shareType==="UNIFIED"?m.value.shareType==="FIXED_AMOUNT"?"amount":"percentage":o.shareType==="FIXED_AMOUNT"?"amount":"percentage"])},e.toDisplayString(R(o.shareType,o.one)),3)]),s.value!=="ONE"&&o.two?(e.openBlock(),e.createElementBlock("div",et,[t[4]||(t[4]=e.createTextVNode(" 二级:")),e.createElementVNode("span",{class:e.normalizeClass([o.shareType==="UNIFIED"?m.value.shareType==="FIXED_AMOUNT"?"amount":"percentage":o.shareType==="FIXED_AMOUNT"?"amount":"percentage"])},e.toDisplayString(R(o.shareType,o.two)),3)])):e.createCommentVNode("",!0),s.value==="THREE"&&o.three?(e.openBlock(),e.createElementBlock("div",tt,[t[5]||(t[5]=e.createTextVNode(" 三级:")),e.createElementVNode("span",{class:e.normalizeClass([o.shareType==="UNIFIED"?m.value.shareType==="FIXED_AMOUNT"?"amount":"percentage":o.shareType==="FIXED_AMOUNT"?"amount":"percentage"])},e.toDisplayString(R(o.shareType,o.three)),3)])):e.createCommentVNode("",!0)]),_:1}),e.createVNode(P,{label:"",width:"200",align:"left"},{header:e.withCtx(()=>t[6]||(t[6]=[e.createElementVNode("label",null,"分销佣金(预计) ",-1)])),default:e.withCtx(o=>{var I,L;return[e.createElementVNode("div",ot,[o.row.salePrices[0]!==o.row.salePrices[o.row.salePrices.length-1]&&o.row.salePrices.length>1?(e.openBlock(),e.createElementBlock("div",nt,[e.createElementVNode("span",null,"￥"+e.toDisplayString(j(e.unref(a)(o.row.salePrices[0]),o.row)),1),t[7]||(t[7]=e.createTextVNode(" ~ ")),e.createElementVNode("span",null,"￥"+e.toDisplayString(j(e.unref(a)(o.row.salePrices[o.row.salePrices.length-1]),o.row)),1)])):(e.openBlock(),e.createElementBlock("div",lt,"￥"+e.toDisplayString(j(e.unref(a)(o.row.salePrices[0]),o.row)),1)),e.createVNode(z,{"raw-content":!0,content:e.unref(Le)(o.row.shareType,o.row.salePrices[0],o.row.salePrices[o.row.salePrices.length-1],o.row.one,(I=o.row)==null?void 0:I.two,(L=o.row)==null?void 0:L.three),placement:"bottom",effect:"light"},{default:e.withCtx(()=>t[8]||(t[8]=[e.createElementVNode("i",{class:"iconfont icon-wenhao",style:{color:"#4d4d4d52","margin-left":"5px"}},null,-1)])),_:2},1032,["content"])])]}),_:1}),e.createVNode(P,{label:"",width:i.distributionStatus!=="CANCEL_DISTRIBUTION"?160:"",align:"left"},{header:e.withCtx(()=>t[9]||(t[9]=[e.createElementVNode("label",null,"加入分销时间 ",-1)])),default:e.withCtx(({row:o})=>[e.createElementVNode("div",at,e.toDisplayString(o.createTime),1)]),_:1},8,["width"]),i.distributionStatus!=="CANCEL_DISTRIBUTION"?(e.openBlock(),e.createBlock(P,{key:1,fixed:"right",label:"操作",width:"110",align:"right"},{default:e.withCtx(({row:o})=>[o.distributionStatus==="IN_DISTRIBUTION"?(e.openBlock(),e.createBlock(u,{key:0,type:"danger",link:"",onClick:I=>$(o)},{default:e.withCtx(()=>t[10]||(t[10]=[e.createTextVNode("取消分销")])),_:2},1032,["onClick"])):e.createCommentVNode("",!0)]),_:1})):e.createCommentVNode("",!0)]),_:1},8,["data"])]),e.createVNode(se,{style:{border:"0"},"page-num":i.current,"page-size":i.size,total:i.total,onHandleCurrentChange:O,onHandleSizeChange:_},null,8,["page-num","page-size","total"])],64)}}}),Ao="",le=(n,s)=>{const m=n.__vccOpts||n;for(const[a,r]of s)m[a]=r;return m},it=Object.freeze(Object.defineProperty({__proto__:null,default:le(rt,[["__scopeId","data-v-2ccd97f4"]])},Symbol.toStringTag,{value:"Module"})),{divTenThousand:oe}=te(),st=()=>{const n=(a,r,i,f)=>f.map(l=>{var O,_,d;return`${l==null?void 0:l.num}* ${oe((O=l==null?void 0:l.bonusShare)==null?void 0:O[r])}${((_=l.bonusShare)==null?void 0:_.shareType)==="RATE"?"%":""}${((d=l.bonusShare)==null?void 0:d.shareType)==="RATE"?"*"+oe(l.dealPrice):""}`}).join(" + ").concat(` = ${i}`);function s(a,r,i){let f=new F(0);return"items"in i&&i.items.length&&i.items.forEach(l=>{(r||l[a].userId)&&(f=f.add(oe(l[a].bonus||0)))}),f}return{useSingleCalculationFormula:n,useTotalPrice:a=>{let r=[],i=[],f=[],l=[];return a.items.forEach(d=>{var $,A,w;let C=[];d.orderStatus==="PAID"?C=f:d.orderStatus==="COMPLETED"?C=r:d.orderStatus==="CLOSED"&&(C=i),d.one.bonus&&C.push(($=d==null?void 0:d.one)!=null&&$.userId?oe(d.one.bonus):new F(0)),d.two.bonus&&C.push((A=d==null?void 0:d.two)!=null&&A.userId?oe(d.two.bonus):new F(0)),d.three.bonus&&C.push((w=d==null?void 0:d.two)!=null&&w.userId?oe(d.three.bonus):new F(0)),d.purchase&&d.one.bonus&&C.push(oe(d.one.bonus))}),[a.items[0]].forEach(d=>{var C,$,A,w,b,S,E;d.one.bonus&&l.push((C=d==null?void 0:d.one)!=null&&C.userId?s("one",($=a.items)==null?void 0:$[0].purchase,a):new F(0)),d.two.bonus&&l.push((A=d==null?void 0:d.two)!=null&&A.userId?s("two",(w=a.items)==null?void 0:w[0].purchase,a):new F(0)),d.three.bonus&&l.push((b=d==null?void 0:d.two)!=null&&b.userId?s("three",(S=a.items)==null?void 0:S[0].purchase,a):new F(0)),d.purchase&&d.one.bonus&&l.push(s("one",(E=a.items)==null?void 0:E[0].purchase,a))}),{completePrice:r.join(" + ")+" = "+r.reduce((d,C)=>d.plus(C),new F(0)),closedPrice:i.join(" + ")+" = "+i.reduce((d,C)=>d.plus(C),new F(0)),toSelledPrice:f.join(" + ")+" = "+f.reduce((d,C)=>d.plus(C),new F(0)),totalPrice:l.join(" + ")+" = "+l.reduce((d,C)=>d.plus(C),new F(0))}}}},dt={style:{"margin-top":"10px",width:"100%"}},ct={class:"head"},mt={class:"buyer-container"},pt={class:"buyer"},ft={style:{color:"#f00"}},ht={key:0,style:{color:"#f54319","margin-left":"5px"}},gt={key:0},bt={key:1},xt={style:{color:"#f54319"}},Nt={class:"ellipsis last"},ut={class:"content"},Vt={class:"goods"},yt={class:"goods__pic"},_t=["src"],Ct={class:"goods__info"},wt={class:"goods__info-flex"},Et={class:"goods__info-flex--name",style:{"line-height":"16px"}},kt={key:0,class:"virtual_product"},Tt={key:1,class:"goods__info-flex--name",style:{"line-height":"16px"}},St={key:0,class:"virtual_product"},Dt={class:"goods__info-flex--num"},It={class:"goods__info-flex"},Bt={class:"goods__info-flex--specs"},$t={key:1,class:"goods__info-flex--specs"},Pt={class:"goods__info-flex--price"},Ot={class:"content__right1"},Ut={class:"content__right1--item"},At={style:{color:"#f54319"},class:"cup"},zt={class:"content__right1--item"},Ft={style:{color:"#f54319"}},Lt={class:"content__right1--item"},Rt={style:{color:"#f54319"}},qt={class:"content__right2"},Mt={class:"content__right3"},jt={key:0,class:"content__right3--item"},Ht={key:1},Wt={key:1,class:"content__right3--item"},Xt={key:1},Yt={key:2,class:"content__right3--item"},Gt={key:1},Jt={class:"content__right3--item"},Kt=e.defineComponent({__name:"DistributionOrderTableP",props:{orderInfo:{type:Object,default(){return{id:null,type:null,name:"",url:"",append:""}}},toolsDisabled:{type:Boolean,default:!1},checked:{type:Boolean,default:!1}},emits:["update:checked","change"],setup(n,{emit:s}){const{useSingleCalculationFormula:m,useTotalPrice:a}=st();we();const{divTenThousand:r}=te(),i=Ee.useRouter(),f=n,l=s,O=w=>{l("update:checked",w),l("change")};function _(w,b){let S=new F(0);return"items"in f.orderInfo&&f.orderInfo.items.length&&f.orderInfo.items.forEach(E=>{(b||E[w].userId)&&(S=S.add(r(E[w].bonus||0)))}),S}function d(w){let b=new F(0);return"items"in f.orderInfo&&f.orderInfo.items.length&&f.orderInfo.items.forEach(S=>{w&&S.orderStatus!==w||(S.one.bonus&&(b=b.add(r(S.one.bonus))),S.two.bonus&&(b=b.add(r(S.two.bonus))),S.three.bonus&&(b=b.add(r(S.three.bonus))),S.purchase&&S.one.userId&&(b=b.add(r(S.one.bonus))))}),b.toNumber()}function C(w){return w==="COMPLETED"?"已赚":w==="CLOSED"?"已失效":"待结算"}const $=w=>{i.push({path:"/order/details",query:{orderNo:w.orderNo,shopId:w.shopId}})},A=w=>{i.push({name:"vipDetailsIndex",query:{userId:w}})};return(w,b)=>{var h,t,c,k,u,P,z,G,y,o,I,L,U,V,v,ee,N,g,B,Z,D,J,ce,me,K,ie,ae,pe,p,ne,ye,_e,Ce;const S=e.resolveComponent("el-checkbox"),E=e.resolveComponent("el-tooltip"),R=e.resolveComponent("el-button"),W=e.resolveComponent("el-table-column"),j=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock("div",dt,[e.createElementVNode("div",ct,[e.createVNode(S,{"model-value":n.checked,style:{"margin-right":"12px"},disabled:n.toolsDisabled,"onUpdate:modelValue":O},null,8,["model-value","disabled"]),e.createElementVNode("div",null,"订单号："+e.toDisplayString(n.orderInfo.orderNo),1),e.createElementVNode("div",null,"下单时间："+e.toDisplayString(n.orderInfo.createTime),1),e.createElementVNode("div",mt,[e.createVNode(E,{disabled:n.toolsDisabled,content:"买家："+n.orderInfo.buyerNickname,"raw-content":!0},{default:e.withCtx(()=>[e.createElementVNode("span",pt,"买家："+e.toDisplayString(n.orderInfo.buyerNickname),1)]),_:1},8,["disabled","content"]),n.orderInfo.items[0].purchase?(e.openBlock(),e.createBlock(E,{key:0,disabled:n.toolsDisabled,"raw-content":!0,content:(h=n.orderInfo.items)!=null&&h[0].purchase?e.unref(m)((t=n.orderInfo.items)==null?void 0:t[0],"one",_("one",(c=n.orderInfo.items)==null?void 0:c[0].purchase),n.orderInfo.items):"该层级无分销员，不计算对应佣金",placement:"bottom",effect:"light"},{default:e.withCtx(()=>{var x,q;return[e.createElementVNode("span",null,[b[4]||(b[4]=e.createElementVNode("span",null,"(",-1)),e.createElementVNode("span",ft,"￥"+e.toDisplayString(n.orderInfo.items[0].one.userId||(x=n.orderInfo.items)!=null&&x[0].purchase?_("one",(q=n.orderInfo.items)==null?void 0:q[0].purchase):0),1),b[5]||(b[5]=e.createElementVNode("span",null,")",-1)),n.orderInfo.items[0].purchase?(e.openBlock(),e.createElementBlock("span",ht,"内购")):e.createCommentVNode("",!0)])]}),_:1},8,["disabled","content"])):e.createCommentVNode("",!0)]),e.createElementVNode("div",null,[n.orderInfo.status==="PAID"||n.orderInfo.status==="COMPLETED"||n.orderInfo.status==="CLOSED"?(e.openBlock(),e.createElementBlock("span",gt,"实付款：")):e.createCommentVNode("",!0),n.orderInfo.status==="UNPAID"?(e.openBlock(),e.createElementBlock("span",bt,"应付款：")):e.createCommentVNode("",!0),e.createElementVNode("span",xt,"￥"+e.toDisplayString(e.unref(r)(n.orderInfo.payAmount).toFixed(2)),1)]),e.createElementVNode("div",Nt,[e.createVNode(E,{disabled:n.toolsDisabled,content:"店铺："+n.orderInfo.shopName,"raw-content":!0},{default:e.withCtx(()=>[e.createTextVNode(" 店铺："+e.toDisplayString(n.orderInfo.shopName),1)]),_:1},8,["disabled","content"])]),e.createVNode(R,{style:{position:"sticky",right:"0","margin-left":"auto"},type:"primary",size:"small",text:"",onClick:b[0]||(b[0]=x=>$(n.orderInfo))},{default:e.withCtx(()=>b[6]||(b[6]=[e.createTextVNode("查看详情")])),_:1})]),e.createElementVNode("div",ut,[e.createVNode(j,{data:n.orderInfo.items,border:"",style:{width:"433px","flex-shrink":"0"},"row-style":{height:"100px"}},{empty:e.withCtx(()=>[e.createVNode(he)]),default:e.withCtx(()=>[e.createVNode(W,{prop:"name"},{default:e.withCtx(({row:x})=>[e.createElementVNode("div",Vt,[e.createElementVNode("div",yt,[e.createElementVNode("img",{src:x.image,style:{width:"68px",height:"68px"}},null,8,_t)]),e.createElementVNode("div",Ct,[e.createElementVNode("div",wt,[x.productName.length>32?(e.openBlock(),e.createBlock(E,{key:0,disabled:n.toolsDisabled,class:"box-item",effect:"dark",content:x.productName,placement:"bottom"},{default:e.withCtx(()=>[e.createElementVNode("div",Et,[x.productType==="VIRTUAL_PRODUCT"?(e.openBlock(),e.createElementBlock("span",kt,"虚拟")):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(x.productName),1)])]),_:2},1032,["disabled","content"])):(e.openBlock(),e.createElementBlock("div",Tt,[x.productType==="VIRTUAL_PRODUCT"?(e.openBlock(),e.createElementBlock("span",St,"虚拟")):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(x.productName),1)])),e.createElementVNode("div",Dt,"￥"+e.toDisplayString(e.unref(r)(x.dealPrice)),1)]),e.createElementVNode("div",It,[x.specs.join("、").length>16?(e.openBlock(),e.createBlock(E,{key:0,disabled:n.toolsDisabled,class:"box-item",effect:"dark",content:x.specs.join("、"),placement:"bottom"},{default:e.withCtx(()=>[e.createElementVNode("div",Bt,e.toDisplayString(x.specs&&x.specs.join("、")),1)]),_:2},1032,["disabled","content"])):(e.openBlock(),e.createElementBlock("div",$t,e.toDisplayString(x.specs&&x.specs.join("、")),1)),e.createElementVNode("div",Pt,"x"+e.toDisplayString(x.num),1)])])])]),_:1})]),_:1},8,["data"]),e.createElementVNode("div",Ot,[e.createElementVNode("div",Ut,[e.createElementVNode("span",{class:"name",onClick:b[1]||(b[1]=x=>A(n.orderInfo.items[0].one.userId))},e.toDisplayString(n.orderInfo.items[0].one.name),1),e.createElementVNode("span",null,e.toDisplayString(n.orderInfo.items[0].one.mobile),1),e.createElementVNode("span",null,[e.createVNode(E,{disabled:n.toolsDisabled,"raw-content":!0,content:n.orderInfo.items[0].one.userId?e.unref(m)((k=n.orderInfo.items)==null?void 0:k[0],"one",_("one",(u=n.orderInfo.items)==null?void 0:u[0].purchase),n.orderInfo.items):"该层级无分销员，不计算对应佣金",placement:"bottom",effect:"light"},{default:e.withCtx(()=>{var x;return[e.createElementVNode("span",null,[b[7]||(b[7]=e.createTextVNode(" 一级佣金：")),e.createElementVNode("span",At,"￥"+e.toDisplayString(n.orderInfo.items[0].one.userId?_("one",(x=n.orderInfo.items)==null?void 0:x[0].purchase):0),1)])]}),_:1},8,["disabled","content"])])]),e.createElementVNode("div",zt,[e.createElementVNode("span",{class:"name",onClick:b[2]||(b[2]=x=>A(n.orderInfo.items[0].two.userId))},e.toDisplayString(n.orderInfo.items[0].two.name),1),e.createElementVNode("span",null,e.toDisplayString(n.orderInfo.items[0].two.mobile),1),e.createElementVNode("span",null,[e.createVNode(E,{disabled:n.toolsDisabled,"raw-content":!0,content:n.orderInfo.items[0].two.userId?e.unref(m)((P=n.orderInfo.items)==null?void 0:P[0],"two",_("two",(z=n.orderInfo.items)==null?void 0:z[0].purchase),n.orderInfo.items):"该层级无分销员，不计算对应佣金",placement:"bottom",effect:"light"},{default:e.withCtx(()=>{var x;return[e.createElementVNode("span",null,[b[8]||(b[8]=e.createTextVNode(" 二级佣金：")),e.createElementVNode("span",Ft,"￥"+e.toDisplayString(_("two",(x=n.orderInfo.items)==null?void 0:x[0].purchase)),1)])]}),_:1},8,["disabled","content"])])]),e.createElementVNode("div",Lt,[e.createElementVNode("span",{class:"name",onClick:b[3]||(b[3]=x=>A(n.orderInfo.items[0].three.userId))},e.toDisplayString(n.orderInfo.items[0].three.name),1),e.createElementVNode("span",null,e.toDisplayString(n.orderInfo.items[0].three.mobile),1),e.createElementVNode("span",null,[e.createVNode(E,{disabled:n.toolsDisabled,"raw-content":!0,content:n.orderInfo.items[0].three.userId?e.unref(m)((G=n.orderInfo.items)==null?void 0:G[0],"three",_("three",(y=n.orderInfo.items)==null?void 0:y[0].purchase),n.orderInfo.items):"该层级无分销员，不计算对应佣金",placement:"bottom",effect:"light"},{default:e.withCtx(()=>{var x;return[e.createElementVNode("span",null,[b[9]||(b[9]=e.createTextVNode(" 三级佣金：")),e.createElementVNode("span",Rt,"￥"+e.toDisplayString(_("three",(x=n.orderInfo.items)==null?void 0:x[0].purchase)),1)])]}),_:1},8,["disabled","content"])])])]),e.createElementVNode("div",qt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.orderInfo.items,x=>(e.openBlock(),e.createElementBlock("div",{key:x,class:"content__right2--item",style:e.normalizeStyle({color:C(x.orderStatus)==="待结算"?"#FD9224":C(x.orderStatus)==="已赚"?"#00BB2C":"#999"})},e.toDisplayString(C(x.orderStatus)),5))),128))]),e.createElementVNode("div",Mt,[d("PAID")?(e.openBlock(),e.createElementBlock("div",jt,[((U=(L=(I=(o=n.orderInfo)==null?void 0:o.items)==null?void 0:I[0])==null?void 0:L.one)!=null&&U.userId?d("PAID"):n.orderInfo.items[0].purchase)?(e.openBlock(),e.createBlock(E,{key:0,disabled:n.toolsDisabled,"raw-content":!0,content:e.unref(a)(n.orderInfo).toSelledPrice.toString(),placement:"bottom",effect:"light"},{default:e.withCtx(()=>{var x,q,X,Y;return[e.createTextVNode("待结算："+e.toDisplayString((Y=(X=(q=(x=n.orderInfo)==null?void 0:x.items)==null?void 0:q[0])==null?void 0:X.one)!=null&&Y.userId||n.orderInfo.items[0].purchase?d("PAID"):0),1)]}),_:1},8,["disabled","content"])):(e.openBlock(),e.createElementBlock("div",Ht,"待结算："+e.toDisplayString((N=(ee=(v=(V=n.orderInfo)==null?void 0:V.items)==null?void 0:v[0])==null?void 0:ee.one)!=null&&N.userId?d("PAID"):0),1))])):e.createCommentVNode("",!0),d("COMPLETED")?(e.openBlock(),e.createElementBlock("div",Wt,[((D=(Z=(B=(g=n.orderInfo)==null?void 0:g.items)==null?void 0:B[0])==null?void 0:Z.one)!=null&&D.userId?d("COMPLETED"):n.orderInfo.items[0].purchase)?(e.openBlock(),e.createBlock(E,{key:0,disabled:n.toolsDisabled,"raw-content":!0,content:e.unref(a)(n.orderInfo).completePrice.toString(),placement:"bottom",effect:"light"},{default:e.withCtx(()=>{var x,q,X,Y;return[e.createTextVNode("已赚："+e.toDisplayString((Y=(X=(q=(x=n.orderInfo)==null?void 0:x.items)==null?void 0:q[0])==null?void 0:X.one)!=null&&Y.userId||n.orderInfo.items[0].purchase?d("COMPLETED"):0),1)]}),_:1},8,["disabled","content"])):(e.openBlock(),e.createElementBlock("div",Xt,"已赚："+e.toDisplayString((K=(me=(ce=(J=n.orderInfo)==null?void 0:J.items)==null?void 0:ce[0])==null?void 0:me.one)!=null&&K.userId?d("COMPLETED"):0),1))])):e.createCommentVNode("",!0),d("CLOSED")?(e.openBlock(),e.createElementBlock("div",Yt,[((p=(pe=(ae=(ie=n.orderInfo)==null?void 0:ie.items)==null?void 0:ae[0])==null?void 0:pe.one)!=null&&p.userId?d("CLOSED"):n.orderInfo.items[0].purchase)?(e.openBlock(),e.createBlock(E,{key:0,disabled:n.toolsDisabled,"raw-content":!0,content:e.unref(a)(n.orderInfo).closedPrice.toString(),placement:"bottom",effect:"light"},{default:e.withCtx(()=>{var x,q,X,Y;return[e.createTextVNode("已失效："+e.toDisplayString((Y=(X=(q=(x=n.orderInfo)==null?void 0:x.items)==null?void 0:q[0])==null?void 0:X.one)!=null&&Y.userId||n.orderInfo.items[0].purchase?d("CLOSED"):0),1)]}),_:1},8,["disabled","content"])):(e.openBlock(),e.createElementBlock("div",Gt,"已失效："+e.toDisplayString((Ce=(_e=(ye=(ne=n.orderInfo)==null?void 0:ne.items)==null?void 0:ye[0])==null?void 0:_e.one)!=null&&Ce.userId?d("CLOSED"):0),1))])):e.createCommentVNode("",!0),e.createElementVNode("div",Jt,[e.createVNode(E,{disabled:n.toolsDisabled,"raw-content":!0,content:e.unref(a)(n.orderInfo).totalPrice.toString(),placement:"bottom",effect:"light"},{default:e.withCtx(()=>{var x,q,X,Y;return[e.createTextVNode("佣金合计："+e.toDisplayString((Y=(X=(q=(x=n.orderInfo)==null?void 0:x.items)==null?void 0:q[0])==null?void 0:X.one)!=null&&Y.bonus?d():0),1)]}),_:1},8,["disabled","content"])])])])])}}}),Lo="",Zt=le(Kt,[["__scopeId","data-v-e2f0bc92"]]),Qt={class:"description"},vt=e.defineComponent({__name:"DistributionDialog",setup(n){const s=[{settlementstatus:"待结算",description:"订单未完结（可能涉及退款退货等），分销佣金暂不计入累计佣金"},{settlementstatus:"已赚",description:"商品没有退款(或退款失败) ，对应佣金统计到【累计佣金】中"},{settlementstatus:"已失效",description:"商品已退款成功，无法获得佣金"}],m=[{commission:"按百分比",description:"一级佣金 = （商品A实付金额 * 一级佣金参数 * 商品数）+（商品B实付金额 * 一级佣金参数 * 商品数）"},{commission:"按固定金额",description:"一级佣金  =  一级佣金 * 商品数"},{commission:"佣金合计",description:"佣金合计  =  一级佣金 + 二级佣金 + 三级佣金 + 内购佣金   "}];return(a,r)=>{const i=e.resolveComponent("ElTableEmpty"),f=e.resolveComponent("el-table-column"),l=e.resolveComponent("el-table");return e.openBlock(),e.createElementBlock("div",Qt,[r[0]||(r[0]=e.createElementVNode("div",{class:"description__content"},[e.createTextVNode("   分销订单数据涵盖平台内所有店铺的分销订单，分销佣金基于剔除营销成本后的实际成交金额计算，分销订单上的价格"),e.createElementVNode("br"),e.createTextVNode(" 即为商品的实际成交价格。内购功能开启后，分销商购买分销商品可获得一级分销佣金。 ")],-1)),e.createVNode(l,{data:s,border:"",style:{width:"600px"},"header-cell-style":{"background-color":"#BEBEBE","font-weight":"normal",color:"#000",fontWeight:"bold"},"cell-style":{color:"#666"}},{empty:e.withCtx(()=>[e.createVNode(i)]),default:e.withCtx(()=>[e.createVNode(f,{prop:"settlementstatus",label:"结算状态",width:"100"}),e.createVNode(f,{prop:"description",label:"说明"})]),_:1}),e.createVNode(l,{data:m,border:"","header-cell-style":{"background-color":"#BEBEBE","font-weight":"normal",color:"#000",fontWeight:"bold"},"cell-style":{color:"#666"},style:{marginTop:"15px"}},{empty:e.withCtx(()=>[e.createVNode(i)]),default:e.withCtx(()=>[e.createVNode(f,{prop:"commission",label:"佣金试算",width:"100"}),e.createVNode(f,{prop:"description",label:"说明"})]),_:1})])}}}),Ro="",eo=le(vt,[["__scopeId","data-v-bfb8f6d3"]]),to={style:{padding:"0 16px"}},oo={class:"count"},no={style:{"font-size":"16px"}},lo={style:{color:"red"}},ao={style:{"font-size":"16px"}},ro={style:{color:"#ccc"}},io={style:{"font-size":"16px"}},so={style:{position:"relative"}},co={class:"tbhead"},mo={key:0,class:""},po=e.defineComponent({__name:"DistributionOrderP",emits:["selection-change"],setup(n,{emit:s}){const m=new ke,{divTenThousand:a}=te(),r=e.reactive({orderNo:"",productName:"",shopName:"",buyerNickname:"",date:"",startTime:"",endTime:"",status:"",purchase:"",distributorPhone:""}),i=e.reactive({current:1,size:10,total:0}),f=e.ref([]),l=e.ref({total:"",unsettled:"",invalid:""}),O=e.ref(!1),_=e.ref(!1),d=e.ref(!1),C=[{label:"订单号",labelWidth:60,prop:"orderNo",valueType:"copy",fieldProps:{placeholder:"请输入订单号",maxlength:20}},{label:"店铺名称",prop:"shopName",valueType:"copy",fieldProps:{placeholder:"请输入店铺名称",maxlength:30}},{label:"手机号",prop:"distributorPhone",valueType:"input",fieldProps:{placeholder:"各级分销商手机号",maxlength:11,type:"text","v-model.number":"",oninput:"value=value.replace(/[^\\d]/g,'')",pattern:"^1[3-9]\\d{9}$"}},{label:"买家昵称",prop:"buyerNickname",valueType:"copy",fieldProps:{placeholder:"请输入买家昵称",maxlength:30}},{label:"商品名称",prop:"productName",valueType:"copy",fieldProps:{placeholder:"请输入商品名称",maxlength:30}},{label:"内购",prop:"purchase",valueType:"select",options:[{label:"全部",value:""},{label:"内购",value:"true"},{label:"非内购",value:"false"}],fieldProps:{placeholder:"请选择"}},{label:"下单时间",prop:"date",valueType:"date-picker",fieldProps:{type:"datetimerange",startPlaceholder:"开始时间",endPlaceholder:"结束时间",valueFormat:"YYYY-MM-DD HH:mm:ss"}}];$();async function $(){const{code:y,data:o,msg:I}=await Pe({current:i.current,size:i.size,...r});y===200&&o?(f.value=o.page.records,l.value=o.statistic,i.total=o.page.total):T.ElMessage.error(I||"获取分销订单失败")}const A=()=>{i.current=1,(r==null?void 0:r.date.length)>0&&(r.startTime=r.date[0],r.endTime=r.date[1]),$()},w=()=>{r.orderNo="",r.productName="",r.shopName="",r.buyerNickname="",r.date="",r.startTime="",r.endTime="",i.current=1,$()},b=async()=>{let y={};if(R().length)y.orderNos=R().map(L=>L.orderNo)||[];else{const{orderNo:L,productName:U,shopName:V,buyerNickname:v,startTime:ee,endTime:N,status:g}=r;y={orderNo:L,productName:U,shopName:V,buyerNickname:v,startTime:ee,endTime:N,status:g}}const{code:o,msg:I}=await Fe(y);o===200?T.ElMessage.success({message:I||"导出成功"}):T.ElMessage.error({message:I||"导出失败"})},S=y=>{f.value.forEach(o=>{o.checked=y}),d.value=!1},E=()=>{const y=f.value.filter(o=>o.checked).length;_.value=y===f.value.length,d.value=y>0&&y<f.value.length},R=()=>f.value.filter(y=>y.checked),W=s;e.watch(()=>f.value.map(y=>y.checked),()=>{W("selection-change",R())},{deep:!0});const j=y=>{i.current=y,$()},h=y=>{i.current=1,i.size=y,$()},t=e.ref(" "),c=e.ref("全部订单"),k=y=>{r.status=y,$()},u=y=>{if(t.value=" ",c.value=y,c.value==="近一个月订单"){const o=m.getLastMonth(new Date);P(o)}else if(c.value==="近三个月订单"){const o=m.getLastThreeMonth(new Date);P(o)}else r.startTime="",r.endTime="",$()},P=async y=>{const o=m.getYMDs(new Date);r.startTime=y,r.endTime=o,$()},z=e.ref(!1),G=async()=>{z.value=!0,await e.nextTick(),z.value=!1};return(y,o)=>{const I=e.resolveComponent("el-button"),L=e.resolveComponent("el-config-provider"),U=e.resolveComponent("el-icon"),V=e.resolveComponent("el-dropdown-item"),v=e.resolveComponent("el-dropdown-menu"),ee=e.resolveComponent("el-dropdown"),N=e.resolveComponent("el-tab-pane"),g=e.resolveComponent("el-tabs"),B=e.resolveComponent("el-checkbox"),Z=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(L,{"empty-values":[void 0,null]},{default:e.withCtx(()=>[e.createVNode(fe,{modelValue:r,"onUpdate:modelValue":o[0]||(o[0]=D=>r=D),columns:C,onSearchHandle:A,onHandleReset:w},{otherOperations:e.withCtx(()=>[e.createVNode(I,{type:"primary",onClick:b},{default:e.withCtx(()=>o[5]||(o[5]=[e.createTextVNode("导出")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createElementVNode("div",to,[e.createElementVNode("div",oo,[e.createElementVNode("span",null,[o[7]||(o[7]=e.createTextVNode("累计总佣金： ")),e.createElementVNode("text",null,[o[6]||(o[6]=e.createTextVNode("￥ ")),e.createElementVNode("text",no,e.toDisplayString(e.unref(a)(l.value.total).toFixed(2)),1)])]),e.createElementVNode("span",null,[o[9]||(o[9]=e.createTextVNode("待结算总佣金： ")),e.createElementVNode("text",lo,[o[8]||(o[8]=e.createTextVNode("￥ ")),e.createElementVNode("text",ao,e.toDisplayString(e.unref(a)(l.value.unsettled).toFixed(2)),1)])]),e.createElementVNode("span",null,[o[11]||(o[11]=e.createTextVNode("已失效总佣金：")),e.createElementVNode("text",ro,[o[10]||(o[10]=e.createTextVNode("￥ ")),e.createElementVNode("text",io,e.toDisplayString(e.unref(a)(l.value.invalid).toFixed(2)),1)])])])]),e.createElementVNode("div",so,[e.createVNode(g,{modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=D=>t.value=D),style:{padding:"0 16px"},onTabChange:k},{default:e.withCtx(()=>[e.createVNode(N,{name:" "},{label:e.withCtx(()=>[e.createElementVNode("span",null,e.toDisplayString(c.value),1),e.createVNode(ee,{placement:"bottom-end",trigger:"click",onCommand:u},{dropdown:e.withCtx(()=>[e.createVNode(v,null,{default:e.withCtx(()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["近一个月订单","近三个月订单","全部订单"],D=>e.createVNode(V,{key:D,command:D},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(D),1)]),_:2},1032,["command"])),64))]),_:1})]),default:e.withCtx(()=>[e.createElementVNode("span",{class:"el-dropdown-link",style:{height:"40px"},onClick:e.withModifiers(()=>{},["stop"])},[e.createVNode(U,{class:"el-icon--right",style:{position:"relative",top:"12px"}},{default:e.withCtx(()=>[e.createVNode(U,null,{default:e.withCtx(()=>[e.createVNode(e.unref(Te.ArrowDownBold))]),_:1})]),_:1})])]),_:1})]),_:1}),e.createVNode(N,{label:"已付款",name:"PAID"}),e.createVNode(N,{label:"已完成",name:"COMPLETED"}),e.createVNode(N,{label:"已关闭",name:"CLOSED"})]),_:1},8,["modelValue"]),e.createVNode(de,{name:"icon-wenhao",size:"18px",color:"#666",style:{position:"absolute",right:"16px",top:"12px",cursor:"pointer"},onClick:o[2]||(o[2]=D=>O.value=!0)})]),e.createElementVNode("div",{class:"distribution_order_table_container f1",onScroll:G},[e.createElementVNode("div",co,[e.createVNode(B,{modelValue:_.value,"onUpdate:modelValue":o[3]||(o[3]=D=>_.value=D),style:{"margin-left":"16px"},indeterminate:d.value,onChange:S},null,8,["modelValue","indeterminate"]),o[12]||(o[12]=e.createElementVNode("div",{class:"tbhead__goods"},"商品信息",-1)),o[13]||(o[13]=e.createElementVNode("div",{class:"tbhead__detail"},"分佣详情",-1)),o[14]||(o[14]=e.createElementVNode("div",{class:"tbhead__state"},"结算状态",-1)),o[15]||(o[15]=e.createElementVNode("div",{class:"tbhead__total"},"佣金结算",-1))]),f.value.length===0?(e.openBlock(),e.createElementBlock("div",mo,[e.createVNode(he)])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.value,D=>(e.openBlock(),e.createBlock(Zt,{key:D.orderNo,checked:D.checked,"onUpdate:checked":J=>D.checked=J,"tools-disabled":z.value,"order-info":D,onChange:E},null,8,["checked","onUpdate:checked","tools-disabled","order-info"]))),128))],32),e.createVNode(se,{"page-num":i.current,"page-size":i.size,total:i.total,onHandleCurrentChange:j,onHandleSizeChange:h},null,8,["page-num","page-size","total"]),e.createVNode(Z,{modelValue:O.value,"onUpdate:modelValue":o[4]||(o[4]=D=>O.value=D),title:"分销订单说明",width:"790px",center:""},{default:e.withCtx(()=>[e.createVNode(eo)]),_:1},8,["modelValue"])],64)}}}),qo="",fo=Object.freeze(Object.defineProperty({__proto__:null,default:le(po,[["__scopeId","data-v-fc671b1b"]])},Symbol.toStringTag,{value:"Module"})),ho={class:"tab_container",style:{position:"relative"}},go={key:0,class:"handle_container"},bo={style:{display:"flex",height:"83px","align-items":"center"}},xo={class:"f12 color51",style:{"margin-left":"6px"}},No={class:"ellipsis"},uo=["onClick"],Vo=["onClick"],yo=["onClick"],_o={key:3},Co={style:{display:"flex","align-items":"center"}},wo=["src"],Eo={style:{display:"flex","align-items":"center",padding:"10px 0"}},ko={class:"dialog-footer"},To=e.defineComponent({__name:"WholeSalerP",setup(n){const s=e.reactive({name:"",mobile:"",date:"",startTime:"",endTime:"",status:"SUCCESS"}),{divTenThousand:m}=te(),a=e.reactive({current:1,size:10,total:0}),r=e.ref([]),i=e.ref([]),f=e.ref(!1),l=e.reactive({current:1,total:0,size:10,list:[],userId:""}),O=e.ref(!1),_=e.reactive({current:1,total:0,size:10,list:[],userId:"",rank:""}),d=[{label:"姓名",labelWidth:45,prop:"name",valueType:"copy",fieldProps:{placeholder:"请输入姓名",maxlength:20}},{label:"手机号",prop:"mobile",labelWidth:60,valueType:"copy",fieldProps:{placeholder:"请输入手机号",maxlength:30}},{label:"申请时间",prop:"date",valueType:"date-picker",fieldProps:{type:"datetimerange",startPlaceholder:"开始时间",endPlaceholder:"结束时间",valueFormat:"YYYY-MM-DD HH:mm:ss"}}];U();const C=()=>{U()},$=N=>{a.current=N,U()},A=N=>{a.current=1,a.size=N,U()},w=()=>{a.current=1,s.date.length>0&&(console.log("searchConfig.date",s.date),s.startTime=s.date[0],s.endTime=s.date[1]),U()},b=N=>{P(!0,[N])},S=()=>{i.value.length?P(!0,i.value.map(N=>N.id)):T.ElMessage.warning("请勾选分销商")},E=e.ref(!1),R=e.ref(),W=e.ref(""),j=N=>{E.value=!0,R.value=N},h=e.ref(""),t=async N=>{if(!N.rejectReason){const{code:g,data:B,msg:Z}=await ze(N.id);g===200&&B?(h.value=B,N.rejectReason=!0):(Z&&T.ElMessage.warning(Z),h.value="",N.rejectReason=!0)}},c=N=>{N.rejectReason=!1},k=()=>{const N=W.value;if(N===""){T.ElMessage.warning("请填写拒绝原因");return}Ve(!1,R.value,N).then(g=>{g.code&&g.code===200?(T.ElMessage.success("操作成功"),E.value=!1,U()):T.ElMessage.error("操作失败")})},u=()=>{i.value.length?j(i.value.map(N=>N.id)):T.ElMessage.warning("请勾选分销商")};async function P(N,g){T.ElMessageBox.confirm("确定需要继续操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{code:B}=await Ve(N,g);B&&B===200?(T.ElMessage.success("操作成功"),U()):T.ElMessage.error("操作失败")})}const z=N=>{s.status==="SUCCESS"&&(f.value=!0,l.userId=N,V(N))},G=()=>{O.value=!0,v()},y=()=>{l.current=1,l.size=10,l.list=[],l.userId=""},o=()=>{_.current=1,_.size=10,_.list=[],_.userId="",_.rank=""},I=N=>{l.current=N,V()},L=N=>{l.current=1,l.size=N,V()};async function U(){const{code:N,data:g}=await Oe({...s,...a});N===200?(r.value=g.records.map(B=>({...B,rejectReason:!1,flag:!1})),a.total=g.total):T.ElMessage.error("获取分销商失败")}async function V(N){const{code:g,data:B}=await Ue({userId:N||l.userId,current:l.current,size:l.size});g&&g===200?(l.list=B.records,l.total=B.total,f.value=!0):(T.ElMessage.error("获取下线失败"),f.value=!1)}async function v(N){const{code:g,data:B}=await Ae({userId:N||_.userId,current:_.current,size:_.size});g&&g===200?(_.list=B.records,_.total=B.total,_.rank=B.rank,O.value=!0):(T.ElMessage.error("获取排行失败"),O.value=!1)}const ee=()=>{a.current=1,s.date="",s.endTime="",s.startTime="",s.mobile="",s.name="",U()};return(N,g)=>{const B=e.resolveComponent("el-tab-pane"),Z=e.resolveComponent("el-tabs"),D=e.resolveComponent("el-link"),J=e.resolveComponent("el-button"),ce=e.resolveComponent("el-image"),me=e.resolveComponent("el-tooltip"),K=e.resolveComponent("el-table-column"),ie=e.resolveComponent("el-table"),ae=e.resolveComponent("el-dialog"),pe=e.resolveComponent("el-input");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(fe,{modelValue:s,"onUpdate:modelValue":g[0]||(g[0]=p=>s=p),columns:d,onSearchHandle:w,onHandleReset:ee},null,8,["modelValue"]),e.createElementVNode("div",ho,[e.createVNode(Z,{modelValue:s.status,"onUpdate:modelValue":g[1]||(g[1]=p=>s.status=p),class:"demo-tabs",onTabChange:C},{default:e.withCtx(()=>[e.createVNode(B,{label:"分销列表",name:"SUCCESS"}),e.createVNode(B,{label:"待审核",name:"APPLYING"}),e.createVNode(B,{label:"已拒绝",name:"CLOSED"})]),_:1},8,["modelValue"]),e.createVNode(D,{style:{position:"absolute",top:"11px",right:"20px",color:"#555cfd"},onClick:G},{default:e.withCtx(()=>g[8]||(g[8]=[e.createTextVNode("佣金排行榜")])),_:1})]),s.status==="APPLYING"?(e.openBlock(),e.createElementBlock("div",go,[e.createVNode(J,{plain:"",round:"",onClick:S},{default:e.withCtx(()=>g[9]||(g[9]=[e.createTextVNode("批量同意")])),_:1}),e.createVNode(J,{plain:"",round:"",onClick:u},{default:e.withCtx(()=>g[10]||(g[10]=[e.createTextVNode("批量拒绝")])),_:1})])):e.createCommentVNode("",!0),e.createVNode(e.unref(Se),{"checked-item":i.value,"onUpdate:checkedItem":g[2]||(g[2]=p=>i.value=p),selection:s.status==="APPLYING",data:r.value,"no-border":"",class:"q-table"},{default:e.withCtx(()=>[e.createVNode(M,{label:"分销商信息",width:"300",align:"left"},{default:e.withCtx(({row:p})=>[e.createElementVNode("div",bo,[e.createVNode(ce,{src:p.avatar,style:{width:"52px",height:"52px"}},null,8,["src"]),e.createElementVNode("div",xo,[e.createElementVNode("div",No,e.toDisplayString(p.name),1),e.createElementVNode("div",null,e.toDisplayString(p.mobile),1)])])]),_:1}),s.status==="SUCCESS"?(e.openBlock(),e.createBlock(M,{key:0,label:"团队成员",width:"100",align:"left"},{default:e.withCtx(({row:p})=>[e.createElementVNode("div",{class:"column",onClick:ne=>z(p.userId)},[e.createVNode(D,{type:"primary",link:""},{default:e.withCtx(()=>[e.createTextVNode("一级："+e.toDisplayString(p.one),1)]),_:2},1024),e.createVNode(D,{type:"primary",link:""},{default:e.withCtx(()=>[e.createTextVNode("二级："+e.toDisplayString(p.two),1)]),_:2},1024),e.createVNode(D,{type:"primary",link:""},{default:e.withCtx(()=>[e.createTextVNode("三级："+e.toDisplayString(p.three),1)]),_:2},1024)],8,uo)]),_:1})):e.createCommentVNode("",!0),s.status==="SUCCESS"?(e.openBlock(),e.createBlock(M,{key:1,label:"累计佣金(元)",width:"150",align:"left"},{default:e.withCtx(({row:p})=>[e.createElementVNode("span",null,e.toDisplayString(e.unref(m)(p.total)),1)]),_:1})):e.createCommentVNode("",!0),s.status==="SUCCESS"?(e.openBlock(),e.createBlock(M,{key:2,label:"待提现佣金(元)",width:"150",align:"left"},{default:e.withCtx(({row:p})=>[e.createElementVNode("span",null,e.toDisplayString(e.unref(m)(p.undrawn)),1)]),_:1})):e.createCommentVNode("",!0),s.status==="SUCCESS"?(e.openBlock(),e.createBlock(M,{key:3,label:"待结算佣金(元)",width:"150",align:"left"},{default:e.withCtx(({row:p})=>[e.createElementVNode("span",null,e.toDisplayString(e.unref(m)(p.unsettled)),1)]),_:1})):e.createCommentVNode("",!0),e.createVNode(M,{label:"累积消费金额(元)",width:"150",align:"left"},{default:e.withCtx(({row:p})=>[e.createElementVNode("span",null,e.toDisplayString(e.unref(m)(p.consumption)),1)]),_:1}),e.createVNode(M,{label:"邀请人",width:"150",align:"left"},{default:e.withCtx(({row:p})=>[e.createElementVNode("span",null,e.toDisplayString(p.referrer||"平台"),1)]),_:1}),e.createVNode(M,{label:"申请时间",width:"200",align:"left"},{default:e.withCtx(({row:p})=>[e.createElementVNode("span",null,e.toDisplayString(p.createTime),1)]),_:1}),s.status!=="APPLYING"?(e.openBlock(),e.createBlock(M,{key:4,label:"审批时间",width:"200",align:"left"},{default:e.withCtx(({row:p})=>[e.createElementVNode("span",null,e.toDisplayString(p.passTime),1)]),_:1})):e.createCommentVNode("",!0),e.createVNode(M,{label:"",width:"1"}),s.status==="APPLYING"?(e.openBlock(),e.createBlock(M,{key:5,label:"操作",width:"150",align:"right"},{default:e.withCtx(({row:p})=>[e.createElementVNode("span",{style:{cursor:"pointer",color:"#555cfd","margin-left":"10px"},onClick:ne=>b(p.id)},"通过",8,Vo),e.createElementVNode("span",{style:{cursor:"pointer",color:"#f54319","margin-left":"10px"},onClick:ne=>j([p.id])},"拒绝",8,yo)]),_:1})):e.createCommentVNode("",!0),s.status==="CLOSED"?(e.openBlock(),e.createBlock(M,{key:6,label:"操作",width:"150",align:"right"},{default:e.withCtx(({row:p})=>[e.createVNode(me,{visible:h.value!==""&&p.rejectReason},{content:e.withCtx(()=>[e.createElementVNode("span",null,e.toDisplayString(h.value),1)]),default:e.withCtx(()=>[e.createVNode(J,{type:"primary",link:"",underline:!1,onMouseover:ne=>t(p),onMouseleave:ne=>c(p)},{default:e.withCtx(()=>g[11]||(g[11]=[e.createTextVNode(" 拒绝原因 ")])),_:2},1032,["onMouseover","onMouseleave"])]),_:2},1032,["visible"])]),_:1})):e.createCommentVNode("",!0)]),_:1},8,["checked-item","selection","data"]),e.createVNode(se,{"page-num":a.current,"page-size":a.size,total:a.total,onHandleCurrentChange:$,onHandleSizeChange:A},null,8,["page-num","page-size","total"]),e.createVNode(ae,{modelValue:f.value,"onUpdate:modelValue":g[3]||(g[3]=p=>f.value=p),width:"554px",title:"团队成员",onClose:y},{default:e.withCtx(()=>[e.createVNode(ie,{data:l.list,"header-cell-style":{background:"#f6f8fa",fontSize:"12px",color:"#909399","font-weight":"bold"},"cell-style":{fontSize:"12px",color:"#333333"},height:"400"},{default:e.withCtx(()=>[e.createVNode(K,{label:"姓名",align:"center"},{default:e.withCtx(({row:p})=>[e.createTextVNode(e.toDisplayString(p.name?p.name:p.nickname),1)]),_:1}),e.createVNode(K,{label:"层级",align:"center"},{default:e.withCtx(({row:p})=>[e.createTextVNode(e.toDisplayString(p.level==="ONE"?"一级":p.level==="TWO"?"二级":"三级"),1)]),_:1}),e.createVNode(K,{label:"累计消费",align:"center",prop:"consumption"},{default:e.withCtx(({row:p})=>[e.createTextVNode(e.toDisplayString(e.unref(m)(p.consumption)),1)]),_:1}),e.createVNode(K,{label:"订单数",align:"center",prop:"orderCount"})]),_:1},8,["data"]),e.createVNode(se,{"page-num":l.current,"page-size":l.size,total:l.total,onHandleCurrentChange:I,onHandleSizeChange:L},null,8,["page-num","page-size","total"])]),_:1},8,["modelValue"]),e.createVNode(ae,{modelValue:O.value,"onUpdate:modelValue":g[4]||(g[4]=p=>O.value=p),width:"717px",class:"ranking",style:{"margin-top":"70px"},title:"佣金排行榜",onClose:o},{default:e.withCtx(()=>[e.createVNode(ie,{data:_.list,"header-cell-style":{background:"#f6f8fa",fontSize:"14px",color:"#333","font-weight":"bold"},"cell-style":{fontSize:"12px",color:"#333333"}},{default:e.withCtx(()=>[e.createVNode(K,{label:"排名",align:"center",type:"index",width:"140"},{default:e.withCtx(({$index:p})=>[p===0?(e.openBlock(),e.createBlock(de,{key:0,name:"icon-svg2",svg:"",style:{width:"24px",height:"26px"}})):p===1?(e.openBlock(),e.createBlock(de,{key:1,name:"icon-a-svg1",svg:"",style:{width:"24px",height:"26px"}})):p===2?(e.openBlock(),e.createBlock(de,{key:2,name:"icon-a-svg2",svg:"",style:{width:"24px",height:"26px"}})):(e.openBlock(),e.createElementBlock("span",_o,e.toDisplayString(p+1),1))]),_:1}),e.createVNode(K,{label:"用户昵称",prop:"name"},{default:e.withCtx(({row:p})=>[e.createElementVNode("div",Co,[e.createElementVNode("img",{src:p.avatar,alt:"",style:{width:"50px",height:"50px","margin-right":"5px"}},null,8,wo),e.createElementVNode("span",null,e.toDisplayString(p.name),1)])]),_:1}),e.createVNode(K,{label:"累计佣金(元)",align:"center",prop:"total"},{default:e.withCtx(({row:p})=>[e.createTextVNode(e.toDisplayString(e.unref(m)(p.total).toFixed(2)),1)]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"]),e.createVNode(ae,{modelValue:E.value,"onUpdate:modelValue":g[7]||(g[7]=p=>E.value=p),title:"分销商审核",width:"690"},{footer:e.withCtx(()=>[e.createElementVNode("div",ko,[e.createVNode(J,{onClick:g[6]||(g[6]=p=>E.value=!1)},{default:e.withCtx(()=>g[13]||(g[13]=[e.createTextVNode("取消")])),_:1}),e.createVNode(J,{type:"primary",onClick:k},{default:e.withCtx(()=>g[14]||(g[14]=[e.createTextVNode("确认")])),_:1})])]),default:e.withCtx(()=>[e.createElementVNode("div",Eo,[g[12]||(g[12]=e.createElementVNode("div",{style:{color:"#666666",width:"85px"}},"拒绝原因",-1)),e.createVNode(pe,{modelValue:W.value,"onUpdate:modelValue":g[5]||(g[5]=p=>W.value=p),"show-word-limit":"",type:"text",maxlength:"20",placeholder:"请输入拒绝原因"},null,8,["modelValue"])])]),_:1},8,["modelValue"])],64)}}}),jo="",So=Object.freeze(Object.defineProperty({__proto__:null,default:le(To,[["__scopeId","data-v-19950ab8"]])},Symbol.toStringTag,{value:"Module"})),Do={style:{"background-color":"#fff","overflow-y":"auto"}},Io={class:"col mb26",style:{display:"flex","justify-content":"space-between",width:"100%"}},Bo={class:"save"},$o={class:"dialog-footer"},Po={class:"dialog-footer"},Oo=e.defineComponent({__name:"DistributionSetP",setup(n){const{divHundred:s,mulHundred:m,mulTenThousand:a,divTenThousand:r}=te(),i=e.ref(!1),f=e.ref(!1),l=e.reactive({config:{level:"ONE",condition:{types:["APPLY","CONSUMPTION"],requiredAmount:0},precompute:"DISTRIBUTOR",protocol:"111",playMethods:"333",purchase:!1,shareType:"FIXED_AMOUNT",one:0,two:0,three:0}}),O=e.computed(()=>l.config.level==="ONE"?1:l.config.level==="TWO"?2:3),_=e.reactive({level:[{required:!0,message:"",trigger:"blur"}],poster:[{required:!0,message:"请设置推广海报",trigger:"blur"}],purchase:[{required:!0,message:"",trigger:"blur"}],precompute:[{required:!0,message:"",trigger:"blur"}],condition:[{required:!0,validator:b,trigger:"blur"}],protocol:[{required:!0,message:"请设置协议",trigger:"blur"}],playMethods:[{required:!0,message:"请设置攻略玩法",trigger:"blur"}],shareType:[{required:!0,message:"",trigger:"blur"}],one:[{required:!0,validator:S,trigger:"change"}],two:[{required:!0,validator:E,trigger:"change"}],three:[{required:!0,validator:R,trigger:"change"}]}),d=e.ref();j();const C=()=>{i.value=!0},$=()=>{f.value=!0},A=async()=>{d.value&&d.value.validate(async(h,t)=>{if(h){const c=JSON.parse(JSON.stringify(l.config));c.condition.requiredAmount=a(c.condition.requiredAmount),l.config.shareType==="RATE"?(c.one=m(c.one),c.two=m(c.two),c.three=m(c.three)):(c.one=a(c.one),c.two=a(c.two),c.three=a(c.three));const{code:k,msg:u}=await Be(W(c));k===200?T.ElMessage.success("保存成功"):T.ElMessage.error(u||"保存失败")}})},w=()=>{l.config.one=0,l.config.two=0,l.config.three=0};function b(h,t,c){if(t.types.length){if(t.types.includes("CONSUMPTION")&&Number(t.requiredAmount)<=0)return c(new Error("设置金额应大于零"))}else return c(new Error("请选择分销商条件"));c()}function S(h,t,c){const k=l.config.shareType;if(k==="UNIFIED")return c();const u=Number(t);if(u<=0)return c(new Error("一级佣金应大于等于零"));if(l.config.level!=="ONE"&&l.config.two&&u<=Number(l.config.two))return c(new Error("一级佣金值应大于二级佣金"));if(k==="RATE"&&(u>100||u<0))return c(new Error("一级佣金比例应设置在0-100之间"));if(k==="FIXED_AMOUNT"&&(u>9e3||u<0))return c(new Error("一级佣金应设置在0-9000之间"));c()}function E(h,t,c){const k=l.config.shareType;if(k==="UNIFIED"||l.config.level==="ONE")return c();const u=Number(t);if(k==="RATE"&&(u>100||u<0))return c(new Error("一级佣金比例应设置在0-100之间"));if(k==="FIXED_AMOUNT"&&(u>9e3||u<0))return c(new Error("一级佣金应设置在0-9000之间"));if(l.config.one&&u>=Number(l.config.one))return c(new Error("二级佣金应小于一级佣金"));if(l.config.level==="THREE"&&l.config.three&&u<=Number(l.config.three))return c(new Error("二级佣金应大于三级佣金"));c()}function R(h,t,c){const k=l.config.shareType;if(k==="UNIFIED"||l.config.level!=="THREE")return c();const u=Number(t);if(k==="RATE"&&(u>100||u<0))return c(new Error("一级佣金比例应设置在1-100之间"));if(k==="FIXED_AMOUNT"&&(u>9e3||u<0))return c(new Error("一级佣金应设置在0-9000之间"));if(l.config.two&&u>=Number(l.config.two))return c(new Error("三级佣金应小于二级佣金"));c()}function W(h){return h.level==="ONE"?(delete h.two,delete h.three):h.level==="TWO"&&delete h.three,h}async function j(){const{code:h,data:t}=await Ne();h===200?(t.shareType==="RATE"?(t.one=s(t.one),t.two=s(t.two),t.three=s(t.three)):(t.one=r(t.one),t.two=r(t.two),t.three=r(t.three)),t.condition.requiredAmount=r(t.condition.requiredAmount),l.config=t):T.ElMessage.error("获取分销配置失败")}return(h,t)=>{const c=e.resolveComponent("el-radio"),k=e.resolveComponent("el-radio-group"),u=e.resolveComponent("el-form-item"),P=e.resolveComponent("el-checkbox"),z=e.resolveComponent("el-input"),G=e.resolveComponent("el-row"),y=e.resolveComponent("el-checkbox-group"),o=e.resolveComponent("el-tooltip"),I=e.resolveComponent("el-button"),L=e.resolveComponent("el-form"),U=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock("div",Do,[e.createVNode(L,{ref_key:"formRef",ref:d,model:l.config,"label-width":"120",rules:_,style:{"margin-left":"16px"}},{default:e.withCtx(()=>[t[38]||(t[38]=e.createElementVNode("div",{class:"col mb26"},[e.createElementVNode("div",{class:"col__icon",style:{background:"#555CFD"}}),e.createElementVNode("div",null,"基础设置")],-1)),e.createVNode(u,{label:"分销层级",class:"mb33",prop:"level"},{default:e.withCtx(()=>[e.createVNode(k,{modelValue:l.config.level,"onUpdate:modelValue":t[0]||(t[0]=V=>l.config.level=V)},{default:e.withCtx(()=>[e.createVNode(c,{value:"ONE"},{default:e.withCtx(()=>t[17]||(t[17]=[e.createTextVNode("一级分销")])),_:1}),e.createVNode(c,{value:"TWO"},{default:e.withCtx(()=>t[18]||(t[18]=[e.createTextVNode("二级分销")])),_:1}),e.createVNode(c,{value:"THREE"},{default:e.withCtx(()=>t[19]||(t[19]=[e.createTextVNode("三级分销")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createVNode(u,{label:"成为分销商条件",class:"mb33",prop:"condition"},{default:e.withCtx(()=>[e.createVNode(y,{modelValue:l.config.condition.types,"onUpdate:modelValue":t[2]||(t[2]=V=>l.config.condition.types=V)},{default:e.withCtx(()=>[e.createVNode(P,{value:"APPLY"},{default:e.withCtx(()=>t[20]||(t[20]=[e.createTextVNode("申请")])),_:1}),t[23]||(t[23]=e.createElementVNode("br",null,null,-1)),e.createVNode(P,{value:"CONSUMPTION"},{default:e.withCtx(()=>[e.createVNode(G,{justify:"start",align:"middle",style:{width:"300px"}},{default:e.withCtx(()=>[t[22]||(t[22]=e.createElementVNode("span",null,"累计消费金额大于等于",-1)),e.createVNode(z,{modelValue:l.config.condition.requiredAmount,"onUpdate:modelValue":t[1]||(t[1]=V=>l.config.condition.requiredAmount=V),type:"number",controls:!1,style:{width:"142px","margin-left":"5px"}},{append:e.withCtx(()=>t[21]||(t[21]=[e.createTextVNode("元")])),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createVNode(u,{label:"分销内购",class:"mb33",prop:"purchase"},{default:e.withCtx(()=>[e.createVNode(k,{modelValue:l.config.purchase,"onUpdate:modelValue":t[3]||(t[3]=V=>l.config.purchase=V)},{default:e.withCtx(()=>[e.createVNode(c,{value:!1},{default:e.withCtx(()=>t[24]||(t[24]=[e.createTextVNode("关闭")])),_:1}),e.createVNode(c,{value:!0},{default:e.withCtx(()=>t[25]||(t[25]=[e.createTextVNode("开启")])),_:1})]),_:1},8,["modelValue"]),t[26]||(t[26]=e.createElementVNode("span",{style:{"margin-left":"30px",color:"#9a9a9a"}},"开启后分销员自己购买分销商品可获得一级佣金",-1))]),_:1}),e.createVNode(u,{label:"预计赚",class:"mb33",prop:"precompute"},{default:e.withCtx(()=>[e.createVNode(k,{modelValue:l.config.precompute,"onUpdate:modelValue":t[4]||(t[4]=V=>l.config.precompute=V)},{default:e.withCtx(()=>[e.createVNode(c,{value:"DISTRIBUTOR"},{default:e.withCtx(()=>t[27]||(t[27]=[e.createTextVNode("只对分销商(员)展示【预计赚】 ")])),_:1}),e.createVNode(o,{class:"box-item",effect:"dark",content:"控制是否在商品详情页内展示【预计赚】",placement:"top"},{default:e.withCtx(()=>t[28]||(t[28]=[e.createElementVNode("i",{class:"iconfont icon-wenhao",style:{position:"relative",left:"-30px",color:"#999"}},null,-1)])),_:1}),e.createVNode(c,{value:"NEVER"},{default:e.withCtx(()=>t[29]||(t[29]=[e.createTextVNode("对所有人都不展示")])),_:1}),e.createVNode(c,{value:"ALL"},{default:e.withCtx(()=>t[30]||(t[30]=[e.createTextVNode("对所有人展示【预计赚】")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.createVNode(u,{label:"协议内容",prop:"protocol"},{default:e.withCtx(()=>[e.createVNode(I,{link:"",type:"primary",onClick:C},{default:e.withCtx(()=>t[31]||(t[31]=[e.createTextVNode("编辑")])),_:1})]),_:1}),e.createVNode(u,{label:"赚钱攻略"},{default:e.withCtx(()=>[e.createVNode(I,{link:"",type:"primary",onClick:$},{default:e.withCtx(()=>t[32]||(t[32]=[e.createTextVNode("编辑")])),_:1})]),_:1}),e.createElementVNode("div",Io,[t[35]||(t[35]=e.createElementVNode("div",{style:{display:"flex"}},[e.createElementVNode("div",{class:"col__icon",style:{background:"#555CFD"}}),e.createElementVNode("div",null,"佣金设置")],-1)),e.createVNode(o,{class:"box-item",effect:"dark",placement:"top"},{content:e.withCtx(()=>t[33]||(t[33]=[e.createElementVNode("div",null,[e.createTextVNode(" 1、按百分比：佣金 = 商品实付金额 * 购买商品数 * 百分比"),e.createElementVNode("br"),e.createTextVNode(" 2、按固定金额：佣金 = 固定金额 * 购买商品数 "),e.createElementVNode("br"),e.createTextVNode(" 3、风险提示：请谨慎使用固定金额分佣，可能存在资金损失风险 ")],-1)])),default:e.withCtx(()=>[t[34]||(t[34]=e.createElementVNode("i",{class:"iconfont icon-wenhao",style:{color:"#999","margin-right":"12px"}},null,-1))]),_:1})]),e.createVNode(u,{label:"佣金设置",prop:"shareType"},{default:e.withCtx(()=>[e.createVNode(k,{modelValue:l.config.shareType,"onUpdate:modelValue":t[5]||(t[5]=V=>l.config.shareType=V),onChange:w},{default:e.withCtx(()=>[e.createVNode(c,{value:"FIXED_AMOUNT"},{default:e.withCtx(()=>t[36]||(t[36]=[e.createTextVNode("固定金额")])),_:1}),e.createVNode(c,{value:"RATE"},{default:e.withCtx(()=>t[37]||(t[37]=[e.createTextVNode("百分比")])),_:1})]),_:1},8,["modelValue"])]),_:1}),O.value>=1?(e.openBlock(),e.createBlock(u,{key:0,label:"一级佣金",prop:"one"},{default:e.withCtx(()=>[e.createVNode(z,{modelValue:l.config.one,"onUpdate:modelValue":t[6]||(t[6]=V=>l.config.one=V),type:"number",style:{width:"200px"}},{append:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.config.shareType==="FIXED_AMOUNT"?"元":"%"),1)]),_:1},8,["modelValue"])]),_:1})):e.createCommentVNode("",!0),O.value>=2?(e.openBlock(),e.createBlock(u,{key:1,label:"二级佣金",prop:"two"},{default:e.withCtx(()=>[e.createVNode(z,{modelValue:l.config.two,"onUpdate:modelValue":t[7]||(t[7]=V=>l.config.two=V),type:"number",style:{width:"200px"}},{append:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.config.shareType==="FIXED_AMOUNT"?"元":"%"),1)]),_:1},8,["modelValue"])]),_:1})):e.createCommentVNode("",!0),O.value===3?(e.openBlock(),e.createBlock(u,{key:2,label:"三级佣金",prop:"three"},{default:e.withCtx(()=>[e.createVNode(z,{modelValue:l.config.three,"onUpdate:modelValue":t[8]||(t[8]=V=>l.config.three=V),type:"number",style:{width:"200px"}},{append:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.config.shareType==="FIXED_AMOUNT"?"元":"%"),1)]),_:1},8,["modelValue"])]),_:1})):e.createCommentVNode("",!0)]),_:1},8,["model","rules"]),e.createElementVNode("div",Bo,[e.createVNode(I,{type:"primary",round:"",onClick:A},{default:e.withCtx(()=>t[39]||(t[39]=[e.createTextVNode("保存")])),_:1})]),e.createVNode(U,{modelValue:i.value,"onUpdate:modelValue":t[12]||(t[12]=V=>i.value=V),title:"编辑协议"},{footer:e.withCtx(()=>[e.createElementVNode("span",$o,[e.createVNode(I,{onClick:t[10]||(t[10]=V=>i.value=!1)},{default:e.withCtx(()=>t[40]||(t[40]=[e.createTextVNode("取消")])),_:1}),e.createVNode(I,{type:"primary",onClick:t[11]||(t[11]=V=>i.value=!1)},{default:e.withCtx(()=>t[41]||(t[41]=[e.createTextVNode("确认")])),_:1})])]),default:e.withCtx(()=>[e.createVNode(be,{content:l.config.protocol,"onUpdate:content":t[9]||(t[9]=V=>l.config.protocol=V)},null,8,["content"])]),_:1},8,["modelValue"]),e.createVNode(U,{modelValue:f.value,"onUpdate:modelValue":t[16]||(t[16]=V=>f.value=V),title:"编辑攻略"},{footer:e.withCtx(()=>[e.createElementVNode("span",Po,[e.createVNode(I,{onClick:t[14]||(t[14]=V=>f.value=!1)},{default:e.withCtx(()=>t[42]||(t[42]=[e.createTextVNode("取消")])),_:1}),e.createVNode(I,{type:"primary",onClick:t[15]||(t[15]=V=>f.value=!1)},{default:e.withCtx(()=>t[43]||(t[43]=[e.createTextVNode("确认")])),_:1})])]),default:e.withCtx(()=>[e.createVNode(be,{content:l.config.playMethods,"onUpdate:content":t[13]||(t[13]=V=>l.config.playMethods=V)},null,8,["content"])]),_:1},8,["modelValue"])])}}}),Wo="",Uo=Object.freeze(Object.defineProperty({__proto__:null,default:le(Oo,[["__scopeId","data-v-d60e7af4"]])},Symbol.toStringTag,{value:"Module"}));return Ie});
